YUI.add("ac-plugin",function(A){var I={},B="handle";function D(L,M,N,K){if((B in I[N])&&I[N][B].detach){if(K===L.get("keyDelay")){return;}I[N][B].detach();}I[N][B]=A.on("valueChange",J,A.one(M),L,{delay:K});}function J(){var K=this.get("queryValue");if(K.length<this.get("minQueryLength")){return;}this.fire("ac:query",K);}function C(L,M){var K=this.get("dataSource");if(K){K.sendRequest(this.get("queryTemplate").replace(/(^|[^\\])\{query\}/,"$1"+encodeURIComponent(query)).replace(/\\(\{query\})/,"$1"),{success:this.handleQueryResponse,failure:this.handleQueryResponse});}}function G(L){var K=(L&&L.response&&L.response.results)?L.response.results:L;this.fire("ac:load",{results:K});}function E(L){var K=this.get("widget");if(K){K.render(L.results);}}function H(L){var M=A.Node.getDOMNode(L),N=M.getAttribute("autocomplete");if((N&&N!=="off")||N===null||N===undefined){var K=function(){if(M){M.setAttribute("autocomplete","on");}M=null;};A.on("beforeunload",K,window);A.on("unload",K,window);}M.setAttribute("autocomplete","off");}function F(){F.superclass.constructor.apply(this,arguments);}F.ATTRS={queryValue:{getter:function(){return this.get("host").get("value");},setter:function(K){this.get("host").set("value",K);return K;}},keyDelay:{value:50,setter:function(K){K=+K;if(isNaN(K)){return this.get("keyDelay");}D(this,this.get("host"),A.stamp(this),K);return K;}},dataSource:{value:null},delimiter:{value:null},minQueryLength:{value:3},queryTemplate:{value:"{query}"},widget:{value:null}};A.extend(F,A.Plugin.Base,{initializer:function(){var K=this.get("host"),L=A.stamp(this);if(!(L in I)){I[L]={};}D(this,K,L,this.get("keyDelay"));A.on("key",A.bind(J,this),K,"down:13,10,40");H(K);this.publish("ac:query",{broadcast:1,defaultFn:C,prefix:"ac"});this.publish("ac:load",{broadcast:1,defaultFn:E,prefix:"ac"});this.handleQueryResponse=A.bind(G,this);},destroy:function(){var L=A.stamp(this),K=I[L];K[B].detach();delete I[L];}});A.augment(F,A.EventTarget);F.NAME="ACPlugin";F.NS="ac";A.namespace("Plugin").ACPlugin=F;},"@VERSION@",{requires:["node-base","plugin","value-change","event-key"]});