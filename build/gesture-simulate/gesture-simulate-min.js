YUI.add("gesture-simulate",function(a){(function(){var e={tap:1,doubletap:1,press:1,gesturemove:1,flick:1,pinch:1,rotate:1},i=a.config.doc,n,g={EVENT_INTERVAL:20,START_PAGEX:0,START_PAGEY:0,DISTANCE:200,DURATION:1000,HOLD_PRESS:3000,HOLD_TAP:10,DELAY_TAP:10,MAX_DURATION_MOVE:5000,MIN_HOLD_PRESS:1000,MAX_HOLD_PRESS:60000,MIN_VELOCITY:1.3},d="touchstart",j="touchmove",h="touchend",k="gesturestart",b="gesturechange",m="gestureend",l="dblclick",o="x",c="y";function f(p){if(!p){a.error(NAME+": invalid target node");}this.node=p;this.target=a.Node.getDOMNode(p);g.START_PAGEX=this.node.getX()+this.target.getBoundingClientRect().width/2;g.START_PAGEY=this.node.getY()+this.target.getBoundingClientRect().height/2;if(a.Event.GestureSimulation.defaults){g=a.merge(g,a.Event.GestureSimulation.defaults);}}f.prototype={_toRadian:function(p){return p*(Math.PI/180);},_calculateDefaultPoint:function(p){if(!a.Lang.isArray(p)||p.length===0){p=[g.START_PAGEX,g.START_PAGEY];}else{if(p.length==1){p[1]=this.target.getBoundingClientRect().height/2;}p[0]=this.node.getX()+p[0];p[1]=this.node.getY()+p[1];}return p;},rotate:function(p,v,w,t,q,x){var u,s=v,r=w;if(!a.Lang.isNumber(s)||!a.Lang.isNumber(r)||s<0||r<0){u=(this.target.offsetWidth<this.target.offsetHeight)?this.target.offsetWidth/2:this.target.offsetHeight/2;s=u;r=u;}if(!a.Lang.isNumber(x)){a.error(NAME+"Invalid rotation detected.");}this.pinch(p,s,r,t,q,x);},pinch:function(N,D,u,q,v,C){var A,K=g.EVENT_INTERVAL,z,B=0,G=D,E=u,M,y,w,L,J,O,t,I,p,x,s={start:[],end:[]},r={start:[],end:[]},H;N=this._calculateDefaultPoint(N);if(!a.Lang.isNumber(G)||!a.Lang.isNumber(E)||G<0||E<0){a.error(NAME+"Invalid startRadius and endRadius detected.");}if(!a.Lang.isNumber(q)||q<=0){q=g.DURATION;}if(!a.Lang.isNumber(v)){v=0;}else{v=v%360;if(v<0){v+=360;}}if(!a.Lang.isNumber(C)){C=0;}a.AsyncQueue.defaults.timeout=K;A=new a.AsyncQueue();y=N[0];w=N[1];t=v;I=v+C;s.start=[y+G*Math.sin(this._toRadian(t)),w-G*Math.cos(this._toRadian(t))];s.end=[y+E*Math.sin(this._toRadian(I-t)),w-E*Math.cos(this._toRadian(I-t))];r.start=[y-G*Math.sin(this._toRadian(t)),w+G*Math.cos(this._toRadian(t))];r.end=[y-E*Math.sin(this._toRadian(I-t)),w+E*Math.cos(this._toRadian(I-t))];L=1;J=u/D;A.add({fn:function(){var Q,P,S,R;Q={pageX:s.start[0],pageY:s.start[1],clientX:s.start[0],clientY:s.start[1]};P={pageX:r.start[0],pageY:r.start[1],clientX:r.start[0],clientY:r.start[1]};R=this._createTouchList([a.merge({identifier:B++},Q),a.merge({identifier:B++},P)]);S={pageX:(s.start[0]+r.start[0])/2,pageY:(s.start[0]+r.start[1])/2,clientX:(s.start[0]+r.start[0])/2,clientY:(s.start[0]+r.start[1])/2};a.Event.simulate(this.target,d,a.merge({touches:R,targetTouches:R,changedTouches:R,scale:L,rotation:t},S));if(a.UA.ios>=2){a.Event.simulate(this.target,k,a.merge({scale:L,rotation:t},S));}},timeout:0,context:this});H=Math.floor(q/K);M=(E-G)/H;O=(J-L)/H;p=(I-t)/H;x=this._toRadian(I-t)/H;for(var F=0;F<H;F++){A.add({fn:function(S){var W=G+(M)*S,U=y+W*Math.sin(t+x*S),Q=w-W*Math.cos(t+x*S),R=y-W*Math.sin(t+x*S),P=w+W*Math.cos(t+x*S),aa=(U+R)/2,Z=(Q+P)/2,Y,X,V,T;Y={pageX:U,pageY:Q,clientX:U,clientY:Q};X={pageX:R,pageY:P,clientX:R,clientY:P};T=this._createTouchList([a.merge({identifier:B++},Y),a.merge({identifier:B++},X)]);V={pageX:aa,pageY:Z,clientX:aa,clientY:Z};a.Event.simulate(this.target,j,a.merge({touches:T,targetTouches:T,changedTouches:T,scale:L+O*S,rotation:t+p*S},V));if(a.UA.ios>=2){a.Event.simulate(this.target,b,a.merge({scale:L+O*S,rotation:t+p*S},V));}},args:[F],context:this});}A.add({fn:function(){var S=this._getEmptyTouchList(),Q,P,T,R;Q={pageX:s.end[0],pageY:s.end[1],clientX:s.end[0],clientY:s.end[1]};P={pageX:r.end[0],pageY:r.end[1],clientX:r.end[0],clientY:r.end[1]};R=this._createTouchList([a.merge({identifier:B++},Q),a.merge({identifier:B++},P)]);T={pageX:(s.end[0]+r.end[0])/2,pageY:(s.end[0]+r.end[1])/2,clientX:(s.end[0]+r.end[0])/2,clientY:(s.end[0]+r.end[1])/2};if(a.UA.ios>=2){a.Event.simulate(this.target,m,a.merge({scale:J,rotation:I},T));}a.Event.simulate(this.target,h,a.merge({touches:S,targetTouches:S,changedTouches:R,scale:J,rotation:I},T));},context:this});A.run();},tap:function(v,p,q,s){var x=new a.AsyncQueue(),w=this._getEmptyTouchList(),t,u,r;v=this._calculateDefaultPoint(v);if(!a.Lang.isNumber(p)||p<1){p=1;}if(!a.Lang.isNumber(q)){q=g.HOLD_TAP;}if(!a.Lang.isNumber(s)){s=g.DELAY_TAP;}u={pageX:v[0],pageY:v[1],clientX:v[0],clientY:v[1]};t=this._createTouchList([a.merge({identifier:0},u)]);for(r=0;r<p;r++){x.add({fn:function(){a.Event.simulate(this.target,d,a.merge({touches:t,targetTouches:t,changedTouches:t},u));},context:this,timeout:(r===0)?0:s});x.add({fn:function(){a.Event.simulate(this.target,h,a.merge({touches:w,targetTouches:w,changedTouches:t},u));},context:this,timeout:q});}if(p>1&&!((a.config.win&&("ontouchstart" in a.config.win))&&!(a.UA.chrome&&a.UA.chrome<6))){x.add({fn:function(){a.Event.simulate(this.target,l,u);},context:this});}x.run();},flick:function(p,q,t,s){var r;p=this._calculateDefaultPoint(p);if(!a.Lang.isString(q)){q=o;}else{q=q.toLowerCase();if(q!==o&&q!==c){a.error(NAME+"(flick): Only x or y axis allowed");}}if(!a.Lang.isNumber(t)){t=g.DISTANCE;}if(!a.Lang.isNumber(s)){s=g.DURATION;}else{if(s>g.MAX_DURATION_MOVE){s=g.MAX_DURATION_MOVE;}}if(Math.abs(t)/s<g.MIN_VELOCITY){s=Math.abs(t)/g.MIN_VELOCITY;}r={start:a.clone(p),end:[(q===o)?p[0]+t:p[0],(q===c)?p[1]+t:p[1]]};this._gesturemove(r,s);},gesturemove:function(q,p){var r;if(!a.Lang.isObject(q)){q={point:this._calculateDefaultPoint([]),xdist:g.DISTANCE,ydist:0};}else{if(!a.Lang.isArray(q.point)){q.point=this._calculateDefaultPoint([]);}else{q.point=this._calculateDefaultPoint(q.point);}if(!a.Lang.isNumber(q.xdist)){q.xdist=g.DISTANCE;}if(!a.Lang.isNumber(q.ydist)){q.ydist=0;}}r={start:a.clone(q.point),end:[q.point[0]+q.xdist,q.point[1]+q.ydist]};this._gesturemove(r,p);},_gesturemove:function(w,r){var x,q=g.EVENT_INTERVAL,t,v,u,p=0;if(!a.Lang.isNumber(r)){r=g.DURATION;}else{if(r>g.MAX_DURATION_MOVE){r=g.MAX_DURATION_MOVE;}}if(!a.Lang.isObject(w)){w={start:[g.START_PAGEX,g.START_PAGEY],end:[g.START_PAGEX+g.DISTANCE,g.START_PAGEY]};
}else{if(!a.Lang.isArray(w.start)){w.start=[g.START_PAGEX,g.START_PAGEY];}if(!a.Lang.isArray(w.end)){w.end=[g.START_PAGEX+g.DISTANCE,g.START_PAGEY];}}a.AsyncQueue.defaults.timeout=q;x=new a.AsyncQueue();x.add({fn:function(){var z={pageX:w.start[0],pageY:w.start[1],clientX:w.start[0],clientY:w.start[1]},y=this._createTouchList([a.merge({identifier:p++},z)]);a.Event.simulate(this.target,d,a.merge({touches:y,targetTouches:y,changedTouches:y},z));},timeout:0,context:this});t=Math.floor(r/q);v=(w.end[0]-w.start[0])/t;u=(w.end[1]-w.start[1])/t;for(var s=0;s<t;s++){x.add({fn:function(A){var z=w.start[0]+(v*A),y=w.start[1]+(u*A),C={pageX:z,pageY:y,clientX:z,clientY:y},B=this._createTouchList([a.merge({identifier:p++},C)]);a.Event.simulate(this.target,j,a.merge({touches:B,targetTouches:B,changedTouches:B},C));},args:[s],context:this});}x.add({fn:function(){var z={pageX:w.end[0],pageY:w.end[1],clientX:w.end[0],clientY:w.end[1]},y=this._createTouchList([a.merge({identifier:p},z)]);a.Event.simulate(this.target,j,a.merge({touches:y,targetTouches:y,changedTouches:y},z));},timeout:0,context:this});x.add({fn:function(){var A={pageX:w.end[0],pageY:w.end[1],clientX:w.end[0],clientY:w.end[1]},z=this._getEmptyTouchList(),y=this._createTouchList([a.merge({identifier:p},A)]);a.Event.simulate(this.target,h,a.merge({touches:z,targetTouches:z,changedTouches:y},A));},context:this});x.run();},_getEmptyTouchList:function(){if(!n){n=this._createTouchList([]);}return n;},_createTouchList:function(r){var s=[],q,p=this;if(!!r&&a.Lang.isArray(r)){if(a.UA.android&&a.UA.android>=4||a.UA.ios&&a.UA.ios>=2){a.each(r,function(t){if(!t.identifier){t.identifier=0;}if(!t.pageX){t.pageX=0;}if(!t.pageY){t.pageY=0;}if(!t.screenX){t.screenX=0;}if(!t.screenY){t.screenY=0;}s.push(i.createTouch(a.config.win,p.target,t.identifier,t.pageX,t.pageY,t.screenX,t.screenY));});q=i.createTouchList.apply(i,s);}else{if(a.UA.ios&&a.UA.ios<2){a.error(NAME+": No touch event simulation framework present.");}else{q=[];a.each(r,function(t){if(!t.identifier){t.identifier=0;}if(!t.clientX){t.clientX=0;}if(!t.clientY){t.clientY=0;}if(!t.pageX){t.pageX=0;}if(!t.pageY){t.pageY=0;}if(!t.screenX){t.screenX=0;}if(!t.screenY){t.screenY=0;}q.push({target:p.target,identifier:t.identifier,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY});});q.item=function(t){return q[t];};}}}else{a.error(NAME+": Invalid touchPoints passed");}return q;}};a.Event.GESTURES=e;a.Event.GestureSimulation=f;a.Event.GestureSimulation.defaults=g;a.Event.simulateGesture=function(s,r,q){var p=new a.Event.GestureSimulation(s);r=r.toLowerCase();q=q||{};if(a.Event.GESTURES[r]){switch(r){case"tap":p.tap(q.point,q.times,q.hold,q.delay);break;case"doubletap":p.tap(q.point,2);break;case"press":if(!a.Lang.isNumber(q.hold)){q.hold=g.HOLD_PRESS;}else{if(q.hold<g.MIN_HOLD_PRESS){q.hold=g.MIN_HOLD_PRESS;}else{if(q.hold>g.MAX_HOLD_PRESS){q.hold=g.MAX_HOLD_PRESS;}}}p.tap(q.point,1,q.hold);break;case"gesturemove":p.gesturemove(q.path,q.duration);break;case"flick":p.flick(q.point,q.axis,q.distance,q.duration);break;case"pinch":p.pinch(q.center,q.r1,q.r2,q.duration,q.start,q.rotation);break;case"rotate":p.rotate(q.center,q.r1,q.r2,q.duration,q.start,q.rotation);break;}}else{a.error(NAME+": Not a supported gesture simulation: "+r);}};})();},"@VERSION@",{requires:["event-simulate","async-queue","node-screen"]});