YUI.add("gesture-simulate",function(e){var k="gesture-simulate",b=((e.config.win&&("ontouchstart" in e.config.win))&&!(e.UA.phantomjs)&&!(e.UA.chrome&&e.UA.chrome<6)),i={tap:1,doubletap:1,press:1,move:1,flick:1,pinch:1,rotate:1},f={touchstart:1,touchmove:1,touchend:1,touchcancel:1},q=e.config.doc,o,h=20,m,l,c={HOLD_TAP:10,DELAY_TAP:10,HOLD_PRESS:3000,MIN_HOLD_PRESS:1000,MAX_HOLD_PRESS:60000,DISTANCE_MOVE:200,DURATION_MOVE:1000,MAX_DURATION_MOVE:5000,MIN_VELOCITY_FLICK:1.3,DISTANCE_FLICK:200,DURATION_FLICK:1000,MAX_DURATION_FLICK:5000,DURATION_PINCH:1000},j="touchstart",s="touchmove",t="touchend",w="gesturestart",g="gesturechange",a="gestureend",x="mouseup",y="mousemove",u="mousedown",p="click",d="dblclick",r="x",v="y";function n(z){if(!z){e.error(k+": invalid target node");}this.node=z;this.target=e.Node.getDOMNode(z);var A=this.node.getXY(),B=this._getDims();m=A[0]+(B[0])/2;l=A[1]+(B[1])/2;}n.prototype={_toRadian:function(z){return z*(Math.PI/180);},_getDims:function(){var B,A,z;if(this.target.getBoundingClientRect){B=this.target.getBoundingClientRect();if("height" in B){z=B.height;}else{z=Math.abs(B.bottom-B.top);}if("width" in B){A=B.width;}else{A=Math.abs(B.right-B.left);}}else{B=this.node.get("region");A=B.width;z=B.height;}return[A,z];},_calculateDefaultPoint:function(A){var z;if(!e.Lang.isArray(A)||A.length===0){A=[m,l];}else{if(A.length==1){z=this._getDims[1];A[1]=z/2;}A[0]=this.node.getX()+A[0];A[1]=this.node.getY()+A[1];}return A;},rotate:function(D,z,G,H,E,A,I){var F,C=G,B=H;if(!e.Lang.isNumber(C)||!e.Lang.isNumber(B)||C<0||B<0){F=(this.target.offsetWidth<this.target.offsetHeight)?this.target.offsetWidth/4:this.target.offsetHeight/4;C=F;B=F;}if(!e.Lang.isNumber(I)){e.error(k+"Invalid rotation detected.");}this.pinch(D,z,C,B,E,A,I);},pinch:function(K,Y,N,E,A,F,M){var J,P,V=h,I,L=0,Q=N,O=E,X,H,G,W,U,Z,D,S,z,C={start:[],end:[]},B={start:[],end:[]},R,T;Y=this._calculateDefaultPoint(Y);if(!e.Lang.isNumber(Q)||!e.Lang.isNumber(O)||Q<0||O<0){e.error(k+"Invalid startRadius and endRadius detected.");}if(!e.Lang.isNumber(A)||A<=0){A=c.DURATION_PINCH;}if(!e.Lang.isNumber(F)){F=0;}else{F=F%360;while(F<0){F+=360;}}if(!e.Lang.isNumber(M)){M=0;}e.AsyncQueue.defaults.timeout=V;J=new e.AsyncQueue();H=Y[0];G=Y[1];D=F;S=F+M;C.start=[H+Q*Math.sin(this._toRadian(D)),G-Q*Math.cos(this._toRadian(D))];C.end=[H+O*Math.sin(this._toRadian(S)),G-O*Math.cos(this._toRadian(S))];B.start=[H-Q*Math.sin(this._toRadian(D)),G+Q*Math.cos(this._toRadian(D))];B.end=[H-O*Math.sin(this._toRadian(S)),G+O*Math.cos(this._toRadian(S))];W=1;U=E/N;J.add({fn:function(){var ab,aa,ad,ac;ab={pageX:C.start[0],pageY:C.start[1],clientX:C.start[0],clientY:C.start[1]};aa={pageX:B.start[0],pageY:B.start[1],clientX:B.start[0],clientY:B.start[1]};ac=this._createTouchList([e.merge({identifier:(L++)},ab),e.merge({identifier:(L++)},aa)]);ad={pageX:(C.start[0]+B.start[0])/2,pageY:(C.start[0]+B.start[1])/2,clientX:(C.start[0]+B.start[0])/2,clientY:(C.start[0]+B.start[1])/2};this._simulateEvent(this.target,j,e.merge({touches:ac,targetTouches:ac,changedTouches:ac,scale:W,rotation:D},ad));if(e.UA.ios>=2){this._simulateEvent(this.target,w,e.merge({scale:W,rotation:D},ad));}},timeout:0,context:this});R=Math.floor(A/V);X=(O-Q)/R;Z=(U-W)/R;z=(S-D)/R;T=function(ac){var ah=Q+(X)*ac,af=H+ah*Math.sin(this._toRadian(D+z*ac)),ab=G-ah*Math.cos(this._toRadian(D+z*ac)),ad=H-ah*Math.sin(this._toRadian(D+z*ac)),aa=G+ah*Math.cos(this._toRadian(D+z*ac)),al=(af+ad)/2,ak=(ab+aa)/2,aj,ai,ag,ae;aj={pageX:af,pageY:ab,clientX:af,clientY:ab};ai={pageX:ad,pageY:aa,clientX:ad,clientY:aa};ae=this._createTouchList([e.merge({identifier:(L++)},aj),e.merge({identifier:(L++)},ai)]);ag={pageX:al,pageY:ak,clientX:al,clientY:ak};this._simulateEvent(this.target,s,e.merge({touches:ae,targetTouches:ae,changedTouches:ae,scale:W+Z*ac,rotation:D+z*ac},ag));if(e.UA.ios>=2){this._simulateEvent(this.target,g,e.merge({scale:W+Z*ac,rotation:D+z*ac},ag));}};for(P=0;P<R;P++){J.add({fn:T,args:[P],context:this});}J.add({fn:function(){var ad=this._getEmptyTouchList(),ab,aa,ae,ac;ab={pageX:C.end[0],pageY:C.end[1],clientX:C.end[0],clientY:C.end[1]};aa={pageX:B.end[0],pageY:B.end[1],clientX:B.end[0],clientY:B.end[1]};ac=this._createTouchList([e.merge({identifier:(L++)},ab),e.merge({identifier:(L++)},aa)]);ae={pageX:(C.end[0]+B.end[0])/2,pageY:(C.end[0]+B.end[1])/2,clientX:(C.end[0]+B.end[0])/2,clientY:(C.end[0]+B.end[1])/2};if(e.UA.ios>=2){this._simulateEvent(this.target,a,e.merge({scale:U,rotation:S},ae));}this._simulateEvent(this.target,t,e.merge({touches:ad,targetTouches:ad,changedTouches:ac,scale:U,rotation:S},ae));},context:this});if(K&&e.Lang.isFunction(K)){J.add({fn:K,context:this.node});}J.run();},tap:function(C,H,z,A,E){var K=new e.AsyncQueue(),I=this._getEmptyTouchList(),F,G,D,B,J;H=this._calculateDefaultPoint(H);if(!e.Lang.isNumber(z)||z<1){z=1;}if(!e.Lang.isNumber(A)){A=c.HOLD_TAP;}if(!e.Lang.isNumber(E)){E=c.DELAY_TAP;}G={pageX:H[0],pageY:H[1],clientX:H[0],clientY:H[1]};F=this._createTouchList([e.merge({identifier:0},G)]);B=function(){this._simulateEvent(this.target,j,e.merge({touches:F,targetTouches:F,changedTouches:F},G));};J=function(){this._simulateEvent(this.target,t,e.merge({touches:I,targetTouches:I,changedTouches:F},G));};for(D=0;D<z;D++){K.add({fn:B,context:this,timeout:(D===0)?0:E});K.add({fn:J,context:this,timeout:A});}if(z>1&&!b){K.add({fn:function(){this._simulateEvent(this.target,d,G);},context:this});}if(C&&e.Lang.isFunction(C)){K.add({fn:C,context:this.node});}K.run();},flick:function(A,z,B,E,D){var C;z=this._calculateDefaultPoint(z);if(!e.Lang.isString(B)){B=r;}else{B=B.toLowerCase();if(B!==r&&B!==v){e.error(k+"(flick): Only x or y axis allowed");}}if(!e.Lang.isNumber(E)){E=c.DISTANCE_FLICK;}if(!e.Lang.isNumber(D)){D=c.DURATION_FLICK;}else{if(D>c.MAX_DURATION_FLICK){D=c.MAX_DURATION_FLICK;}}if(Math.abs(E)/D<c.MIN_VELOCITY_FLICK){D=Math.abs(E)/c.MIN_VELOCITY_FLICK;}C={start:e.clone(z),end:[(B===r)?z[0]+E:z[0],(B===v)?z[1]+E:z[1]]};this._move(A,C,D);},move:function(z,B,A){var C;
if(!e.Lang.isObject(B)){B={point:this._calculateDefaultPoint([]),xdist:c.DISTANCE_MOVE,ydist:0};}else{if(!e.Lang.isArray(B.point)){B.point=this._calculateDefaultPoint([]);}else{B.point=this._calculateDefaultPoint(B.point);}if(!e.Lang.isNumber(B.xdist)){B.xdist=c.DISTANCE_MOVE;}if(!e.Lang.isNumber(B.ydist)){B.ydist=0;}}if(!e.Lang.isNumber(A)){A=c.DURATION_MOVE;}else{if(A>c.MAX_DURATION_MOVE){A=c.MAX_DURATION_MOVE;}}C={start:e.clone(B.point),end:[B.point[0]+B.xdist,B.point[1]+B.ydist]};this._move(z,C,A);},_move:function(B,I,C){var J,D,A=h,F,H,G,z=0,E;if(!e.Lang.isNumber(C)){C=c.DURATION_MOVE;}else{if(C>c.MAX_DURATION_MOVE){C=c.MAX_DURATION_MOVE;}}if(!e.Lang.isObject(I)){I={start:[m,l],end:[m+c.DISTANCE_MOVE,l]};}else{if(!e.Lang.isArray(I.start)){I.start=[m,l];}if(!e.Lang.isArray(I.end)){I.end=[m+c.DISTANCE_MOVE,l];}}e.AsyncQueue.defaults.timeout=A;J=new e.AsyncQueue();J.add({fn:function(){var L={pageX:I.start[0],pageY:I.start[1],clientX:I.start[0],clientY:I.start[1]},K=this._createTouchList([e.merge({identifier:(z++)},L)]);this._simulateEvent(this.target,j,e.merge({touches:K,targetTouches:K,changedTouches:K},L));},timeout:0,context:this});F=Math.floor(C/A);H=(I.end[0]-I.start[0])/F;G=(I.end[1]-I.start[1])/F;E=function(M){var L=I.start[0]+(H*M),K=I.start[1]+(G*M),O={pageX:L,pageY:K,clientX:L,clientY:K},N=this._createTouchList([e.merge({identifier:(z++)},O)]);this._simulateEvent(this.target,s,e.merge({touches:N,targetTouches:N,changedTouches:N},O));};for(D=0;D<F;D++){J.add({fn:E,args:[D],context:this});}J.add({fn:function(){var L={pageX:I.end[0],pageY:I.end[1],clientX:I.end[0],clientY:I.end[1]},K=this._createTouchList([e.merge({identifier:z},L)]);this._simulateEvent(this.target,s,e.merge({touches:K,targetTouches:K,changedTouches:K},L));},timeout:0,context:this});J.add({fn:function(){var M={pageX:I.end[0],pageY:I.end[1],clientX:I.end[0],clientY:I.end[1]},L=this._getEmptyTouchList(),K=this._createTouchList([e.merge({identifier:z},M)]);this._simulateEvent(this.target,t,e.merge({touches:L,targetTouches:L,changedTouches:K},M));},context:this});if(B&&e.Lang.isFunction(B)){J.add({fn:B,context:this.node});}J.run();},_getEmptyTouchList:function(){if(!o){o=this._createTouchList([]);}return o;},_createTouchList:function(B){var C=[],A,z=this;if(!!B&&e.Lang.isArray(B)){if(e.UA.android&&e.UA.android>=4||e.UA.ios&&e.UA.ios>=2){e.each(B,function(D){if(!D.identifier){D.identifier=0;}if(!D.pageX){D.pageX=0;}if(!D.pageY){D.pageY=0;}if(!D.screenX){D.screenX=0;}if(!D.screenY){D.screenY=0;}C.push(q.createTouch(e.config.win,z.target,D.identifier,D.pageX,D.pageY,D.screenX,D.screenY));});A=q.createTouchList.apply(q,C);}else{if(e.UA.ios&&e.UA.ios<2){e.error(k+": No touch event simulation framework present.");}else{A=[];e.each(B,function(D){if(!D.identifier){D.identifier=0;}if(!D.clientX){D.clientX=0;}if(!D.clientY){D.clientY=0;}if(!D.pageX){D.pageX=0;}if(!D.pageY){D.pageY=0;}if(!D.screenX){D.screenX=0;}if(!D.screenY){D.screenY=0;}A.push({target:z.target,identifier:D.identifier,clientX:D.clientX,clientY:D.clientY,pageX:D.pageX,pageY:D.pageY,screenX:D.screenX,screenY:D.screenY});});A.item=function(D){return A[D];};}}}else{e.error(k+": Invalid touchPoints passed");}return A;},_simulateEvent:function(C,A,z){var B;if(f[A]){if(b){e.Event.simulate(C,A,z);}else{if(this._isSingleTouch(z.touches,z.targetTouches,z.changedTouches)){A={touchstart:u,touchmove:y,touchend:x}[A];z.button=0;z.relatedTarget=null;B=(A===x)?z.changedTouches:z.touches;z=e.mix(z,{screenX:B.item(0).screenX,screenY:B.item(0).screenY,clientX:B.item(0).clientX,clientY:B.item(0).clientY},true);e.Event.simulate(C,A,z);if(A==x){e.Event.simulate(C,p,z);}}else{e.error("_simulateEvent(): Event '"+A+"' has multi touch objects that can't be simulated in your platform.");}}}else{e.Event.simulate(C,A,z);}},_isSingleTouch:function(B,A,z){return(B&&(B.length<=1))&&(A&&(A.length<=1))&&(z&&(z.length<=1));}};e.GestureSimulation=n;e.GestureSimulation.defaults=c;e.GestureSimulation.GESTURES=i;e.Event.simulateGesture=function(D,C,B,z){D=e.one(D);var A=new e.GestureSimulation(D);C=C.toLowerCase();if(!z&&e.Lang.isFunction(B)){z=B;B={};}B=B||{};if(i[C]){switch(C){case"tap":A.tap(z,B.point,B.times,B.hold,B.delay);break;case"doubletap":A.tap(z,B.point,2);break;case"press":if(!e.Lang.isNumber(B.hold)){B.hold=c.HOLD_PRESS;}else{if(B.hold<c.MIN_HOLD_PRESS){B.hold=c.MIN_HOLD_PRESS;}else{if(B.hold>c.MAX_HOLD_PRESS){B.hold=c.MAX_HOLD_PRESS;}}}A.tap(z,B.point,1,B.hold);break;case"move":A.move(z,B.path,B.duration);break;case"flick":A.flick(z,B.point,B.axis,B.distance,B.duration);break;case"pinch":A.pinch(z,B.center,B.r1,B.r2,B.duration,B.start,B.rotation);break;case"rotate":A.rotate(z,B.center,B.r1,B.r2,B.duration,B.start,B.rotation);break;}}else{e.error(k+": Not a supported gesture simulation: "+C);}};},"@VERSION@",{requires:["event-simulate","async-queue","node-screen"]});