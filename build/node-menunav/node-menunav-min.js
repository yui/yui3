YUI.add("node-menunav",function(D){var i=D.UA,AG=D.Lang,p=D.later,AD=D.ClassNameManager.getClassName,O="menu",G="menuitem",z="hidden",v="tabIndex",P="parentNode",U="children",r="offsetHeight",u="offsetWidth",AE="px",e="id",I=".",E="handledMouseOut",n="handledMouseOver",Z="active",AC="label",b="a",q="mousedown",AF="keydown",t="click",N="",T="first-of-type",h=AD(O),y=AD(O,z),X=AD(O,"horizontal"),AA=AD(O,AC),g=AD(O,AC,Z),W=AD(O,AC,(O+"visible")),J=AD(G),A=AD(G,Z),f=I+h;var K=function(AJ){var AL=AJ.previous(),AI,AK,AH,Y;if(!AL){AI=AJ.get(P);AH=AI.get(P).get(U);if(AH.size()>1){Y=AI.previous();if(Y){AK=Y.get(U);}else{AK=AH.item(AH.size()-1).get(U);}}else{AK=AI.get(U);}AL=AK.item(AK.size()-1);}return AL;};var a=function(AJ){var AL=AJ.next(),AI,AK,AH,Y;if(!AL){AI=AJ.get(P);AH=AI.get(P).get(U);if(AH.size()>1){Y=AI.next();if(Y){AK=Y.get(U);}else{AK=AH.item(0).get(U);}}else{AK=AJ.get(P).get(U);}AL=AK.item(0);}return AL;};var Q=function(Y,AH){Y.setAttribute("role",AH);};var R=function(Y,AI,AH){Y.setAttribute(("aria-"+AI),AH);};var AB=function(Y){Q(Y,"presentation");};var w=function(Y){Y.set(v,-1);};var F=function(Y){var AH=false;if(Y){AH=Y.get("nodeName").toLowerCase()===b;}return AH;};var M=function(Y){return Y.hasClass(J);};var o=function(Y){return Y.hasClass(AA);};var m=function(Y){return Y.hasClass(X);};var j=function(Y){return Y.hasClass(W);};var l=function(Y){return F(Y)?Y:Y.query(b);};var s=function(AI,AH,Y){var AJ;if(AI){if(AI.hasClass(AH)){AJ=AI;}if(!AJ&&Y){AJ=AI.ancestor((I+AH));}}return AJ;};var L=function(Y){return Y.ancestor(f);};var V=function(AH,Y){return s(AH,h,Y);};var x=function(AH,Y){var AI;if(AH){AI=s(AH,J,Y);}return AI;};var k=function(AH,Y){var AI;if(AH){if(Y){AI=s(AH,AA,Y);}else{AI=s(AH,AA)||AH.query((I+AA));}}return AI;};var B=function(AH,Y){var AI;if(AH){AI=x(AH,Y)||k(AH,Y);}return AI;};var C=function(Y){return B(Y.query("li"));};var d=function(Y){return M(Y)?A:g;};var c=function(Y,AH){return Y&&!Y[n]&&(Y===AH||Y.contains(AH));};var H=function(AH,Y){return AH&&!AH[E]&&(AH!==Y&&!AH.contains(Y));};var S=function(AI){var AH=this,AP=AI.owner,AM,AO,AL,AJ,AK,Y;if(AP){AO=AI.useARIA;AL=AI.autoSubmenuDisplay;AJ=AI.mouseOutHideDelay;AH._useARIA=AG.isBoolean(AO)?AO:((i.gecko&&i.gecko>=1.9)||(i.ie&&i.ie>=8));AH._autoSubmenuDisplay=AG.isBoolean(AL)?AL:true;AH._submenuShowDelay=AI.submenuShowDelay||250;AH._submenuHideDelay=AI.submenuHideDelay||250;AH._mouseOutHideDelay=AG.isNumber(AJ)?AJ:750;AK=AP.queryAll(f);if(AK){AK.addClass(y);}Y=AP.queryAll("ul:"+T);if(Y){Y.addClass(T);}AP.on("mouseover",AH._onMouseOver,AH);AP.on("mouseout",AH._onMouseOut,AH);AP.on("mousemove",AH._onMouseMove,AH);AP.on(q,AH._toggleSubmenuDisplay,AH);AP.on(AF,AH._toggleSubmenuDisplay,AH);AP.on(t,AH._toggleSubmenuDisplay,AH);AP.on("keypress",AH._onKeyPress,AH);AP.on(AF,AH._onKeyDown,AH);AM=AP.get("ownerDocument");AM.on(q,AH._onDocMouseDown,AH);AH._rootMenu=AP;AP.plug(D.plugin.FocusManager,{descendants:">.yui-menu-content>ul>li>a",keys:(m(AP)?{next:"down:39",previous:"down:37"}:{next:"down:40",previous:"down:38"}),rollThrough:true});var AN=AP.focusManager;AN.removeFromTabIndex("#"+AP.get("id")+" .yui-menu a");AN.on("activeDescendantChange",this._onActiveDescendantChange,AN,this);AN.after("activeDescendantChange",this._afterActiveDescendantChange,AN,this);AN.after("hasFocusChange",this._afterHasFocusChange,AN,this);AH._focusManager=AN;}};S.NS="MenuNav";S.SHIM_TEMPLATE_TITLE="Menu Stacking Shim";S.SHIM_TEMPLATE='<iframe frameborder="0" tabindex="-1" class="'+AD("shim")+'" title="'+S.SHIM_TEMPLATE_TITLE+'" src="javascript:false;"></iframe>';S.prototype={_rootMenu:null,_activeItem:null,_activeMenu:null,_hasFocus:false,_blockMouseEvent:false,_currentMouseX:0,_movingToSubmenu:false,_showSubmenuTimer:null,_hideSubmenuTimer:null,_hideAllSubmenusTimer:null,_firstItem:null,_autoSubmenuDisplay:true,_isRoot:function(Y){return this._rootMenu.compareTo(Y);},_getTopmostSubmenu:function(AJ){var AI=this,Y=L(AJ),AH;if(!Y){AH=AJ;}else{if(AI._isRoot(Y)){AH=AJ;}else{AH=AI._getTopmostSubmenu(Y);}}return AH;},_clearActiveItem:function(){var AH=this,Y=AH._activeItem;if(Y){Y.removeClass(d(Y));}AH._activeItem=null;},_setActiveItem:function(AH){var Y=this;if(AH){Y._clearActiveItem();AH.addClass(d(AH));Y._activeItem=AH;}},_focusItem:function(AI){var AH=this,Y,AJ;if(AI&&AH._hasFocus){Y=L(AI);AJ=l(AI);if(AH._activeMenu!==Y){AH._activeMenu=Y;AH._updateFocusManager();}p(0,null,function(){AH._focusManager.focus(AJ);});}},_applyARIA:function(AJ){var AI=this,AN=AI._isRoot(AJ),Y,AM,AL,AH,AP,AK,AO;Q(AJ,(AN&&m(AJ)?"menubar":O));if(!AN){Y=AJ.previous();AM=Y.query(I+AD(O,"toggle"));if(AM){Y=AM;}AO=Y.get(e);if(!AO){AO=D.guid();Y.set(e,AO);}R(AJ,"labelledby",AO);R(AJ,z,true);}AL=AJ.queryAll("ul,li");if(AL){AL.each(function(AQ){AB(AQ);});}AH=AJ.queryAll((I+AD(G,"content")));if(AH){AH.each(function(AQ){w(AQ);Q(AQ,G);});}AP=AJ.queryAll((I+AA));if(AP){AP.each(function(AQ){Y=AQ;AM=AQ.query((I+AD(O,"toggle")));if(AM){AB(AM);w(AM);Y=AM.previous();}Q(Y,G);R(Y,"haspopup",true);w(Y);AK=AQ.next();if(AK){AI._applyARIA(AK);}});}},_showMenu:function(AK){var AI=this,Y=L(AK),AJ=AK.get(P),AH=AJ.getXY();if(AI._useARIA){R(AK,z,false);}if(m(Y)){AH[1]=AH[1]+AJ.get(r);}else{AH[0]=AH[0]+AJ.get(u);}AK.setXY(AH);if(i.ie<8){if(i.ie===6&&!AK.hasIFrameShim){AK.appendChild(D.Node.create(S.SHIM_TEMPLATE));AK.hasIFrameShim=true;}AK.setStyles({height:N,width:N});AK.setStyles({height:(AK.get(r)+AE),width:(AK.get(u)+AE)});}AK.previous().addClass(W);AK.removeClass(y);},_hideMenu:function(AJ,AH){var AI=this,AK=AJ.previous(),Y;AK.removeClass(W);if(AH){AI._setActiveItem(AK);AI._focusItem(AK);}Y=AJ.query((I+A));if(Y){Y.removeClass(A);}AJ.setStyles({left:N,top:N});AJ.addClass(y);R(AJ,z,true);},_hideAllSubmenus:function(AI){var AH=this,Y=AI.queryAll(f);if(Y){Y.each(D.bind(function(AJ){AH._hideMenu(AJ);},AH));}},_cancelShowSubmenuTimer:function(){var AH=this,Y=AH._showSubmenuTimer;if(Y){Y.cancel();AH._showSubmenuTimer=null;}},_cancelHideSubmenuTimer:function(){var Y=this,AH=Y._hideSubmenuTimer;if(AH){AH.cancel();
Y._hideSubmenuTimer=null;}},_onActiveDescendantChange:function(AH,Y){if(AH.src==="UI"){if(Y._activeMenu){Y._hideAllSubmenus(Y._activeMenu);}}},_afterActiveDescendantChange:function(AH,Y){var AI;if(AH.src==="UI"){AI=this.get("descendants").item(AH.newVal);Y._setActiveItem(AI);}},_afterHasFocusChange:function(AJ,AI){var AH=this.get("descendants").item(this.get("activeDescendant")),Y;AI._hasFocus=AJ.newVal;if(AJ.newVal){Y=B(AH,true);if(Y){AI._setActiveItem(Y);}}else{AI._clearActiveItem();AI._cancelShowSubmenuTimer();AI._hideAllSubmenus(AI._rootMenu);AI._activeMenu=AI._rootMenu;AI._updateFocusManager();this.set("activeDescendant",0);}},_updateFocusManager:function(){var AH=this,Y=AH._activeMenu,AI=AH._isRoot(Y)?"":("#"+Y.get("id"));AH._focusManager.set("activeDescendant",-1);AI+=">.yui-menu-content>ul>li>a";AH._focusManager.set("descendants",AI);AH._focusManager.set("keys",(m(AH._activeMenu)?{next:"down:39",previous:"down:37"}:{next:"down:40",previous:"down:38"}));},_onMenuMouseOver:function(AJ,AI){var AH=this,Y=AH._hideAllSubmenusTimer;if(Y){Y.cancel();AH._hideAllSubmenusTimer=null;}AH._cancelHideSubmenuTimer();if(AH._activeMenu!==AJ){AH._activeMenu=AJ;if(AH._hasFocus){AH._updateFocusManager();}}if(AH._movingToSubmenu&&m(AJ)){AH._movingToSubmenu=false;}},_onMenuMouseOut:function(AN,AL){var AK=this,AI=AK._activeMenu,AM=AL.relatedTarget,Y=AK._activeItem,AJ,AH;if(AI&&!AI.contains(AM)){AJ=L(AI);if(AJ&&!AJ.contains(AM)){if(AK._mouseOutHideDelay>0){AK._cancelShowSubmenuTimer();AK._hideAllSubmenusTimer=p(AK._mouseOutHideDelay,AK,function(){var AO;AI=AK._activeMenu;AK._hideAllSubmenus(AK._rootMenu);if(AI){AO=AK._getTopmostSubmenu(AI);AK._focusItem(AO.previous());}});}}else{if(Y){AH=L(Y);if(!AK._isRoot(AH)){AK._focusItem(AH.previous());}}}}},_onMenuLabelMouseOver:function(AK,AM){var AL=this,AJ=AL._activeMenu,Y=AL._isRoot(AJ),AI=(AL._autoSubmenuDisplay&&Y||!Y),AH;AL._setActiveItem(AK);AL._focusItem(AK);if(AI&&!AL._movingToSubmenu){AL._cancelHideSubmenuTimer();AL._cancelShowSubmenuTimer();if(!j(AK)){AH=AK.next();if(AH){AL._hideAllSubmenus(AJ);AL._showSubmenuTimer=p(AL._submenuShowDelay,AL,AL._showMenu,AH);}}}},_onMenuLabelMouseOut:function(AJ,AL){var AK=this,Y=AK._isRoot(AK._activeMenu),AI=(AK._autoSubmenuDisplay&&Y||!Y),AM=AL.relatedTarget,AH=AJ.next();AK._clearActiveItem();if(AI){if(AK._movingToSubmenu&&!AK._showSubmenuTimer&&AH){AK._hideSubmenuTimer=p(AK._submenuHideDelay,AK,AK._hideMenu,AH);}else{if(!AK._movingToSubmenu&&AH&&!AH.contains(AM)&&AM!==AH){AK._cancelShowSubmenuTimer();AK._hideMenu(AH);}}}},_onMenuItemMouseOver:function(AJ,AL){var AK=this,AI=AK._activeMenu,Y=AK._isRoot(AI),AH=(AK._autoSubmenuDisplay&&Y||!Y);AK._setActiveItem(AJ);AK._focusItem(AJ);if(AH&&!AK._movingToSubmenu){AK._hideAllSubmenus(AI);}},_onMenuItemMouseOut:function(Y,AH){this._clearActiveItem();},_onVerticalMenuKeyDown:function(Y){var AH=this,AL=AH._activeMenu,AQ=AH._rootMenu,AI=Y.target,AK=false,AP=Y.keyCode,AN,AJ,AM,AO;switch(AP){case 37:AJ=L(AL);if(AJ&&m(AJ)){AH._hideMenu(AL);AM=K(AL.get(P));AO=B(AM);if(AO){if(o(AO)){AN=AO.next();if(AN){AH._showMenu(AN);AH._focusItem(C(AN));AH._setActiveItem(C(AN));}else{AH._focusItem(AO);AH._setActiveItem(AO);}}else{AH._focusItem(AO);AH._setActiveItem(AO);}}}else{if(!AH._isRoot(AL)){AH._hideMenu(AL,true);}}AK=true;break;case 39:if(o(AI)){AN=AI.next();if(AN){AH._showMenu(AN);AH._focusItem(C(AN));AH._setActiveItem(C(AN));}}else{if(m(AQ)){AN=AH._getTopmostSubmenu(AL);AM=a(AN.get(P));AO=B(AM);AH._hideAllSubmenus(AQ);if(AO){if(o(AO)){AN=AO.next();if(AN){AH._showMenu(AN);AH._focusItem(C(AN));AH._setActiveItem(C(AN));}else{AH._focusItem(AO);AH._setActiveItem(AO);}}else{AH._focusItem(AO);AH._setActiveItem(AO);}}}}AK=true;break;}if(AK){Y.preventDefault();}},_onHorizontalMenuKeyDown:function(AM){var AL=this,AJ=AL._activeMenu,AH=AM.target,Y=B(AH,true),AK=false,AN=AM.keyCode,AI;if(AN===40){AL._hideAllSubmenus(AJ);if(o(Y)){AI=Y.next();if(AI){AL._showMenu(AI);AL._focusItem(C(AI));AL._setActiveItem(C(AI));}AK=true;}}if(AK){AM.preventDefault();}},_onMouseMove:function(AH){var Y=this;p(10,Y,function(){Y._currentMouseX=AH.pageX;});},_onMouseOver:function(AK){var AJ=this,AH,Y,AM,AI,AL;if(AJ._blockMouseEvent){AJ._blockMouseEvent=false;}else{AH=AK.target;Y=V(AH,true);AM=k(AH,true);AL=x(AH,true);if(c(Y,AH)){AJ._onMenuMouseOver(Y,AK);Y[n]=true;Y[E]=false;AI=L(Y);if(AI){AI[E]=true;AI[n]=false;}}if(c(AM,AH)){AJ._onMenuLabelMouseOver(AM,AK);AM[n]=true;AM[E]=false;}if(c(AL,AH)){AJ._onMenuItemMouseOver(AL,AK);AL[n]=true;AL[E]=false;}}},_onMouseOut:function(AH){var AI=this,AK=AI._activeMenu,AP=false,AJ,AL,AN,Y,AM,AO;AI._movingToSubmenu=(AK&&!m(AK)&&((AH.pageX-5)>AI._currentMouseX));AJ=AH.target;AL=AH.relatedTarget;AN=V(AJ,true);Y=k(AJ,true);AO=x(AJ,true);if(H(Y,AL)){AI._onMenuLabelMouseOut(Y,AH);Y[E]=true;Y[n]=false;}if(H(AO,AL)){AI._onMenuItemMouseOut(AO,AH);AO[E]=true;AO[n]=false;}if(Y){AM=Y.next();if(AM&&(AL===AM||AM.contains(AL))){AP=true;}}if(H(AN,AL)||AP){AI._onMenuMouseOut(AN,AH);AN[E]=true;AN[n]=false;}},_toggleSubmenuDisplay:function(AI){var AJ=this,AK=AI.target,AH=k(AK,true),Y=AI.type,AO,AN,AM,AP,AQ,AL;if(AH){AO=F(AK)?AK:AK.ancestor(F);if(AO){AM=AO.getAttribute("href",2);AP=AM.indexOf("#");AQ=AM.length;if(AP===0&&AQ>1){AL=AM.substr(1,AQ);AN=AH.next();if(AN&&(AN.get(e)===AL)){if(Y===q||(Y===AF&&AI.keyCode===13)){AI.preventDefault();if(D.UA.webkit){AI.stopImmediatePropagation();}AJ._hasFocus=true;if(j(AH)){AJ._hideMenu(AN);AJ._setActiveItem(AH);AJ._focusItem(AH);}else{AJ._hideAllSubmenus(AJ._rootMenu);AJ._showMenu(AN);AJ._focusItem(C(AN));AJ._setActiveItem(C(AN));}}if(Y===t){AI.preventDefault();}}}}}},_onKeyPress:function(Y){switch(Y.keyCode){case 37:case 38:case 39:case 40:Y.preventDefault();break;}},_onKeyDown:function(AL){var AK=this,Y=AK._activeItem,AH=AL.target,AJ=L(AH),AI;if(AJ){AK._activeMenu=AJ;if(m(AJ)){AK._onHorizontalMenuKeyDown(AL);}else{AK._onVerticalMenuKeyDown(AL);}if(AL.keyCode===27){if(!AK._isRoot(AJ)){AK._hideMenu(AJ,true);AL.stopPropagation();AK._blockMouseEvent=i.gecko?true:false;}else{if(Y){if(o(Y)&&j(Y)){AI=Y.next();
if(AI){AK._hideMenu(AI);}}else{AK._focusManager.blur();}}}}}},_onDocMouseDown:function(AJ){var AI=this,AH=AI._rootMenu,Y=AJ.target;if(!AH.compareTo(Y)&&!AH.contains(Y)){AI._hideAllSubmenus(AH);}}};D.namespace("plugin");D.plugin.NodeMenuNav=S;},"@VERSION@",{requires:["node","classnamemanager"]});