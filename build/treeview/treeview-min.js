YUI.add("treeview",function(B){var T="treenode",V="contentBox",m="boundingBox",j="rendered",A="expanded",X="focused",i="parent",c="previousSibling",R="nextSibling",k="root",d="content",H="currentFocus",W="Change",F=B.ClassNameManager.getClassName,D="toggle",I="leaf",S="plus",G="minus",M="first",K="middle",a="last",n="label",N="children",C=F(T,n),g=F(T,N),b=F(T,d),P='<div class ="'+C+'"></div>',O='<ul class ="'+g+'"></ul>',Z="click",p="toggle",L="expand",f="collapse",U="focus",E=new B.Queue(),e={};var h=function(){h.superclass.constructor.apply(this,arguments);};B.mix(h,{NAME:T,ATTRS:{children:{readOnly:true,getter:function(){return B.mix({},this._children);}},dataLoader:{value:null},depth:{value:undefined},editable:{value:false},enableHighlight:{value:false},expanded:{value:false},isLeaf:{value:false},multiExpand:{value:true},next:{value:null,validator:function(Q){return this._genericNodeValidator(Q,R);}},previous:{value:null,validator:function(Q){return this._genericNodeValidator(Q,c);}},parent:{value:null,validator:function(Q){return this._genericNodeValidator(Q,i);}},root:{value:null,readOnly:true},content:{value:null,setter:function(Q){return this._contentSetter(Q);}},container:{writeOnce:true},strings:{value:{badContent:"Rejected attempt to set invalid content [{val}] on node [{me}]",orphan:"TreeNode [{me}] was already an orphan",setParent:"Setting new parent [{parent}] of [{me}]",setNextSibling:"Setting new next sibling [{next}] of [{me}]",setPreviousSibling:"Setting new previous sibling [{previous}] of [{me}]",nextSiblingNotChild:"Position of next sibling [{next}] amongst parent [{parent}] children not found",previousSiblingNotChild:"Position of previous sibling [{previous}] amongst parent [{parent}] children not found",moving:"Moving [{node}] under [{parent}] in between [{previous}] and [{next}]",removing:"Removing child [{child}] from parent [{me}]",inserting:"Inserting child [{child}] into [{me}] at position [{position}]",positionOutOfBounds:"Tried to insert child [{child}] out of bounds at position [{position}] under parent [{me}]",positionNotInParent:"Cannot insert node [{child}] before a node [{position}] that is not a child of this node [{me}]",positionArgumentInvalid:"Argument position in method insertNode should be an integer, a TreeNode reference or undefined, was [{position}]",cantHaveParent:'Config "parent" ignored. The TreeView object is the root of the tree, it can\'t have a parent.',needsParent:"When looking for the root of [{me}] found no parent above [{brokenRoot}]"}},tabIndex:{value:-1}},HTML_PARSER:{content:function(Y){var q=Y.get("firstChild");var Q=q.get("nodeName").toUpperCase();if(Q=="UL"||Q=="OL"){return"";}if(q.get("nodeType")==3){return B.Lang.trim(q.get("textContent"))||undefined;}return q;},children:[">ul>li,>ol>li"],yuiconfig:function(Q){return Q.getAttribute("yuiconfig");}}});B.extend(h,B.Widget,{_children:null,_childContainerEl:null,_labelContainerEl:null,_dontPropagate:false,_lastToggleClass:"",BOUNDING_TEMPLATE:"<li></li>",initializer:function(Q){this._children=[];this.set("locale","es");this.set("strings",{badContent:"Rechazada la asignaci&oacute;n de contenido inv&aacute;lido [{val}] al nodo [{me}]",orphan:"El TreeNode [{me}] ya era hu&eacute;rfano",setParent:"Estableciendo nuevo padre [{parent}] para [{me}]",setNextSibling:"Estableciendo nuevo hermano siguiente [{next}] para [{me}]",setPreviousSibling:"Estableciendo nuevo hermano previo [{previous}] para [{me}]",nextSiblingNotChild:"No se ha encontrado la position del hermano siguiente [{next}] entre los hijos del padre [{parent}]",previousSiblingNotChild:"No se ha encontrado la position del hermano previo [{previous}] entre los hijos del padre [{parent}]",moving:"Moviendo [{node}] bajo [{parent}] entre [{previous}] y [{next}]",removing:"Retirando el hijo [{child}] del padre [{me}]",inserting:"Insertando el hijo [{child}] bajo el padre [{me}] en la posici&oacute;n [{position}]",positionOutOfBounds:"Rechazado el intento de insertar el hijo [{child}] fuera de rango en la posici&oacute;n [{position}] bajo el padre [{me}]",positionNotInParent:"No se puede insertar el nodo [{child}] antes de un nodo [{position}] que no es hijo de este padre [{me}]",positionArgumentInvalid:"El argumento 'position' en el m&eacute;todo 'insertNode' debe ser un entero, un TreeNode o 'undefined', fue [{position}]",cantHaveParent:'Se ignorar&aacute; el Atributo "parent". El objeto TreeView es la ra&iacute;z del &aacute;rbol, no puede tener padre.',needsParent:"Al buscar la ra&iacute;z para [{me}] no se pudo encontrar el padre de [{brokenRoot}]"});Q=Q||{};this.on(i+W,this._onParentChange);this.on(R+W,this._onNextSiblingChange);this.on(c+W,this._onPreviousSiblingChange);this.on(d+W,this._onContentChange);this.after(X+W,this._afterNodeFocusedChange);this.publish(Z,{defaultFn:this._defClickFn});this.publish(p,{defaultFn:this._defToggleFn});this.publish(L,{defaultFn:this._defExpandFn});this.publish(f,{defaultFn:this._defCollapseFn});if(i in Q){this._changeParent(Q[i]);}if(R in Q){this._changeNextSibling(Q[R]);}if(c in Q){this._changePreviousSibling(Q[c]);}if(d in Q){console.log("content",this,this.get(d)&&(this.get(d).get("innerHTML")||this.get(d).get("textContent")));}if("yuiconfig" in Q){console.log("yuiconfig",this,Q.yuiconfig);}if(N in Q){Q[N].each(function(q){console.log("child",this,q.get("innerHTML"));(new B.TreeNode({parent:this,contentBox:q}));},this);}this.on("render",function(q){this._findRoot();});var Y=this.get(i);if(Y&&Y.get(j)){this.render(Y._childContainerEl);E.run();}},destructor:function(){for(var Y=0;Y<this._children.length;Y++){this._children[Y].destructor();}var Q=this.get(V);Q.set("innerHTML","");Q.removeClass(this._lastToggleClass);},renderUI:function(){E.add({fn:this._renderUIContainer,context:this,name:"renderUIContainer"});E.add({fn:this._renderUIChildren,context:this,name:"renderUIChildren"});},_findRoot:function(){var Q=this;var Y=function(s){var q,r=s.get(i);if(r){q=Y(r);}else{if(s._isRoot){q=s;}else{B.error(B.substitute(Q.getString("needsParent"),{me:Q,brokenRoot:s}));
}}s._set(k,q);return q;};Y(this);},_renderUIContainer:function(){var Q=this.get(V);var q=B.Node.create(P);q.set("tabIndex",0);this._labelContainerEl=q;Q.appendChild(q);this.set("container",q);var Y=this.get("content");if(Y instanceof B.Node){q.appendChild(Y);}e[this.get(m).get("id")]=this;},_renderUIChildren:function(){var Q=this.get(V);Q.appendChild(B.Node.create(O));this._childContainerEl=Q.query("."+g);for(var Y=0;Y<this._children.length;Y++){E.add({fn:this._children[Y].render,context:this._children[Y],args:[this._childContainerEl],name:"render"});}},bindUI:function(){this.after("parentChange",this._syncParentChange);this.after("nextSiblingChange",this._syncNextSiblingChange);this.after("previousSiblingChange",this._syncPreviousSiblingChange);this.after("contentChange",this._syncContentChange);this.addTarget(this.get(i));},syncUI:function(){var Y=B.Lang.isNull;if(this._isRoot){return;}var Q=F(T,D,(Y(this.get(R))?a:(Y(this.get(c))?M:K)),(this._children.length>0?(this.get(A)?G:S):I));this.get(V).replaceClass(this._lastToggleClass,Q);this._lastToggleClass=Q;},_genericNodeValidator:function(Y,Q){var q=this.get(Q);return(Y===null&&q!==null)||(Y instanceof h&&Y!==q);},_contentSetter:function(Q){if(B.Lang.isNull(Q)){return null;}if(Q instanceof B.Node){return Q;}if(Q.nodeType&&Q.nodeType==1){return B.get(Q);}if(B.Lang.isString(Q)){Q=B.Lang.trim(Q);return Q?B.Node.create(Q):null;}return B.Attribute.INVALID_VALUE;},_onContentChange:function(q){var Y=q.newVal;var Q=this.get("container");if(Q){Q.set("innerHTML","");Q.appendChild(Y);}},_syncContentChange:function(Q){},_detach:function(t,Y){var r=Y||this.get(i),u=false;if(r&&r!==t){var v=r._children;for(var Q=0;Q<v.length;Q++){if(this===v[Q]){v.splice(Q,1);u=true;break;}}if(!u&&v.length){B.error(B.substitute(this.getString("orphan"),{me:this}));}}var q=this.get(R),s=this.get(c);if(q){q.set(c,s,{internal:true});}if(s){s.set(R,q,{internal:true});}},_onParentChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q,Y.prevVal);this._changeParent(Q);},_changeParent:function(Y){var q;this.set(R,null,{internal:true});q=Y._children;var Q=q.length&&q[q.length-1];if(Q){this.set(c,Q,{internal:true});Q.set(R,this,{internal:true});}q.push(this);},_syncParentChange:function(Q){if(Q.internal){return;}E.add({fn:this._move,context:this,name:"_move"});},_onNextSiblingChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q&&Q.get(i));this._changeNextSibling(Q);},_changeNextSibling:function(Y){var r,t,q,s,Q;r=Y&&Y.get(i);if(r){t=r._children;s=false;for(Q=0;Q<t.length;Q++){if(Y===t[Q]){t.splice(Q,0,this);s=true;break;}}if(!s&&t.length){B.error(B.substitute(this.getString("nextSiblingNotChild"),{me:this,next:Y,parent:r}));}this.set(i,r,{internal:true});}this.set(R,Y,{internal:true});q=Y.get(c);if(q){this.set(c,q,{internal:true});q.set(R,this,{internal:true});}Y.set(c,this,{internal:true});},_syncNextSiblingChange:function(Q){if(Q.internal){return;}E.add({fn:this._move,context:this,name:"_move"});},_onPreviousSiblingChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q&&Q.get(i));this._changePreviousSibling(Q);},_changePreviousSibling:function(r){var q,t,Y,s,Q;q=r&&r.get(i);if(q){t=q._children;s=false;for(Q=0;Q<t.length;Q++){if(r===t[Q]){t.splice(Q+1,0,this);s=true;break;}}if(!s&&t.length){B.error(B.substitute(this.getString("previousSiblingNotChild"),{me:this,previous:r,parent:q}));}this.set(i,q,{internal:true});}this.set(c,r,{internal:true});Y=r.get(R);if(Y){this.set(R,Y,{internal:true});Y.set(c,this,{internal:true});}r.set(R,this,{internal:true});},_syncPreviousSiblingChange:function(Q){if(Q.internal){return;}E.add({fn:this._move,context:this,name:"_move"});},_move:function(){var Q=this.get(m),r=this.get(i),s=r&&r._childContainerEl,q=this.get(R),Y=q&&q.get(m);if(s){if(Y){s.insertBefore(Q,Y);}else{s.appendChild(Q);}}this.syncUI();},removeChild:function(Q){Q.set(i,null);return Q;},appendChild:function(Q){return this.insertNode(Q);},insertChild:function(q,Q){var Y;if(q.get(c)||q.get(c)||q.get(i)){B.error("Cannot insert a node attached elsewhere ["+q+"]");return false;}if(B.Lang.isNumber(Q)){if(Q>=0&&Q<this._children.length){Y=this._children[Y];}else{B.error(B.substritute(this.getString("positionOutOfBounds"),{child:q,position:Y,me:this}));return false;}}else{Y=Q;}if(Y instanceof h){if(Y.get(i)!==this){B.error(B.substitute(this.getString("positionNotInParent"),{child:q,position:Y,me:this}));return false;}q.set(R,Y);}else{if(B.Lang.isUndefined(Y)){q.set(i,this);}else{B.error(B.substitute(this.getString("positionArgumentInvalid"),{child:q,position:Y,me:this}));return false;}}return q;},toString:function(){return(this.get(d)&&this.get(d).get("textContent"))||this._yuid;},_defClickFn:function(Q){console.log("_defClickFn",this,arguments);if(Q.node!==this){return;}console.log("_defClickFn 2",this,arguments);this.toggle();},toggle:function(){console.log("toggle",this,arguments);if(this._children.length){this.fire(p,{node:this});}},_defToggleFn:function(Q){if(Q.node!==this){return;}console.log("_defToggleFn",this,arguments);if(this.get(A)){this.collapse();}else{this.expand();}Q.stopPropagation();},expand:function(){console.log("expand",this,arguments);if(this.get(A)){return;}this.fire(L,{node:this});},_defExpandFn:function(Q){if(Q.node!==this){return;}console.log("_defExpandFn",this,arguments);this.set(A,true);this.syncUI();},collapse:function(){console.log("collapse",this,arguments);if(!this.get(A)){return;}this.fire(f,{node:this});},_defCollapseFn:function(Q){if(Q.node!==this){return;}console.log("_defCollapseFn",this,arguments);this.set(A,false);this.syncUI();},_afterNodeFocusedChange:function(Q){console.log("_afterFocusedChange",Q,this);if(Q.target!=this){return;}console.log("_afterFocusedChange 1",Q,this);this.get(k).set(H,this,{node:this});}});B.TreeNode=h;var o="treeview";var l={BACK_SPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,PLUS:43,MINUS:45};
var J=function(){J.superclass.constructor.apply(this,arguments);};B.mix(J,{NAME:o,ATTRS:{currentFocus:{value:null,validator:function(Q){return this._genericNodeValidator(Q,H);}}},HTML_PARSER:{}});B.extend(J,B.TreeNode,{BOUNDING_TEMPLATE:"<div></div>",CONTENT_TEMPLATE:"<ul></ul>",_isRoot:true,initializer:function(Q){Q=Q||{};if(i in Q){delete Q[i];}this.set(k,this);J.superclass.initializer.apply(this,arguments);this.after(H+W,this._afterCurrentFocusChange);},renderUI:function(){var Q=this.get(V);Q.addClass(g);this._childContainerEl=Q;for(var Y=0;Y<this._children.length;Y++){this._children[Y].render(Q);}E.run();},bindUI:function(){var Q=this.get(m);B.on("click",B.bind(this._onClick,this),Q);B.on("key",this._onKey,Q,"press:"+[l.UP,l.DOWN,l.LEFT,l.RIGHT,l.ENTER,l.PLUS,l.MINUS,l.HOME,l.END].join(","),this);B.on("key",this._onShiftedKey,Q,"press:"+[l.PLUS,l.MINUS].join(",")+"+shift",this);},_onClick:function(Y){var q=Y.target;var Q=this.getNodeByElement(q);console.log("_onClick",this,arguments,Q);if(Q){if(q.hasClass(C)){Q.fire(Z,{node:Q});}else{if(q.hasClass(b)){Q.toggle();}}}},_onKey:function(Q){console.log("_onKey",Q.keyCode,this);switch(Q.keyCode){case l.UP:break;case l.DOWN:break;case l.LEFT:break;case l.RIGHT:break;case l.ENTER:break;case l.PLUS:break;case l.MINUS:break;case l.HOME:break;case l.END:break;}},_onShiftedKey:function(Q){console.log("_onShiftedKey",Q.keyCode);switch(Q.keyCode){case l.PLUS:break;case l.MINUS:break;}},getNodeByElement:function(Q){var Y=Q.ancestor("."+F(T));return Y&&e[Y.get("id")];},_afterCurrentFocusChange:function(Q){console.log("_afterCurrentFocusChange",Q);if(Q.node!==Q.newVal){return;}(Q.prevVal&&Q.prevVal.blur());(Q.newVal&&B.Lang.isUndefined(Q.node)&&Q.newVal.focus());}});B.TreeView=J;},"@VERSION@",{requires:["widget","queue"]});