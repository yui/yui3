YUI.add("treeview",function(B){var T="treenode",U="contentBox",k="boundingBox",i="rendered",A="expanded",h="parent",a="previousSibling",R="nextSibling",j="root",b="content",G=B.ClassNameManager.getClassName,D="toggle",I="leaf",S="plus",H="minus",M="first",K="middle",X="last",l="label",V="magnet",N="children",C=G(T,l),E=G(T,V),f=G(T,N),Z=G(T,b),P='<div class ="'+C+'"></div>',d='<a class ="'+E+'" href ="#">&nbsp;</a>',O='<ul class ="'+f+'"></ul>',W="click",n="toggle",L="expand",e="collapse",F=new B.Queue(),c={};var g=function(){g.superclass.constructor.apply(this,arguments);};B.mix(g,{NAME:T,ATTRS:{children:{readOnly:true,getter:function(){return B.mix({},this._children);}},dataLoader:{value:null},depth:{value:undefined},editable:{value:false},enableHighlight:{value:false},expanded:{value:false},isLeaf:{value:false},multiExpand:{value:true},nextSibling:{value:null,validator:function(Q){return this._nextSiblingValidator(Q);}},previousSibling:{value:null,validator:function(Q){return this._previousSiblingValidator(Q);}},parent:{value:null,validator:function(Q){return this._parentValidator(Q);}},root:{value:null,readOnly:true},content:{value:null,setter:function(Q){return this._contentSetter(Q);}},container:{writeOnce:true},strings:{value:{badContent:"Rejected attempt to set invalid content [{val}] on node [{me}]",orphan:"TreeNode [{me}] was already an orphan",setParent:"Setting new parent [{parent}] of [{me}]",setNextSibling:"Setting new next sibling [{next}] of [{me}]",setPreviousSibling:"Setting new previous sibling [{previous}] of [{me}]",nextSiblingNotChild:"Position of next sibling [{next}] amongst parent [{parent}] children not found",previousSiblingNotChild:"Position of previous sibling [{previous}] amongst parent [{parent}] children not found",moving:"Moving [{node}] under [{parent}] in between [{previous}] and [{next}]",removing:"Removing child [{child}] from parent [{me}]",inserting:"Inserting child [{child}] into [{me}] at position [{position}]",positionOutOfBounds:"Tried to insert child [{child}] out of bounds at position [{position}] under parent [{me}]",positionNotInParent:"Cannot insert node [{child}] before a node [{position}] that is not a child of this node [{me}]",positionArgumentInvalid:"Argument position in method insertNode should be an integer, a TreeNode reference or undefined, was [{position}]",cantHaveParent:'Config "parent" ignored. The TreeView object is the root of the tree, it can\'t have a parent.',needsParent:"When looking for the root of [{me}] found no parent above [{brokenRoot}]"}}},HTML_PARSER:{content:function(Y){var o=Y.get("firstChild");var Q=o.get("nodeName").toUpperCase();if(Q=="UL"||Q=="OL"){return"";}if(o.get("nodeType")==3){return B.Lang.trim(o.get("textContent"))||undefined;}return o;},children:[">ul>li,>ol>li"],yuiconfig:function(Q){return Q.getAttribute("yuiconfig");}}});B.extend(g,B.Widget,{_children:null,_childContainerEl:null,_dontPropagate:false,_lastToggleClass:"",BOUNDING_TEMPLATE:"<li></li>",initializer:function(Q){this._children=[];this.set("locale","es");this.set("strings",{badContent:"Rechazada la asignaci&oacute;n de contenido inv&aacute;lido [{val}] al nodo [{me}]",orphan:"El TreeNode [{me}] ya era hu&eacute;rfano",setParent:"Estableciendo nuevo padre [{parent}] para [{me}]",setNextSibling:"Estableciendo nuevo hermano siguiente [{next}] para [{me}]",setPreviousSibling:"Estableciendo nuevo hermano previo [{previous}] para [{me}]",nextSiblingNotChild:"No se ha encontrado la position del hermano siguiente [{next}] entre los hijos del padre [{parent}]",previousSiblingNotChild:"No se ha encontrado la position del hermano previo [{previous}] entre los hijos del padre [{parent}]",moving:"Moviendo [{node}] bajo [{parent}] entre [{previous}] y [{next}]",removing:"Retirando el hijo [{child}] del padre [{me}]",inserting:"Insertando el hijo [{child}] bajo el padre [{me}] en la posici&oacute;n [{position}]",positionOutOfBounds:"Rechazado el intento de insertar el hijo [{child}] fuera de rango en la posici&oacute;n [{position}] bajo el padre [{me}]",positionNotInParent:"No se puede insertar el nodo [{child}] antes de un nodo [{position}] que no es hijo de este padre [{me}]",positionArgumentInvalid:"El argumento 'position' en el m&eacute;todo 'insertNode' debe ser un entero, un TreeNode o 'undefined', fue [{position}]",cantHaveParent:'Se ignorar&aacute; el Atributo "parent". El objeto TreeView es la ra&iacute;z del &aacute;rbol, no puede tener padre.',needsParent:"Al buscar la ra&iacute;z para [{me}] no se pudo encontrar el padre de [{brokenRoot}]"});Q=Q||{};this.on("parentChange",this._onParentChange);this.on("nextSiblingChange",this._onNextSiblingChange);this.on("previousSiblingChange",this._onPreviousSiblingChange);this.on("contentChange",this._onContentChange);this.publish(W,{defaultFn:this._defClickFn});this.publish(n,{defaultFn:this._defToggleFn});this.publish(L,{defaultFn:this._defExpandFn});this.publish(e,{defaultFn:this._defCollapseFn});if(h in Q){this._changeParent(Q[h]);}if(R in Q){this._changeNextSibling(Q[R]);}if(a in Q){this._changePreviousSibling(Q[a]);}if(b in Q){console.log("content",this,this.get(b)&&(this.get(b).get("innerHTML")||this.get(b).get("textContent")));}if("yuiconfig" in Q){console.log("yuiconfig",this,Q.yuiconfig);}if(N in Q){Q[N].each(function(o){console.log("child",this,o.get("innerHTML"));(new B.TreeNode({parent:this,contentBox:o}));},this);}this.on("render",function(o){this._findRoot();});var Y=this.get(h);if(Y&&Y.get(i)){this.render(Y._childContainerEl);F.run();}},destructor:function(){for(var Y=0;Y<this._children.length;Y++){this._children[Y].destructor();}var Q=this.get(U);Q.set("innerHTML","");Q.removeClass(this._lastToggleClass);},renderUI:function(){F.add({fn:this._renderUIContainer,context:this,name:"renderUIContainer"});F.add({fn:this._renderUIChildren,context:this,name:"renderUIChildren"});if(!this.get(h)){F.run();}},_findRoot:function(){var Q=this;var Y=function(q){var o,p=q.get(h);if(p){o=Y(p);}else{if(q._isRoot){o=q;
}else{B.error(B.substitute(Q.getString("needsParent"),{me:Q,brokenRoot:q}));}}q._set(j,o);return o;};this._set(j,Y(this));},_renderUIContainer:function(){var Q=this.get(U);var o=B.Node.create(P);Q.appendChild(o);this.set("container",o);var Y=this.get("content");if(Y instanceof B.Node){o.appendChild(Y);}Q.appendChild(B.Node.create(d));c[this.get(k).get("id")]=this;},_renderUIChildren:function(){var Q=this.get(U);Q.appendChild(B.Node.create(O));this._childContainerEl=Q.query("."+f);for(var Y=0;Y<this._children.length;Y++){F.add({fn:this._children[Y].render,context:this._children[Y],args:[this._childContainerEl],name:"render"});}},bindUI:function(){this.after("parentChange",this._syncParentChange);this.after("nextSiblingChange",this._syncNextSiblingChange);this.after("previousSiblingChange",this._syncPreviousSiblingChange);this.after("contentChange",this._syncContentChange);this.addTarget(this.get(h));},syncUI:function(){var Y=B.Lang.isNull;if(this._isRoot){return;}var Q=G(T,D,(Y(this.get(R))?X:(Y(this.get(a))?M:K)),(this._children.length>0?(this.get(A)?H:S):I));this.get(U).replaceClass(this._lastToggleClass,Q);this._lastToggleClass=Q;},_genericNodeValidator:function(Y,Q){var o=this.get(Q);return(Y===null&&o!==null)||(Y instanceof g&&Y!==o);},_parentValidator:function(Q){return this._genericNodeValidator(Q,h);},_nextSiblingValidator:function(Q){return this._genericNodeValidator(Q,R);},_previousSiblingValidator:function(Q){return this._genericNodeValidator(Q,a);},_contentSetter:function(Q){if(B.Lang.isNull(Q)){return null;}if(Q instanceof B.Node){return Q;}if(Q.nodeType&&Q.nodeType==1){return B.get(Q);}if(B.Lang.isString(Q)){Q=B.Lang.trim(Q);return Q?B.Node.create(Q):null;}return B.Attribute.INVALID_VALUE;},_onContentChange:function(o){var Y=o.newVal;var Q=this.get("container");if(Q){Q.set("innerHTML","");Q.appendChild(Y);}},_syncContentChange:function(Q){},_detach:function(r,Y){var p=Y||this.get(h),s=false;if(p&&p!==r){var t=p._children;for(var Q=0;Q<t.length;Q++){if(this===t[Q]){t.splice(Q,1);s=true;break;}}if(!s&&t.length){B.error(B.substitute(this.getString("orphan"),{me:this}));}}var o=this.get(R),q=this.get(a);if(o){o.set(a,q,{internal:true});}if(q){q.set(R,o,{internal:true});}},_onParentChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q,Y.prevVal);this._changeParent(Q);},_changeParent:function(Y){var o;this.set(R,null,{internal:true});o=Y._children;var Q=o.length&&o[o.length-1];if(Q){this.set(a,Q,{internal:true});Q.set(R,this,{internal:true});}o.push(this);},_syncParentChange:function(Q){if(Q.internal){return;}F.add({fn:this._move,context:this,name:"_move"});},_onNextSiblingChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q&&Q.get(h));this._changeNextSibling(Q);},_changeNextSibling:function(Y){var p,r,o,q,Q;p=Y&&Y.get(h);if(p){r=p._children;q=false;for(Q=0;Q<r.length;Q++){if(Y===r[Q]){r.splice(Q,0,this);q=true;break;}}if(!q&&r.length){B.error(B.substitute(this.getString("nextSiblingNotChild"),{me:this,next:Y,parent:p}));}this.set(h,p,{internal:true});}this.set(R,Y,{internal:true});o=Y.get(a);if(o){this.set(a,o,{internal:true});o.set(R,this,{internal:true});}Y.set(a,this,{internal:true});},_syncNextSiblingChange:function(Q){if(Q.internal){return;}F.add({fn:this._move,context:this,name:"_move"});},_onPreviousSiblingChange:function(Y){if(Y.internal){return;}var Q=Y.newVal;this._detach(Q&&Q.get(h));this._changePreviousSibling(Q);},_changePreviousSibling:function(p){var o,r,Y,q,Q;o=p&&p.get(h);if(o){r=o._children;q=false;for(Q=0;Q<r.length;Q++){if(p===r[Q]){r.splice(Q+1,0,this);q=true;break;}}if(!q&&r.length){B.error(B.substitute(this.getString("previousSiblingNotChild"),{me:this,previous:p,parent:o}));}this.set(h,o,{internal:true});}this.set(a,p,{internal:true});Y=p.get(R);if(Y){this.set(R,Y,{internal:true});Y.set(a,this,{internal:true});}p.set(R,this,{internal:true});},_syncPreviousSiblingChange:function(Q){if(Q.internal){return;}F.add({fn:this._move,context:this,name:"_move"});},_move:function(){var Q=this.get(k),p=this.get(h),q=p&&p._childContainerEl,o=this.get(R),Y=o&&o.get(k);if(q){if(Y){q.insertBefore(Q,Y);}else{q.appendChild(Q);}}this.syncUI();},removeChild:function(Q){Q.set(h,null);return Q;},appendChild:function(Q){return this.insertNode(Q);},insertChild:function(o,Q){var Y;if(o.get(a)||o.get(a)||o.get(h)){B.error("Cannot insert a node attached elsewhere ["+o+"]");return false;}if(B.Lang.isNumber(Q)){if(Q>=0&&Q<this._children.length){Y=this._children[Y];}else{B.error(B.substritute(this.getString("positionOutOfBounds"),{child:o,position:Y,me:this}));return false;}}else{Y=Q;}if(Y instanceof g){if(Y.get(h)!==this){B.error(B.substitute(this.getString("positionNotInParent"),{child:o,position:Y,me:this}));return false;}o.set(R,Y);}else{if(B.Lang.isUndefined(Y)){o.set(h,this);}else{B.error("Argument next in method insertNode should be an integer, a TreeNode reference or undefined "+Y);return false;}}return o;},toString:function(){return(this.get(b)&&this.get(b).get("textContent"))||this._yuid;},_defClickFn:function(Q){console.log("_defClickFn",this,arguments);if(Q.node!==this){return;}console.log("_defClickFn 2",this,arguments);this.toggle();},toggle:function(){console.log("toggle",this,arguments);if(this._children.length){this.fire(n,{node:this});}},_defToggleFn:function(Q){if(Q.node!==this){return;}console.log("_defToggleFn",this,arguments);if(this.get(A)){this.collapse();}else{this.expand();}Q.stopPropagation();},expand:function(){console.log("expand",this,arguments);this.fire(L,{node:this});},_defExpandFn:function(Q){if(Q.node!==this){return;}console.log("_defExpandFn",this,arguments);this.set(A,true);this.syncUI();},collapse:function(){console.log("collapse",this,arguments);this.fire(e,{node:this});},_defCollapseFn:function(Q){if(Q.node!==this){return;}console.log("_defCollapseFn",this,arguments);this.set(A,false);this.syncUI();}});B.TreeNode=g;var m="treeview";var J=function(){J.superclass.constructor.apply(this,arguments);};B.mix(J,{NAME:m,ATTRS:{},HTML_PARSER:{}});
B.extend(J,B.TreeNode,{BOUNDING_TEMPLATE:"<div></div>",CONTENT_TEMPLATE:"<ul></ul>",_isRoot:true,initializer:function(Q){Q=Q||{};if(h in Q){delete Q[h];}this.set(j,this);J.superclass.initializer.apply(this,arguments);},_renderUIContainer:null,_renderUIChildren:function(){var Q=this.get(U);Q.addClass(f);this._childContainerEl=Q;for(var Y=0;Y<this._children.length;Y++){F.add({fn:this._children[Y].render,context:this._children[Y],args:[Q],name:"render"});}},bindUI:function(){B.on("click",B.bind(this._onClick,this),this.get(k));},_onClick:function(Y){var o=Y.target;var Q=this.getNodeByElement(o);console.log("_noClick",this,arguments,Q);if(Q){if(o.hasClass(C)||o.hasClass(E)){Q.fire(W,{node:Q});}else{if(o.hasClass(Z)){Q.toggle();}}}},getNodeByElement:function(Q){var Y=Q.ancestor("."+G(T));return Y&&c[Y.get("id")];}});B.TreeView=J;},"@VERSION@",{requires:["widget","queue"]});