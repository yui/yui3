YUI.add("history-base",function(B){var F=B.Lang,D=B.Object,H=YUI.namespace("Env.History"),G="change",I="historyBase",A="add",E="replace",C=function(){this._init.apply(this,arguments);};B.augment(C,B.EventTarget,null,null,{emitFacade:true,prefix:"history",preventable:false,queueable:true});if(!H._state){H._state={};}C.NAME=I;C.SRC_ADD=A;C.SRC_REPLACE=E;B.mix(C.prototype,{_init:function(K){var J=K&&K.initialState;this.publish(G,{broadcast:2,defaultFn:this._defChangeFn});if(F.isObject(J)&&!F.isFunction(J)&&!F.isArray(J)){this.add(B.merge(H._state,J));}},add:function(K,J){return this._change(A,K,J);},get:function(J){var K=H._state;if(J){return D.owns(K,J)?K[J]:undefined;}else{return B.mix({},K,true);}},replace:function(K,J){return this._change(E,K,J);},_change:function(M,L,K){var J;if(F.isString(L)){J=L;L={};L[J]=K;}this._resolveChanges(M,B.merge(H._state,L));return this;},_fireEvents:function(K,J){this.fire(G,{changed:J.changed,newVal:J.newState,prevVal:J.prevState,removed:J.removed,src:K});D.each(J.changed,function(M,L){this._fireChangeEvent(K,L,M);},this);D.each(J.removed,function(M,L){this._fireRemoveEvent(K,L,M);},this);},_fireChangeEvent:function(L,J,K){this.fire(J+"Change",{newVal:K.newVal,prevVal:K.prevVal,src:L});},_fireRemoveEvent:function(L,J,K){this.fire(J+"Remove",{prevVal:K,src:L});},_resolveChanges:function(O,M){var N={},J,L=H._state,K={};M=M||{};D.each(M,function(P,Q){var R=L[Q];if(P!==R){N[Q]={newVal:P,prevVal:R};J=true;}},this);D.each(L,function(Q,P){if(!D.owns(M,P)||M[P]===null){delete M[P];K[P]=Q;J=true;}},this);if(J){this._fireEvents(O,{changed:N,newState:M,prevState:L,removed:K});}},_storeState:function(K,J){H._state=J||{};},_defChangeFn:function(J){this._storeState(J.src,J.newVal);}},true);B.HistoryBase=C;},"@VERSION@",{requires:["event-custom-complex"]});YUI.add("history-hash",function(A){var D=A.HistoryBase,K=A.Lang,J=A.Object,N=YUI.namespace("Env.History"),C="hash",B=A.config,P=B.doc,I=P.documentMode,H,G,M,L=B.win,O=L.location,F=!K.isUndefined(L.onhashchange)&&(K.isUndefined(I)||I>7),E=function(){E.superclass.constructor.apply(this,arguments);};A.extend(E,D,{_init:function(Q){Q=Q||{};Q.initialState=Q.initialState||E.parseHash();A.after("hashchange",A.bind(this._afterHashChange,this),L);E.superclass._init.call(this,Q);},_storeState:function(S,R){var Q=E.createHash(R);E.superclass._storeState.apply(this,arguments);if(E.getHash()!==Q){E[S===D.SRC_REPLACE?"replaceHash":"setHash"](Q);}},_afterHashChange:function(Q){this._resolveChanges(C,E.parseHash(Q.newHash));}},{NAME:"history",SRC_HASH:C,hashPrefix:"",nativeHashChange:F,_REGEX_HASH:/([^\?#&]+)=([^&]+)/g,createHash:function(S){var Q=E.encode,R=[];J.each(S,function(U,T){if(K.isValue(U)){R.push(Q(T)+"="+Q(U));}});return R.join("&");},decode:function(Q){return decodeURIComponent(Q.replace(/\+/g," "));},encode:function(Q){return encodeURIComponent(Q).replace(/%20/g,"+");},getHash:(A.UA.gecko?function(){var R=/#(.*)$/.exec(O.href),S=R&&R[1]||"",Q=E.hashPrefix;return Q&&S.indexOf(Q)===0?S.replace(Q,""):S;}:function(){var R=O.hash.substr(1),Q=E.hashPrefix;return Q&&R.indexOf(Q)===0?R.replace(Q,""):R;}),getUrl:function(){return O.href;},parseHash:function(T){var Q=E.decode,U,X,V,R,S={},W=E.hashPrefix,Y;T=K.isValue(T)?T:E.getHash();if(W){Y=T.indexOf(W);if(Y===0||(Y===1&&T.charAt(0)==="#")){T=T.replace(W,"");}}V=T.match(E._REGEX_HASH)||[];for(U=0,X=V.length;U<X;++U){R=V[U].split("=");S[Q(R[0])]=Q(R[1]);}return S;},replaceHash:function(Q){if(Q.charAt(0)==="#"){Q=Q.substr(1);}O.replace("#"+(E.hashPrefix||"")+Q);},setHash:function(Q){if(Q.charAt(0)==="#"){Q=Q.substr(1);}O.hash=(E.hashPrefix||"")+Q;}});H=YUI.namespace("Env.History._hashNotifiers");A.Event.define("hashchange",{on:function(S,Q,R){if((S.compareTo(L)||S.compareTo(P.body))&&!J.owns(H,R.key)){H[R.key]=R;}},detach:function(S,Q,R){if(!R.hasSubs()){delete H[R.key];}}});G=E.getHash();M=E.getUrl();if(F){A.Event.attach("hashchange",function(S){var Q=E.getHash(),R=E.getUrl();J.each(H,function(T){T.fire({oldHash:G,oldUrl:M,newHash:Q,newUrl:R});});G=Q;M=R;},L);}else{if(!N._hashPoll){if(A.UA.webkit&&!A.UA.chrome){A.on("unload",function(){},L);}N._hashPoll=A.later(B.pollInterval||50,null,function(){var Q=E.getHash(),R;if(G!==Q){R=E.getUrl();J.each(H,function(S){S.fire({oldHash:G,oldUrl:M,newHash:Q,newUrl:R});});G=Q;M=R;}},null,true);}}A.History=E;},"@VERSION@",{requires:["event-synthetic","history-base","yui-later"]});YUI.add("history-hash-ie",function(G){var B=G.Do,C=YUI.namespace("Env.History"),E=G.History,D=C._iframe,F=G.config.win,A=F.location;if(G.UA.ie&&G.UA.ie<8){E.getHash=function(){return D?D.contentWindow.location.hash.substr(1):"";};E.getUrl=function(){var H=E.getHash();if(H&&H!==A.hash.substr(1)){return A.href.replace(/#.*$/,"")+"#"+H;}else{return A.href;}};E._updateIframe=function(I,H){var J=D.contentWindow.document,K=J.location;J.open().close();if(H){K.replace(I.charAt(0)==="#"?I:"#"+I);}else{K.hash=I;}};B.after(E._updateIframe,E,"replaceHash",E,true);B.after(E._updateIframe,E,"setHash");if(!D){D=C._iframe=G.Node.getDOMNode(G.Node.create('<iframe src="javascript:0" style="display:none"/>'));G.on("domready",function(){G.config.doc.documentElement.appendChild(D);E._updateIframe(A.hash.substr(1));});G.on("hashchange",function(H){if(A.hash.substr(1)!==H.newHash){A.hash=H.newHash;}},F);}}},"@VERSION@",{requires:["history-base","history-hash","node-base"]});YUI.add("history",function(A){},"@VERSION@",{use:["history-base","history-hash","history-hash-ie"]});