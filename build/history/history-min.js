YUI.add("history-base",function(G){var E=G.Lang,D=G.Object,C=YUI.namespace("Env.History"),A="change",F="historyBase",B=function(H){this._init.apply(this,arguments);};G.augment(B,G.Event.Target,null,null,{emitFacade:true,prefix:"history",preventable:false,queueable:true});if(!C._state){C._state={};}B.NAME=F;G.mix(B.prototype,{_init:function(H){this.publish(A,{broadcast:2,defaultFn:G.bind(this._defChangeFn,this)});if(E.isObject(H)&&!E.isFunction(H)&&!E.isArray(H)){this.add(G.merge(C._state,H));}},add:function(H){this._resolveChanges(G.merge(C._state,H));return this;},get:function(H){var I=C._state;if(H){return D.owns(I,H)?I[H]:undefined;}else{return G.mix({},I,true);}},replace:function(H){this._resolveChanges(G.merge(C._state,H),true);return this;},_fireChangeEvent:function(I,H){this.fire(H+"Change",{newVal:I.newVal,prevVal:I.prevVal});},_fireRemoveEvent:function(I,H){this.fire(H+"Remove",{prevVal:I});},_handleChanges:function(I,H){if(H){this._storeState(I.newState);}else{this.fire(A,{changed:I.changed,newVal:I.newState,prevVal:I.prevState,removed:I.removed});D.each(I.changed,this._fireChangeEvent,this);D.each(I.removed,this._fireRemoveEvent,this);}},_resolveChanges:function(L,I){var M={},H,K=C._state,J={};L=L||{};D.each(L,function(N,O){var P=K[O];if(N!==P){M[O]={newVal:N,prevVal:P};H=true;}},this);D.each(K,function(O,N){if(!D.owns(L,N)){J[N]=O;H=true;}},this);if(H){this._handleChanges({changed:M,newState:L,prevState:K,removed:J},I);}},_storeState:function(H){C._state=H||{};},_defChangeFn:function(H){this._storeState(H.newVal);}},true);G.HistoryBase=B;},"@VERSION@",{requires:["event-custom-complex"]});YUI.add("history-hash",function(A){var I=A.Lang,G=A.Object,L=YUI.namespace("Env.History"),B=A.config,N=B.doc,H=N.documentMode,F,E,K,J=B.win,M=J.location,D=!I.isUndefined(J.onhashchange)&&(I.isUndefined(H)||H>7),C=function(O){C.superclass.constructor.call(this,O);};A.extend(C,A.HistoryBase,{_init:function(O){this.constructor.superclass._init.apply(this,arguments);A.after("hashchange",A.bind(this._afterHashChange,this),J);},_handleChanges:function(Q,O){var P=this.constructor;P[O?"replaceHash":"setHash"](P.createHash(Q.newState));P.superclass._handleChanges.apply(this,arguments);},_afterHashChange:function(){this._resolveChanges(this.constructor.parseHash());}},{NAME:"history",nativeHashChange:D,_REGEX_HASH:/([^\?#&]+)=([^&]+)/g,createHash:function(P){var O=[];G.each(P,function(R,Q){if(I.isValue(R)){O.push(C.encode(Q)+"="+C.encode(R));}});return"#"+O.join("&");},decode:function(O){return decodeURIComponent(O.replace(/\+/g," "));},encode:function(O){return encodeURIComponent(O).replace(/%20/g,"+");},getHash:(A.UA.gecko?function(){var O=/#.*$/.exec(M.href);return O&&O[0]?O[0]:"";}:function(){return M.hash;}),parseHash:function(S){S=S||C.getHash();var R=C.decode,P,Q=S.match(C._REGEX_HASH)||[],O=Q.length,U,T={};for(P=0;P<O;++P){U=Q[P].split("=");T[R(U[0])]=R(U[1]);}return T;},replaceHash:function(O){M.replace(O.indexOf("#")===0?O:"#"+O);},setHash:function(O){M.hash=O;}});F=YUI.namespace("Env.History._hashNotifiers");A.Event.define("hashchange",{on:function(Q,O,P){if((Q.compareTo(J)||Q.compareTo(N.body))&&!G.owns(F,P.key)){F[P.key]=P;}},detach:function(Q,O,P){if(!P.hasSubs()){delete F[P.key];}}});E=C.getHash();K=M.href;if(D){A.Event.attach("hashchange",function(Q){var O=C.getHash(),P=M.href;G.each(F,function(R){R.fire({oldHash:E,oldUrl:K,newHash:O,newUrl:P});});E=O;K=P;},J);}else{if(!L._hashPoll){L._hashPoll=A.later(B.pollInterval||50,null,function(){var O=C.getHash(),P;if(E!==O){P=M.href;G.each(F,function(Q){Q.fire({oldHash:E,oldUrl:K,newHash:O,newUrl:P});});E=O;K=P;}},null,true);}}A.History=C;},"@VERSION@",{requires:["event-synthetic","history-base","yui-later"]});YUI.add("history",function(A){},"@VERSION@",{use:["history-base","history-hash"]});