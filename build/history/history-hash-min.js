YUI.add("history-hash",function(A){var I=A.Lang,G=A.Object,L=YUI.namespace("Env.History"),B=A.config,N=B.doc,H=N.documentMode,F,E,K,J=B.win,M=J.location,D=!I.isUndefined(J.onhashchange)&&(I.isUndefined(H)||H>7),C=function(O){C.superclass.constructor.apply(this,arguments);};A.extend(C,A.HistoryBase,{_init:function(O){O=O||{};O.initialState=O.initialState||this.constructor.parseHash();A.after("hashchange",A.bind(this._afterHashChange,this),J);this.constructor.superclass._init.call(this,O);},_storeState:function(Q,O){var P=this.constructor;P.superclass._storeState.apply(this,arguments);if(P.getHash()!==P.createHash(Q)){P[O?"replaceHash":"setHash"](P.createHash(Q));}},_afterHashChange:function(O){this._resolveChanges(this.constructor.parseHash(O.newHash));}},{NAME:"history",nativeHashChange:D,_REGEX_HASH:/([^\?#&]+)=([^&]+)/g,createHash:function(Q){var O=C.encode,P=[];G.each(Q,function(S,R){if(I.isValue(S)){P.push(O(R)+"="+O(S));}});return P.join("&");},decode:function(O){return decodeURIComponent(O.replace(/\+/g," "));},encode:function(O){return encodeURIComponent(O).replace(/%20/g,"+");},getHash:(A.UA.gecko?function(){var O=/#(.*)$/.exec(M.href);return O&&O[1]?O[1]:"";}:function(){return M.hash.substr(1);}),parseHash:function(S){S=S||C.getHash();var R=C.decode,P,Q=S.match(C._REGEX_HASH)||[],O=Q.length,U,T={};for(P=0;P<O;++P){U=Q[P].split("=");T[R(U[0])]=R(U[1]);}return T;},replaceHash:function(O){M.replace(O.indexOf("#")===0?O:"#"+O);},setHash:function(O){M.hash=O;}});F=YUI.namespace("Env.History._hashNotifiers");A.Event.define("hashchange",{on:function(Q,O,P){if((Q.compareTo(J)||Q.compareTo(N.body))&&!G.owns(F,P.key)){F[P.key]=P;}},detach:function(Q,O,P){if(!P.hasSubs()){delete F[P.key];}}});E=C.getHash();K=M.href;if(D){A.Event.attach("hashchange",function(Q){var O=C.getHash(),P=M.href;G.each(F,function(R){R.fire({oldHash:E,oldUrl:K,newHash:O,newUrl:P});});E=O;K=P;},J);}else{if(!L._hashPoll){if(A.UA.webkit&&!A.UA.chrome){A.on("unload",function(){},J);}L._hashPoll=A.later(B.pollInterval||50,null,function(){var O=C.getHash(),P;if(E!==O){P=M.href;G.each(F,function(Q){Q.fire({oldHash:E,oldUrl:K,newHash:O,newUrl:P});});E=O;K=P;}},null,true);}}A.History=C;},"@VERSION@",{requires:["event-synthetic","history-base","yui-later"]});