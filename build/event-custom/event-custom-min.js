YUI.add("event-custom",function(F){F.Env.evt={handles:{},plugins:{}};(function(){var G=0,H=1;F.Do={objs:{},before:function(J,L,M,N){var K=J,I;if(N){I=[J,N].concat(F.Array(arguments,4,true));K=F.rbind.apply(F,I);}return this._inject(G,K,L,M);},after:function(J,L,M,N){var K=J,I;if(N){I=[J,N].concat(F.Array(arguments,4,true));K=F.rbind.apply(F,I);}return this._inject(H,K,L,M);},_inject:function(I,K,L,N){var O=F.stamp(L),M,J;if(!this.objs[O]){this.objs[O]={};}M=this.objs[O];if(!M[N]){M[N]=new F.Do.Method(L,N);L[N]=function(){return M[N].exec.apply(M[N],arguments);};}J=O+F.stamp(K)+N;M[N].register(J,K,I);return new F.EventHandle(M[N],J);},detach:function(I){if(I.detach){I.detach();}},_unload:function(J,I){}};F.Do.Method=function(I,J){this.obj=I;this.methodName=J;this.method=I[J];this.before={};this.after={};};F.Do.Method.prototype.register=function(J,K,I){if(I){this.after[J]=K;}else{this.before[J]=K;}};F.Do.Method.prototype._delete=function(I){delete this.before[I];delete this.after[I];};F.Do.Method.prototype.exec=function(){var K=F.Array(arguments,0,true),L,J,O,M=this.before,I=this.after,N=false;for(L in M){if(M.hasOwnProperty(L)){J=M[L].apply(this.obj,K);if(J){switch(J.constructor){case F.Do.Halt:return J.retVal;case F.Do.AlterArgs:K=J.newArgs;break;case F.Do.Prevent:N=true;break;default:}}}}if(!N){J=this.method.apply(this.obj,K);}for(L in I){if(I.hasOwnProperty(L)){O=I[L].apply(this.obj,K);if(O&&O.constructor==F.Do.Halt){return O.retVal;}else{if(O&&O.constructor==F.Do.AlterReturn){J=O.newRetVal;}}}}return J;};F.Do.AlterArgs=function(J,I){this.msg=J;this.newArgs=I;};F.Do.AlterReturn=function(J,I){this.msg=J;this.newRetVal=I;};F.Do.Halt=function(J,I){this.msg=J;this.retVal=I;};F.Do.Prevent=function(I){this.msg=I;};F.Do.Error=F.Do.Halt;})();(function(){F.EventFacade=function(H,G){H=H||{};this.details=H.details;this.type=H.type;this.target=H.target;this.currentTarget=G;this.relatedTarget=H.relatedTarget;this.stopPropagation=function(){H.stopPropagation();};this.stopImmediatePropagation=function(){H.stopImmediatePropagation();};this.preventDefault=function(){H.preventDefault();};this.halt=function(I){H.halt(I);};};})();var C="_event:onsub",E="after",B=["broadcast","bubbles","context","configured","currentTarget","defaultFn","details","emitFacade","fireOnce","host","preventable","preventedFn","queuable","silent","stoppedFn","target","type"],A=new F.EventFacade(),D=9;F.EventHandle=function(G,H){this.evt=G;this.sub=H;};F.EventHandle.prototype={detach:function(){if(this.evt){this.evt._delete(this.sub);}}};F.CustomEvent=function(G,H){H=H||{};this.id=F.stamp(this);this.type=G;this.context=F;this.logSystem=(G=="yui:log");this.broadcast=0;this.silent=this.logSystem;this.queuable=false;this.subscribers={};this.afters={};this.fired=false;this.fireOnce=false;this.stopped=0;this.prevented=0;this.host=null;this.defaultFn=null;this.stoppedFn=null;this.preventedFn=null;this.preventable=true;this.bubbles=true;this.signature=D;this.hasSubscribers=false;this.hasAfters=false;this.emitFacade=false;this.applyConfig(H,true);this.log("Creating "+this.type);if(G!==C){this.subscribeEvent=new F.CustomEvent(C,{context:this,silent:true});}};F.CustomEvent.prototype={_YUI_EVENT:true,applyConfig:function(H,G){if(H){F.mix(this,H,G,B);}},_on:function(K,I,H,G){if(!K){F.error("Invalid callback for CE: "+this.type);}var L=this.subscribeEvent,J;if(L){L.fire.apply(L,H);}J=new F.Subscriber(K,I,H,G);if(this.fireOnce&&this.fired){F.later(0,this,this._notify,J);}if(G==E){this.afters[J.id]=J;this.hasAfters=true;}else{this.subscribers[J.id]=J;this.hasSubscribers=true;}return new F.EventHandle(this,J);},subscribe:function(H,G){return this._on(H,G,arguments,true);},on:function(H,G){return this._on(H,G,arguments,true);},after:function(H,G){return this._on(H,G,arguments,E);},detach:function(K,I){if(K&&K.detach){return K.detach();}if(!K){return this.unsubscribeAll();}var L=false,H=this.subscribers,G,J;for(G in H){if(H.hasOwnProperty(G)){J=H[G];if(J&&J.contains(K,I)){this._delete(J);L=true;}}}return L;},unsubscribe:function(){return this.detach.apply(this,arguments);},_getFacade:function(){var G=this._facade,J,H=this.details,I;if(!G){G=new F.EventFacade(this,this.currentTarget);}J=H&&H[0];if(F.Lang.isObject(J,true)){I={};F.mix(I,G,true,A);F.mix(G,J,true);F.mix(G,I,true);}G.details=this.details;G.target=this.target;G.currentTarget=this.currentTarget;G.stopped=0;G.prevented=0;this._facade=G;return this._facade;},_notify:function(K,I,G){this.log(this.type+"->"+": "+K);var H,J;if(this.emitFacade){if(!G){G=this._getFacade(I);if(F.Lang.isObject(I[0])){I[0]=G;}else{I.unshift(G);}}}H=K.notify(J||this.context,I,this);if(false===H||this.stopped>1){this.log(this.type+" cancelled by subscriber");return false;}return true;},log:function(H,G){if(!this.silent){}},fire:function(){var P=F.Env._eventstack,I,R,O,J,K,G,L,H,M,N=true,Q;if(P){if(this.queuable&&this.type!=P.next.type){this.log("queue "+this.type);P.queue.push([this,arguments]);return true;}}else{F.Env._eventstack={id:this.id,next:this,silent:this.silent,logging:(this.type==="yui:log"),stopped:0,prevented:0,queue:[]};P=F.Env._eventstack;}if(this.fireOnce&&this.fired){this.log("fireOnce event: "+this.type+" already fired");}else{O=F.Array(arguments,0,true);this.stopped=0;this.prevented=0;this.target=this.target||this.host;Q=new F.EventTarget({fireOnce:true,context:this.host});this.events=Q;if(this.preventedFn){Q.on("prevented",this.preventedFn);}if(this.stoppedFn){Q.on("stopped",this.stoppedFn);}this.currentTarget=this.host||this.currentTarget;this.fired=true;this.details=O.slice();this.log("Firing "+this.type);M=false;P.lastLogState=P.logging;K=null;if(this.emitFacade){this._facade=null;K=this._getFacade(O);if(F.Lang.isObject(O[0])){O[0]=K;}else{O.unshift(K);}}if(this.hasSubscribers){I=F.merge(this.subscribers);for(J in I){if(I.hasOwnProperty(J)){if(!M){P.logging=(P.logging||(this.type==="yui:log"));M=true;}if(this.stopped==2){break;}R=I[J];if(R&&R.fn){N=this._notify(R,O,K);if(false===N){this.stopped=2;
}}}}}P.logging=(P.lastLogState);if(this.bubbles&&this.host&&!this.stopped){P.stopped=0;P.prevented=0;N=this.host.bubble(this);this.stopped=Math.max(this.stopped,P.stopped);this.prevented=Math.max(this.prevented,P.prevented);}if(this.defaultFn&&!this.prevented){this.defaultFn.apply(this.host||this,O);}if(!this.stopped&&this.broadcast){if(this.host!==F){F.fire.apply(F,O);}if(this.broadcast==2){F.Global.fire.apply(F.Global,O);}}if(this.hasAfters&&!this.prevented&&this.stopped<2){I=F.merge(this.afters);for(J in I){if(I.hasOwnProperty(J)){if(!M){P.logging=(P.logging||(this.type==="yui:log"));M=true;}if(this.stopped==2){break;}R=I[J];if(R&&R.fn){N=this._notify(R,O,K);if(false===N){this.stopped=2;}}}}}}if(P.id===this.id){L=P.queue;while(L.length){G=L.pop();H=G[0];P.stopped=0;P.prevented=0;P.next=H;N=H.fire.apply(H,G[1]);}F.Env._eventstack=null;}return(N!==false);},unsubscribeAll:function(){return this.detachAll.apply(this,arguments);},detachAll:function(){var I=this.subscribers,H,G=0;for(H in I){if(I.hasOwnProperty(H)){this._delete(I[H]);G++;}}this.subscribers={};return G;},_delete:function(G){if(G){delete G.fn;delete G.context;delete this.subscribers[G.id];delete this.afters[G.id];}},toString:function(){return this.type;},stopPropagation:function(){this.stopped=1;F.Env._eventstack.stopped=1;this.events.fire("stopped",this);},stopImmediatePropagation:function(){this.stopped=2;F.Env._eventstack.stopped=2;this.events.fire("stopped",this);},preventDefault:function(){if(this.preventable){this.prevented=1;F.Env._eventstack.prevented=1;this.events.fire("prevented",this);}},halt:function(G){if(G){this.stopImmediatePropagation();}else{this.stopPropagation();}this.preventDefault();}};F.Subscriber=function(I,H,G){this.fn=I;this.context=H;this.id=F.stamp(this);this.wrappedFn=I;this.events=null;if(H){this.wrappedFn=F.rbind.apply(F,G);}};F.Subscriber.prototype={notify:function(G,I,L){var M=this.context||G,H=true,J=function(){switch(L.signature){case 0:H=this.fn.call(M,L.type,I,this.context);break;case 1:H=this.fn.call(M,I[0]||null,this.context);break;default:H=this.wrappedFn.apply(M,I||[]);}};if(F.config.throwFail){J.call(this);}else{try{J.call(this);}catch(K){F.error(this+" failed: "+K.message,K);}}return H;},contains:function(H,G){if(G){return((this.fn==H)&&this.context==G);}else{return(this.fn==H);}},toString:function(){return"Subscriber "+this.id;}};(function(){var G=F.Lang,I=":",J=/[,|]\s*/,K="~AFTER~",M=F.cached(function(P,O){var L=O;if(!G.isString(L)){return L;}if(L=="*"){return null;}if(L.indexOf(I)==-1&&P){L=P+I+L;}return L;}),H=F.cached(function(S,P){var O=P,R,Q,T,L;if(!G.isString(O)){return O;}L=O.indexOf(K);if(L>-1){T=true;O=O.substr(K.length);}R=O.split(J);if(R.length>1){Q=R[0];O=R[1];}O=M(S,O);return[Q,O,T];}),N=function(L){var O=(G.isObject(L))?L:{};this._yuievt={id:F.guid(),events:{},targets:{},config:O,chain:("chain" in O)?O.chain:F.config.chain,defaults:{context:O.context||this,host:this,emitFacade:O.emitFacade,fireOnce:O.fireOnce,queuable:O.queuable,broadcast:O.broadcast,bubbles:("bubbles" in O)?O.bubbles:true}};};N.prototype={on:function(Y,Z,O){var Q=H(this._yuievt.config.prefix,Y),T,X,V,U,P,W,S,a=F.Env.evt.handles,L,R;if(G.isObject(Y,true)){T=Z;X=O;V=F.Array(arguments,0,true);U={};L=Y._after;delete Y._after;F.each(Y,function(c,b){if(c){T=c.fn||((F.Lang.isFunction(c))?c:T);X=c.context||X;}V[0]=(L)?K+b:b;V[1]=T;V[2]=X;U[b]=this.on.apply(this,V);},this);return(this._yuievt.chain)?this:U;}else{if(G.isFunction(Y)){return F.Do.before.apply(F.Do,arguments);}}W=Q[0];Y=Q[1];L=Q[2];if(this instanceof YUI){R=F.Env.evt.plugins[Y];V=F.Array(arguments,0,true);V[0]=Y;if(R&&R.on){S=R.on.apply(F,V);}else{if((!Y)||(!R&&Y.indexOf(":")==-1)){S=F.Event.attach.apply(F.Event,V);}}}if(!S){P=this._yuievt.events[Y]||this.publish(Y);V=F.Array(arguments,1,true);T=(L)?P.after:P.on;S=T.apply(P,V);}if(W){a[W]=a[W]||{};a[W][Y]=a[W][Y]||[];a[W][Y].push(S);}return(this._yuievt.chain)?this:S;},subscribe:function(){return this.on.apply(this,arguments);},detach:function(X,Z,L){var Q=H(this._yuievt.config.prefix,X),W=G.isArray(Q)?Q[0]:null,S,T,a=F.Env.evt.handles,Y,V,b=this._yuievt.events,P,R,U=true,O=function(e,d){var c=e[d];if(c){while(c.length){S=c.pop();S.detach();}}};if(W){Y=a[W];X=Q[1];if(Y){if(X){O(Y,X);}else{for(R in Y){if(Y.hasOwnProperty(R)){O(Y,R);}}}return(this._yuievt.chain)?this:true;}}else{if(G.isObject(X)&&X.detach){U=X.detach();return(this._yuievt.chain)?this:true;}}T=F.Env.evt.plugins[X];if(this instanceof YUI){V=F.Array(arguments,0,true);if(T&&T.detach){return T.detach.apply(F,V);}else{if(!X||(!T&&X.indexOf(":")==-1)){V[0]=X;return F.Event.detach.apply(F.Event,V);}}}if(X){P=b[X];if(P){return P.detach(Z,L);}}else{for(R in b){if(b.hasOwnProperty(R)){U=U&&b[R].detach(Z,L);}}return U;}return(this._yuievt.chain)?this:false;},unsubscribe:function(){return this.detach.apply(this,arguments);},detachAll:function(L){L=M(this._yuievt.config.prefix,L);return this.detach(L);},unsubscribeAll:function(){return this.detachAll.apply(this,arguments);},publish:function(P,Q){P=M(this._yuievt.config.prefix,P);var O,R,L,S=Q||{};if(G.isObject(P)){L={};F.each(P,function(U,T){L[T]=this.publish(T,U||Q);},this);return L;}O=this._yuievt.events;R=O[P];if(R){R.applyConfig(Q,true);}else{F.mix(S,this._yuievt.defaults);R=new F.CustomEvent(P,S);O[P]=R;if(S.onSubscribeCallback){R.subscribeEvent.on(S.onSubscribeCallback);}}if(typeof S==F.CustomEvent){O[P].broadcast=false;}return O[P];},addTarget:function(L){this._yuievt.targets[F.stamp(L)]=L;this._yuievt.hasTargets=true;},removeTarget:function(L){delete this._yuievt.targets[F.stamp(L)];},fire:function(Q){var S=G.isString(Q),P=(S)?Q:(Q&&Q.type),R,L,O;P=M(this._yuievt.config.prefix,P);R=this.getEvent(P);if(!R){if(this._yuievt.hasTargets){R=this.publish(P);R.details=F.Array(arguments,(S)?1:0,true);return this.bubble(R);}O=true;}else{L=F.Array(arguments,(S)?1:0,true);O=R.fire.apply(R,L);R.target=null;}return(this._yuievt.chain)?this:O;},getEvent:function(L){L=M(this._yuievt.config.prefix,L);var O=this._yuievt.events;
return(O&&L in O)?O[L]:null;},bubble:function(O){var T=this._yuievt.targets,P=true,R,S,U,L,Q;if(!O.stopped&&T){for(Q in T){if(T.hasOwnProperty(Q)){R=T[Q];S=O.type;U=R.getEvent(S);L=O.target||this;if(!U){U=R.publish(S,O);U.context=(O.host===O.context)?R:O.context;U.host=R;U.defaultFn=null;U.preventedFn=null;U.stoppedFn=null;}U.target=L;U.currentTarget=R;P=P&&U.fire.apply(U,O.details);if(U.stopped){break;}}}}return P;},after:function(P,O){var L=F.Array(arguments,0,true);switch(G.type(P)){case"function":return F.Do.after.apply(F.Do,arguments);case"object":L[0]._after=true;break;default:L[0]=K+P;}return this.on.apply(this,L);},before:function(){return this.on.apply(this,arguments);}};F.EventTarget=N;F.mix(F,N.prototype,false,false,{bubbles:false});N.call(F);YUI.Env.globalEvents=YUI.Env.globalEvents||new N();F.Global=YUI.Env.globalEvents;})();},"@VERSION@",{requires:["oop"]});