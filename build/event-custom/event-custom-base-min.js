YUI.add("event-custom-base",function(c){var w="after",h="~AFTER~",B=":",x="|",p=0,d=1,b=["broadcast","monitored","bubbles","context","contextFn","currentTarget","defaultFn","defaultTargetOnly","details","emitFacade","fireOnce","async","host","preventable","preventedFn","queuable","silent","stoppedFn","target","type"],l=9,e="yui:log",v=c.Array,f=c.Lang,o=f.isString,n=f.isArray,m=f.isObject,a=f.isFunction,u=c.cached(function(D){var C=D.indexOf(":");return(C>-1)?"*"+D.slice(C):D;}),t=c.cached(function(C,D){if(!D||!o(C)||C.indexOf(B)>-1){return C;}return D+B+C;}),i={},r={},s,z,y;c.Env.evt={handles:r,plugins:i};function k(C,D){this.obj=C;this.methodName=D;this.method=C[D];this.before={};this.after={};}k.prototype={constructor:k,register:function(D,E,C){if(C){this.after[D]=E;}else{this.before[D]=E;}},_delete:function(C){delete this.before[C];delete this.after[C];},exec:function(){var F=v(arguments,0,true),G,E,J,H=this.before,D=this.after,I=false,C=c.Do;for(G in H){if(H.hasOwnProperty(G)){E=H[G].apply(this.obj,F);if(E){switch(E.constructor){case C.Halt:return E.retVal;case C.AlterArgs:F=E.newArgs;break;case C.Prevent:I=true;break;default:}}}}if(!I){E=this.method.apply(this.obj,F);}C.originalRetVal=E;C.currentRetVal=E;for(G in D){if(D.hasOwnProperty(G)){J=D[G].apply(this.obj,F);if(J&&J.constructor==C.Halt){return J.retVal;}else{if(J&&J.constructor==C.AlterReturn){E=J.newRetVal;C.currentRetVal=E;}}}}return E;}};c.Do={Method:k,AlterArgs:function(D,C){this.msg=D;this.newArgs=C;},AlterReturn:function(D,C){this.msg=D;this.newRetVal=C;},Halt:function(D,C){this.msg=D;this.retVal=C;},Prevent:function(C){this.msg=C;},objs:{},before:function(D,F,G,H){var E=D,C;if(H){C=[D,H].concat(v(arguments,4,true));E=c.rbind.apply(c,C);}return this._inject(p,E,F,G);},after:function(D,F,G,H){var E=D,C;if(H){C=[D,H].concat(v(arguments,4,true));E=c.rbind.apply(c,C);}return this._inject(d,E,F,G);},_inject:function(C,E,F,H){var I=c.stamp(F),G,D;if(!this.objs[I]){this.objs[I]={};}G=this.objs[I];if(!G[H]){G[H]=new c.Do.Method(F,H);F[H]=function(){return G[H].exec.apply(G[H],arguments);};}D=I+c.stamp(E)+H;G[H].register(D,E,C);return new c.EventHandle(G[H],D);},detach:function(C){if(C.detach){C.detach();}},_unload:function(D,C){}};c.Do.Error=c.Do.Halt;function g(C,D){this.evt=C;this.sub=D;}g.prototype={batch:function(C,D){C.call(D||this,this);if(f.isArray(this.evt)){c.Array.each(this.evt,function(E){E.batch.call(D||E,C);});}},detach:function(){var C=this.evt,E=0,D;if(C){if(f.isArray(C)){for(D=0;D<C.length;D++){E+=C[D].detach();}}else{C._delete(this.sub);E=1;}if(this.category&&C.host){C.host._unregisterSub(this.category,this);delete this.category;}}return E;},monitor:function(C){return this.evt.monitor.apply(this.evt,arguments);}};c.EventHandle=g;function q(D,E){var C=this;E=E||{};C.id=c.stamp(C);C.type=D;C.context=c;C.logSystem=(D==e);C.silent=C.logSystem;C.subscribers={};C.afters={};C.preventable=true;C.bubbles=true;C.signature=l;C.subCount=0;C.afterCount=0;C.applyConfig(E,true);}s={hasSubs:function(C){var F=this.subCount,D=this.afterCount,E=this.sibling;if(E){F+=E.subCount;D+=E.afterCount;}if(C){return(C=="after")?D:F;}return(F+D);},monitor:function(F){var C=this,E=C.id+"|"+C.type+"_"+F,D=v(arguments,0,true);C.monitored=true;D[0]=E;return C.host.on.apply(C.host,D);},getSubs:function(){var E=c.merge(this.subscribers),C=c.merge(this.afters),D=this.sibling;if(D){c.mix(E,D.subscribers);c.mix(C,D.afters);}return[E,C];},applyConfig:function(D,C){if(D){c.mix(this,D,C,b);}},_on:function(H,F,E,C){var D=this,G=new c.Subscriber(H,F,E,C);if(D.fireOnce&&D.fired){if(D.async){setTimeout(c.bind(D._notify,D,G,D.firedWith),0);}else{D._notify(G,D.firedWith);}}if(C==w){D.afters[G.id]=G;D.afterCount++;}else{D.subscribers[G.id]=G;D.subCount++;}return new c.EventHandle(D,G);},on:function(E,D){var C=(arguments.length>2)?v(arguments,2,true):null;if(this.host){this.host._monitor("attach",this.type,{args:arguments});}return this._on(E,D,C,true);},after:function(E,D){var C=(arguments.length>2)?v(arguments,2,true):null;return this._on(E,D,C,w);},detach:function(G,E){if(G&&G.detach){return G.detach();}var D,F,H=0,C=c.merge(this.subscribers,this.afters);for(D in C){if(C.hasOwnProperty(D)){F=C[D];if(F&&(!G||G===F.fn)){this._delete(F);H++;}}}return H;},_notify:function(G,F,C){var D=this,E;E=G.notify(F,D);if(false===E||D.stopped>1){return false;}return true;},fire:function(){var C=this,E=(C.emitFacade)?"fireComplex":"fireSimple",D=v(arguments,0,true);if(C.fireOnce){C.fired=true;C.firedWith=D;C.fire=C._fireImmediate;}return C[E](D);},_fireImmediate:function(){return true;},fireSimple:function(D){var C=this,E;C.stopped=0;C.prevented=0;if(C.hasSubs()){E=C.getSubs();C._procSubs(E[0],D);C._procSubs(E[1],D);}C.broadcast&&!C.stopped&&C._broadcast(D);return C.stopped?false:true;},fireComplex:function(C){C[0]=C[0]||{};return this.fireSimple(C);},_procSubs:function(F,D,C){var G,E;for(E in F){if(F.hasOwnProperty(E)){G=F[E];if(G&&G.fn){if(false===this._notify(G,D,C)){this.stopped=2;}if(this.stopped==2){return false;}}}}return true;},_broadcast:function(D){var C=D.slice();C.unshift(this.type);if(this.host!==c){c.fire.apply(c,C);}if(this.broadcast==2){c.Global.fire.apply(c.Global,C);}},detachAll:function(){return this.detach();},_delete:function(D){var C=this;if(D){if(C.subscribers[D.id]){delete C.subscribers[D.id];C.subCount--;}if(C.afters[D.id]){delete C.afters[D.id];C.afterCount--;}}if(C.host){C.host._monitor("detach",C.type,{ce:C,sub:D});}if(D){D.deleted=true;}}};s.unsubscribe=s.detach;s.unsubscribeAll=s.detachAll;q.prototype=s;c.CustomEvent=q;function A(F,E,D){var C=this;C.fn=F;C.context=E;C.id=c.stamp(C);C.args=D;}A.prototype={_notify:function(H,E,F){if(this.deleted&&!this.postponed){delete this.postponed;return null;}var C=this.args,G=this.fn,D;switch(F.signature){case 0:D=G.call(H,F.type,E,H);break;case 1:D=G.call(H,E[0]||null,H);break;default:if(C||E){E=E||[];C=(C)?E.concat(C):E;D=G.apply(H,C);}else{D=G.call(H);}}if(this.once){F._delete(this);}return D;},notify:function(D,F){var G=this.context,C=true;
if(!G){G=(F.contextFn)?F.contextFn():F.context;}if(c.config.throwFail){C=this._notify(G,D,F);}else{try{C=this._notify(G,D,F);}catch(E){c.error(this+" failed: "+E.message,E);}}return C;},contains:function(D,C){if(C){return((this.fn==D)&&this.context==C);}else{return(this.fn==D);}}};c.Subscriber=A;function j(C){var D=(m(C))?C:{};this._yuievt=this._yuievt||{id:c.guid(),events:{},targets:{},config:D,chain:("chain" in D)?D.chain:c.config.chain,bubbling:false,defaults:{context:D.context||this,host:this,emitFacade:D.emitFacade,fireOnce:D.fireOnce,queuable:D.queuable,monitored:D.monitored,broadcast:D.broadcast,defaultTargetOnly:D.defaultTargetOnly,bubbles:("bubbles" in D)?D.bubbles:true}};}j.prototype={once:function(){var C=this.on.apply(this,arguments);C.batch(function(D){if(D.sub){D.sub.once=true;}});return C;},onceAfter:function(){var C=this.after.apply(this,arguments);C.batch(function(D){if(D.sub){D.sub.once=true;}});return C;},parseType:c.cached(function(G,H){if(typeof G!=="string"){return G;}var F=G.indexOf(h),D=G.indexOf(x),E=0,I,C;if(F>-1){I=true;E=h.length;}if(D>-1){C=G.slice(E,D);E=D+1;}E&&(G=G.slice(E));if(G==="*"){G=null;}return[C,t(G,H),I,G];}),on:function(K,L,E){var G=this.parseType(K,this._yuievt.config.prefix),D,J,H,M,I,C,F;if(m(K)){if(a(K)){return c.Do.before.apply(c.Do,arguments);}H=n(K);J=v(arguments,0,true);M=[];C=(K._after&&(delete K._after))?h:"";c.Object.each(K,function(O,N){if(H){J[0]=C+O;}else{J[0]=C+N;J[1]=O.fn||(a(O)?O:L);J[2]=O.context||E;}M.push(this.on.apply(this,J));},this);return new c.EventHandle(M);}D=G[0];K=G[1];C=G[2];J=(arguments.length>3)?v(arguments,3,true):null;this._monitor("attach",K,{args:arguments,category:D,after:C});F=this._yuievt.events[K]||this.publish(K);I=F._on(L,E,J,(C)?"after":true);D&&this._registerSub(D,I);return I;},subscribe:function(){return this.on.apply(this,arguments);},detach:function(H,I,D){var K,F,C,J,G,E;if(!H){K=this._yuievt.events;for(G in K){if(K.hasOwnProperty(G)){K[G].detach(I,D);}}}else{if(m(H)){H.detach&&H.detach();}else{F=this.parseType(H,this._yuievt.config.prefix);C=F[0];if(C){J=this._getCategorySubs(C,F[3]);for(G=J.length-1;G>=0;--G){J[G].detach();}}else{E=this._yuievt.events[F[1]];E&&E.detach(I,D);}}}return this;},unsubscribe:function(){return this.detach.apply(this,arguments);},detachAll:function(C){return this.detach(C);},unsubscribeAll:function(){return this.detachAll.apply(this,arguments);},publish:function(F,G){var I=this._yuievt,H=I.config.prefix,E=I.events,D=I.defaults,C;F=(H)?t(F,H):F;if(!E[F]){if(m(F)){C={};c.each(F,function(K,J){C[J]=this.publish(J,K||G);},this);return C;}G&&(D=c.merge(D,G));E[F]=new c.CustomEvent(F,D);}else{if(G){E[F].applyConfig(G,true);}}return E[F];},_monitor:function(F,C,G){var D,E=this.getEvent(C);if((this._yuievt.config.monitored&&(!E||E.monitored))||(E&&E.monitored)){D=C+"_"+F;G.monitored=F;this.fire.call(this,D,G);}},fire:function(F){var J=(typeof F==="string"),E=(J)?F:(F&&F.type),I,D,H=this._yuievt.config.prefix,G,C=(J)?v(arguments,1,true):arguments;E=(H)?t(E,H):E;this._monitor("fire",E,{args:C});I=this.getEvent(E,true);G=this.getSibling(E,I);if(G&&!I){I=this.publish(E);}if(!I){if(this._yuievt.hasTargets){return this.bubble({type:E},C,this);}D=true;}else{I.sibling=G;D=I.fire.apply(I,C);}return(this._yuievt.chain)?this:D;},getSibling:function(C,E){var D;if(C.indexOf(B)>-1){C=u(C);D=this.getEvent(C,true);if(D){D.applyConfig(E);D.bubbles=false;D.broadcast=0;}}return D;},getEvent:function(D,C){var E;if(!C){E=this._yuievt.config.prefix;D=(E)?t(D,E):D;}return this._yuievt.events[D]||null;},after:function(E,D){var C=v(arguments,0,true);switch(f.type(E)){case"function":return c.Do.after.apply(c.Do,arguments);case"array":case"object":C[0]._after=true;break;default:C[0]=h+E;}return this.on.apply(this,C);},before:function(){return this.on.apply(this,arguments);},_registerSub:function(D,E){var C=this._yuievt;C=C.categories||(C.categories={});C=C[D]||(C[D]=[]);E.category=D;C.push(E);},_getCategorySubs:function(H,G){var D=this._yuievt.categories,F,E,C;D&&(D=D[H]);if(D&&G){F=D;D=[];for(E=0,C=F.length;E<C;++E){if(F[E].evt.type===G){D.push(F[E]);}}}return D;},_unregisterSub:function(F,G){var D=this._yuievt.categories,C=D&&D[F],E;if(C){for(E=C.length-1;E>=0;--E){if(C[E]===G){delete G.category;C.splice(E,1);}}}if(C&&!C.length){delete D[F];}}};c.EventTarget=j;if(!YUI.Env.globalEvents){YUI.Env.globalEvents=new j({bubbles:false});}c.Global=YUI.Env.globalEvents;s=j.prototype;z=s.on;y=s.detach;c.mix(c,s,true);j.call(c,{bubbles:false});c.on=function(K,L,E){var F=this.parseType(K),I=c.Node,C,H,J,D,G;C=F[3];H=i[C]||(I&&I.DOM_EVENTS[C]);if(!o(C)||!H){return z.apply(this,arguments);}this._monitor("attach",F[1],{args:arguments,category:F[0],after:F[2]});J=v(arguments,0,true);D=F[0];if(I&&m(E)){if(c.instanceOf(E,c.NodeList)){J[2]=c.NodeList.getDOMNodes(E);}else{if(c.instanceOf(E,I)){J[2]=I.getDOMNode(E);}}}G=(H.on)?H.on.apply(c,J):c.Event._attach(J);D&&this._registerSub(D,G);return G;};c.detach=function(G){if(!G){return this;}var I=this.parseType(G),E=c.Node,H=I[0],D=!H&&I[3],F=D&&(i[D]||(E&&E.DOM_EVENTS[D])),C;if(F){C=v(arguments,0,true);C[0]=D;if(F.detach){F.detach.apply(c,C);}else{c.Event.detach.apply(c.Event,C);}}else{y.apply(this,arguments);}return this;};},"@VERSION@",{requires:["oop"]});