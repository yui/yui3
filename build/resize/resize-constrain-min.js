YUI.add("resize-constrain",function(C){var J=C.Lang,P=J.isBoolean,T=J.isNumber,R=J.isString,a=function(Y){return(Y instanceof C.Node);},d="borderBottomWidth",G="borderLeftWidth",Z="borderRightWidth",K="borderTopWidth",N="bottom",M="con",e="constrain",f="host",S="left",I="maxHeight",V="maxWidth",A="minHeight",L="minWidth",g="node",B="offsetHeight",O="offsetWidth",E="preserveRatio",X="region",U="resizeConstrained",Q="right",F="tickX",D="tickY",W="top",c="view",b="viewportRegion";function H(){H.superclass.constructor.apply(this,arguments);}C.mix(H,{NAME:U,NS:M,ATTRS:{constrain:{setter:function(Y){if(Y&&(a(Y)||R(Y)||Y.nodeType)){Y=C.one(Y);}return Y;}},minHeight:{value:15,validator:T},minWidth:{value:15,validator:T},maxHeight:{value:Infinity,validator:T},maxWidth:{value:Infinity,validator:T},preserveRatio:{value:false,validator:P},tickX:{value:false},tickY:{value:false}}});C.extend(H,C.Plugin.Base,{constrainBorderInfo:null,initializer:function(){var Y=this,h=Y.get(f);Y.constrainBorderInfo={bottom:0,left:0,right:0,top:0};h.delegate.dd.plug(C.Plugin.DDConstrained,{tickX:Y.get(F),tickY:Y.get(D)});h.after("resize:align",C.bind(Y._handleResizeAlignEvent,Y));h.on("resize:start",C.bind(Y._handleResizeStartEvent,Y));},_checkConstrain:function(h,q,i){var n=this,m,j,k,p,o=n.get(f),Y=o.info,l=n._getConstrainRegion();if(l){m=Y[h]+Y[i];j=l[q]-n.constrainBorderInfo[q];if(m>=j){Y[i]-=(m-j);}k=Y[h];p=l[h]+n.constrainBorderInfo[h];if(k<=p){Y[h]+=(p-k);Y[i]-=(p-k);}}},_checkHeight:function(){var Y=this,i=Y.get(f),k=i.info,h=Y.get(I),j=Y.get(A);Y._checkConstrain(W,N,B);if(k.offsetHeight>h){i._checkSize(B,h);}if(k.offsetHeight<j){i._checkSize(B,j);}},_checkRatio:function(){var u=this,n=u.get(f),t=n.info,j=n.originalInfo,m=j.offsetWidth,v=j.offsetHeight,l=j.top,w=j.left,p=j.bottom,s=j.right,i=function(){return(t.offsetWidth/m);},k=function(){return(t.offsetHeight/v);},o=n.changeHeightHandles,Y,x,q,r,h,y;if(u.get(e)&&n.changeHeightHandles&&n.changeWidthHandles){q=u._getConstrainRegion();x=u.constrainBorderInfo;Y=(q.bottom-x.bottom)-p;r=w-(q.left+x.left);h=(q.right-x.right)-s;y=l-(q.top+x.top);if(n.changeLeftHandles&&n.changeTopHandles){o=(y<r);}else{if(n.changeLeftHandles){o=(Y<r);}else{if(n.changeTopHandles){o=(y<h);}else{o=(Y<h);}}}}if(o){t.offsetWidth=m*k();u._checkWidth();t.offsetHeight=v*i();}else{t.offsetHeight=v*i();u._checkHeight();t.offsetWidth=m*k();}if(n.changeTopHandles){t.top=l+(v-t.offsetHeight);}if(n.changeLeftHandles){t.left=w+(m-t.offsetWidth);}C.each(t,function(AA,z){if(T(AA)){t[z]=Math.round(AA);}});},_checkRegion:function(){var Y=this,h=Y.get(f),i=Y._getConstrainRegion();return C.DOM.inRegion(null,i,true,h.info);},_checkWidth:function(){var Y=this,j=Y.get(f),k=j.info,i=Y.get(V),h=Y.get(L);Y._checkConstrain(S,Q,O);if(k.offsetWidth<h){j._checkSize(O,h);}if(k.offsetWidth>i){j._checkSize(O,i);}},_getConstrainRegion:function(){var Y=this,i=Y.get(f),h=i.get(g),k=Y.get(e),j=null;if(k){if(k==c){j=h.get(b);}else{if(a(k)){j=k.get(X);}else{j=k;}}}return j;},_handleResizeAlignEvent:function(i){var Y=this,h=Y.get(f);Y._checkHeight();Y._checkWidth();if(Y.get(E)){Y._checkRatio();}if(Y.get(e)&&!Y._checkRegion()){h.info=h.lastInfo;}},_handleResizeStartEvent:function(h){var Y=this;Y._updateConstrainBorderInfo();},_updateConstrainBorderInfo:function(){var h=this,i=h.get(e),Y;if(a(i)){Y=function(j){return parseFloat(i.getStyle(j))||0;};h.constrainBorderInfo.bottom=Y(d);h.constrainBorderInfo.left=Y(G);h.constrainBorderInfo.right=Y(Z);h.constrainBorderInfo.top=Y(K);}}});C.namespace("Plugin");C.Plugin.ResizeConstrained=H;},"@VERSION@",{requires:["resize-base","plugin"],skinnable:false});