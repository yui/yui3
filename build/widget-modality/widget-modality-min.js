YUI.add("widget-modality",function(b){var h="widget",o="renderUI",k="bindUI",q="syncUI",m="boundingBox",n="contentBox",l="visible",f="zIndex",g="Change",c=b.Lang.isBoolean,e=b.ClassNameManager.getClassName,a=(function(){
/*! IS_POSITION_FIXED_SUPPORTED - Juriy Zaytsev (kangax) - http://yura.thinkweb2.com/cft/ */
var s=null,t,r;if(document.createElement){t=document.createElement("div");if(t&&t.style){t.style.position="fixed";t.style.top="10px";r=document.body;if(r&&r.appendChild&&r.removeChild){r.appendChild(t);s=(t.offsetTop===10);r.removeChild(t);}}}return s;}());function d(r){this._initModality();}var j="modal",p="mask",i={modal:e(h,j),mask:e(h,p)};d.ATTRS={maskNode:{getter:"_getMaskNode",readOnly:true},modal:{value:true,validator:c}};d.CLASSES=i;d._GET_MASK=function(){var r=b.one(".yui3-widget-mask")||null;if(r){return r;}else{r=b.Node.create("<div></div>");r.addClass(i.mask);r.setStyles({position:a?"fixed":"absolute",width:"100%",height:"100%",top:"0",left:"0",display:"block"});return r;}};d.STACK=[];d.prototype={_maskNode:d._GET_MASK(),_uiHandles:null,_initModality:function(){if(this.get("modal")){b.after(this._renderUIModal,this,o);b.after(this._syncUIModal,this,q);b.after(this._bindUIModal,this,k);}if(this.get("rendered")){this._renderUIModal;this._syncUIModal;this._bindUIModal;}},_renderUIModal:function(){var r=this.get(m);r.addClass(i.modal);},_bindUIModal:function(){this.after(l+g,this._afterHostVisibleChange);this.after(f+g,this._afterHostZIndexChange);},_syncUIModal:function(){this._uiSetHostVisible(this.get(l));this._uiSetHostZIndex(this.get(f));},_focus:function(s){var t=this.get(m),r=t.get("tabIndex");t.set("tabIndex",r>=0?r:0);this.focus();},_blur:function(){this.blur();},_getMaskNode:function(){return d._GET_MASK();},_uiSetHostVisible:function(v){var r=d.STACK,t,s=this.get("maskNode"),u=this.get("modal");if(v){b.Array.each(r,function(w){w._detachUIHandles();w._blur();});r.unshift(this);this._repositionMask(this);this._uiSetHostZIndex(this.get(f));d._GET_MASK().show();if(u){b.later(1,this,"_attachUIHandles");this._focus();}}else{r.splice(b.Array.indexOf(r,this),1);this._detachUIHandles();this._blur();if(r.length){t=r[0];this._repositionMask(t);t._uiSetHostZIndex(t.get(f));if(t.get("modal")){b.later(1,t,"_attachUIHandles");t._focus();}}else{if(s.getStyle("display")==="block"){s.hide();}}}},_uiSetHostZIndex:function(r){if(this.get("modal")){this.get("maskNode").setStyle(f,r||0);}},_attachUIHandles:function(){if(this._uiHandles){return;}var s=this.get(m),r=this.get("maskNode");this._uiHandles=[s.on("clickoutside",b.bind(this._focus,this)),s.on("focusoutside",b.bind(this._focus,this))];if(!a){this._uiHandles.push(b.one("win").on("scroll",b.bind(function(t){r.setStyle("top",r.get("docScrollY"));},this)));}},_detachUIHandles:function(){b.each(this._uiHandles,function(r){r.detach();});this._uiHandles=null;},_afterHostVisibleChange:function(r){this._uiSetHostVisible(r.newVal);},_afterHostZIndexChange:function(r){this._uiSetHostZIndex(r.newVal);},isNested:function(){var s=d.STACK.length,r=(s>1)?true:false;return r;},_repositionMask:function(r){var t=this.get("modal"),s=r.get("modal"),u=this.get("maskNode"),v;if(t&&!s){u.remove();}else{if((!t&&s)||(t&&s)){u.remove();v=r.get(m),bbParent=v.get("parentNode")||b.one("body");bbParent.insert(u,bbParent.get("firstChild"));}}}};b.WidgetModality=d;},"@VERSION@",{requires:["widget","event-outside","base-build"]});