YUI.add("widget-modality",function(b){var i="widget",p="host",o="renderUI",j="bindUI",q="syncUI",l="rendered",m="boundingBox",n="contentBox",k="visible",f="zIndex",g="align",h="Change",c=b.Lang.isBoolean,e=b.ClassNameManager.getClassName,a=(function(){
/*! IS_POSITION_FIXED_SUPPORTED - Juriy Zaytsev (kangax) - http://yura.thinkweb2.com/cft/ */
var s=null,t,r;if(document.createElement){t=document.createElement("div");if(t&&t.style){t.style.position="fixed";t.style.top="10px";r=document.body;if(r&&r.appendChild&&r.removeChild){r.appendChild(t);s=(t.offsetTop===10);r.removeChild(t);}}}return s;}()),d;(function(){var u="widgetModal",t="modal",s="mask",r={modal:e(i,t),mask:e(i,s)};d=b.Base.create(u,b.Plugin.Base,[],{_maskNode:null,_uiHandles:null,initializer:function(w){var v=this;this.afterHostMethod(o,this.renderUI);this.afterHostMethod(j,this.bindUI);this.afterHostMethod(q,this.syncUI);if(this.get(p).get(l)){this.renderUI();this.bindUI();this.syncUI();}this._maskNode=d._GET_MASK();},destructor:function(){if(this._maskNode){this._maskNode.remove(true);}this._detachUIHandles();this.get(p).get(m).removeClass(r.modal);},renderUI:function(){var w=this.get(p).get(m),v=this.get(p).get(n);v.setStyles({position:"relative"});this._repositionMask(this.get(p));w.addClass(r.modal);},bindUI:function(){this.afterHostEvent(k+h,this._afterHostVisibleChange);this.afterHostEvent(f+h,this._afterHostZIndexChange);},syncUI:function(){var v=this.get(p);this._uiSetHostVisible(v.get(k));this._uiSetHostZIndex(v.get(f));},_focus:function(x){var w=this.get(p),y=w.get(m),v=y.get("tabIndex");y.set("tabIndex",v>=0?v:0);w.focus();},_blur:function(){this.get(p).blur();},_getMaskNode:function(){return d._GET_MASK();},_uiSetHostVisible:function(y){var v=d.STACK,w=this.get("host"),x,z;if(y){b.Array.each(v,function(A){A._detachUIHandles();A._blur();});v.unshift(this);this._attachUIHandles();this._repositionMask(w);this._uiSetHostZIndex(w.get(f));this._maskNode.show();this._focus();}else{v.splice(b.Array.indexOf(v,this),1);this._detachUIHandles();this._blur();if(v.length){x=v[0];z=x.get("host");x._repositionMask(z);x._attachUIHandles();x._uiSetHostZIndex(z.get(f));x._focus();}else{this._maskNode.hide();}}},_uiSetHostZIndex:function(v){this._maskNode.setStyle(f,v||0);},_attachUIHandles:function(w){if(this._uiHandles){return;}var v=this.get(p),x=v.get(m);this._uiHandles=[x.on("clickoutside",b.bind(this._focus,this)),x.on("focusoutside",b.bind(this._focus,this))];if(!a){this._uiHandles.push(b.one("win").on("scroll",b.bind(function(z){var y=this._maskNode;y.setStyle("top",y.get("docScrollY"));},this)));}},_detachUIHandles:function(){console.log(this);b.each(this._uiHandles,function(v){v.detach();});this._uiHandles=null;},_afterHostVisibleChange:function(v){this._uiSetHostVisible(v.newVal);},_afterHostZIndexChange:function(v){this._uiSetHostZIndex(v.newVal);},_isNested:function(){var v=d._GET_MASK();return v.get(k);},_repositionMask:function(w){this._maskNode.remove();var x=w.get(m),v=x.get("parentNode")||b.one("body");v.insert(this._maskNode,v.get("firstChild"));}},{NS:t,ATTRS:{maskNode:{getter:"_getMaskNode",readOnly:true},node:{value:undefined}},CLASSES:r,_GET_MASK:function(){var v=b.one(".yui3-widget-mask")||null;if(v){return v;}else{v=b.Node.create("<div></div>");v.addClass(r.mask);v.setStyles({position:a?"fixed":"absolute",width:"100%",height:"100%",top:"0",left:"0",display:"block"});return v;}},STACK:[]});b.namespace("Plugin").Modal=d;}());},"@VERSION@",{requires:["widget","plugin","event-outside","base-build"]});