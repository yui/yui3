YUI.add("autocomplete-base",function(G){var I=G.Lang,N=G.Array,D=I.isFunction,Q=I.isNumber,C="allowBrowserAutocomplete",O="dataSource",H="inputNode",V="minQueryLength",U="query",R="queryDelay",B="requestTemplate",J="resultFilters",F="resultFormatter",E="resultHighlighter",W="resultLocator",L="results",K="value",P="valueChange",A="clear",S=U,M=L;function T(){this.publish(A,{defaultFn:this._defClearFn,queueable:true});this.publish(S,{defaultFn:this._defQueryFn,queueable:true});this.publish(M,{defaultFn:this._defResultsFn,queueable:true});}T.ATTRS={allowBrowserAutocomplete:{value:false,writeOnce:"initOnly"},dataSource:{validator:function(X){return(X&&D(X.sendRequest))||X===null;}},inputNode:{setter:G.one,writeOnce:"initOnly"},minQueryLength:{validator:Q,value:1},query:{readOnly:true,value:null},queryDelay:{validator:function(X){return Q(X)&&X>=0;},value:150},requestTemplate:{setter:function(X){if(D(X)){return X;}X=X.toString();return function(Y){return X.replace(/(^|[^\\])((\\{2})*)\{query\}/,"$1$2"+encodeURIComponent(Y)).replace(/(^|[^\\])((\\{2})*)\\(\{query\})/,"$1$2$4");};},value:encodeURIComponent},resultFilters:{validator:I.isArray,value:[]},resultFormatter:{validator:"_functionValidator"},resultHighlighter:{validator:"_functionValidator"},resultLocator:{setter:function(X){if(X===null||D(X)){return X;}X=X.toString().split(".");return function(Y){return G.Object.getValue(Y,X);};}},results:{readOnly:true,value:[]},value:{value:""}};T.CSS_PREFIX="ac";T.UI_SRC=(G.Widget&&G.Widget.UI_SRC)||"ui";T.prototype={bindInput:function(){var X=this.get(H);if(!X){G.error("No inputNode specified.");}this.unbindInput();this._inputEvents=[X.on(P,this._onInputValueChange,this),this.after(P,this._afterValueChange,this)];},syncInput:function(){var X=this.get(H);if(X.get("nodeName").toLowerCase()==="input"){X.setAttribute("autocomplete",this.get(C)?"on":"off");}this.set(K,X.get(K));},unbindInput:function(){while(this._inputEvents&&this._inputEvents.length){this._inputEvents.pop().detach();}},_functionValidator:function(X){return D(X)||X===null;},_parseResponse:function(h,Y,c){var m={data:c,query:h,results:[]},d,l,n,Z=Y&&Y.results,b=[],X,k,j,a,g,e,f;if(Z){X=this.get(J);k=this.get(F);j=this.get(E);e=this.get(W);if(e){l=N.map(Z,e);f=N.hash(l,Z);}else{l=Z;}for(a=0,g=X.length;a<g;++a){l=X[a](h,l);if(!l||!l.length){break;}}if(e){n=l;l=[];for(a=0,g=n.length;a<g;++a){l.push(f[n[a]]);}}else{n=[].concat(l);}d=j?j(h,n):[].concat(n);if(k){d=k(h,l,d,n);}for(a=0,g=d.length;a<g;++a){b.push({display:d[a],raw:l[a],text:n[a]});}m.results=b;}this.fire(M,m);},_parseValue:function(X){return X;},_afterValueChange:function(c){var Y,Z,X=c.newVal,b,a;if(c.src!==T.UI_SRC){this._inputNode.set(K,X);return;}b=this._parseValue(X);if(b.length>=this.get(V)){Y=this.get(R);a=this;Z=function(){a.fire(S,{inputValue:X,query:b});};if(Y){clearTimeout(this._delay);this._delay=setTimeout(Z,Y);}else{Z();}}else{clearTimeout(this._delay);}if(!X.length){this.fire(A,{prevVal:c.prevVal});}},_onResponse:function(Y){var X=Y&&Y.callback&&Y.callback.query;if(X&&X===this.get(U)){this._parseResponse(X,Y.response,Y.data);}},_onInputValueChange:function(Y){var X=Y.newVal;if(X===this.get(K)){return;}this.set(K,X,{src:T.UI_SRC});},_defClearFn:function(){this._set(L,[]);},_defQueryFn:function(Y){var Z=this.get(O),X=Y.query;this._set(U,X);if(X&&Z){Z.sendRequest({request:this.get(B)(X),callback:{query:X,success:G.bind(this._onResponse,this)}});}},_defResultsFn:function(X){this._set(L,X[L]);}};G.AutoCompleteBase=T;},"@VERSION@",{requires:["array-extras","event-valuechange","node-base"]});YUI.add("autocomplete-list",function(B){var W=B.Node,K=B.Array,H=40,J=13,M=27,Q=9,P=38,T="_CLASS_ITEM",U="_CLASS_ITEM_ACTIVE",C="_CLASS_ITEM_HOVER",V="_SELECTOR_ITEM",F="activeItem",O="circular",S="hoveredItem",L="id",D="inputNode",E="item",X="result",I="results",R="visible",G="width",N="select",A=B.Base.create("autocompleteList",B.Widget,[B.AutoCompleteBase,B.WidgetPosition,B.WidgetPositionAlign,B.WidgetStack],{CONTENT_TEMPLATE:"<ul/>",ITEM_TEMPLATE:"<li/>",initializer:function(){this.publish(N,{defaultFn:this._defSelectFn});this._events=[];this._inputNode=this.get(D);this[T]=this.getClassName(E);this[U]=this.getClassName(E,"active");this[C]=this.getClassName(E,"hover");this[V]="."+this[T];if(!this._inputNode){B.error("No inputNode specified.");}if(!this.get("align.node")){this.set("align.node",this._inputNode);}if(!this.get(G)){this.set(G,this._inputNode.get("offsetWidth"));}},destructor:function(){this.unbindInput();while(this._events.length){this._events.pop().detach();}},bindUI:function(){this._bindInput();this._bindList();},renderUI:function(){this._contentBox=this.get("contentBox").set("role","listbox");this._inputNode.addClass(this.getClassName("input")).setAttrs({"aria-autocomplete":"list","aria-live":"polite","aria-owns":this._contentBox.get(L),role:"combobox"});},syncUI:function(){this.syncInput();this._syncResults();this._syncVisibility();},hide:function(){return this.set(R,false);},selectItem:function(Y){if(Y){if(!Y.hasClass(this[T])){return;}}else{Y=this.get(F);if(!Y){return;}}this.fire(N,{itemNode:Y,result:Y.getData(X)});return this;},show:function(){return this.set(R,true);},_activateNextItem:function(){var Z=this.get(F),Y;Y=(Z&&Z.next(this[V]))||this.get(O)&&this._getFirstItemNode();if(Y){this._set(F,Y);}return this;},_activatePrevItem:function(){var Z=this.get(F),Y;Y=(Z&&Z.previous(this[V]))||this.get(O)&&this._getLastItemNode();if(Y){this._set(F,Y);}return this;},_add:function(Y){var Z=[];K.each(B.Lang.isArray(Y)?Y:[Y],function(a){Z.push(this._createItemNode(a).setData(X,a));},this);Z=B.all(Z);this._contentBox.append(Z.toFrag());return Z;},_bindInput:function(){var Y=this._inputNode;this.bindInput();this._events.concat([Y.on("blur",this._onInputBlur,this),Y.on(B.UA.gecko?"keypress":"keydown",this._onInputKey,this)]);},_bindList:function(){this._events.concat([this.after("mouseover",this._afterMouseOver,this),this.after("mouseout",this._afterMouseOut,this),this.after("activeItemChange",this._afterActiveItemChange,this),this.after("hoveredItemChange",this._afterHoveredItemChange,this),this.after("resultsChange",this._afterResultsChange,this),this.after("visibleChange",this._afterVisibleChange,this),this._contentBox.delegate("click",this._onItemClick,this[V],this)]);
},_clear:function(){this._set(F,null);this._set(S,null);this._contentBox.get("children").remove(true);},_createItemNode:function(Y){var Z=W.create(this.ITEM_TEMPLATE);return Z.append(Y.display).setAttrs({id:B.stamp(Z),role:"option"}).addClass(this[T]);},_getLastItemNode:function(){return this._contentBox.one(this[V]+":last-child");},_getFirstItemNode:function(){return this._contentBox.one(this[V]);},_syncResults:function(Z){var Y;if(!Z){Z=this.get(I);}this._clear();if(Z.length){Y=this._add(Z);}},_syncVisibility:function(Y){if(Y===undefined){Y=this.get(R);}this._contentBox.set("aria-hidden",!Y);if(!Y){this._set(F,null);this._set(S,null);}},_afterActiveItemChange:function(Z){var Y=Z.newVal,a=Z.prevVal;if(a){a.removeClass(this[U]);}if(Y){Y.addClass(this[U]);this._inputNode.set("aria-activedescendant",Y.get(L));}},_afterHoveredItemChange:function(Z){var Y=Z.newVal,a=Z.prevVal;if(a){a.removeClass(this[C]);}if(Y){Y.addClass(this[C]);}},_afterMouseOver:function(Y){var Z=Y.domEvent.target.ancestor(this[V],true);this._mouseOverList=true;if(Z){this._set(S,Z);}},_afterMouseOut:function(){this._mouseOverList=false;this._set(S,null);},_afterResultsChange:function(Y){this._syncResults(Y.newVal);this.set(R,!!Y.newVal.length);},_afterVisibleChange:function(Y){this._syncVisibility(!!Y.newVal);},_onInputBlur:function(Y){if(this._mouseOverList&&this._lastInputKey!==Q){this._inputNode.focus();}else{this.hide();}},_onInputKey:function(a){var Y,Z=a.keyCode,b;this._lastInputKey=Z;if(!this.get(I).length){return;}b=this.get(R);if(Z===H){Y=1;if(!b){this.show();}this._activateNextItem();}if(b){switch(Z){case J:Y=1;this.selectItem();break;case M:Y=1;this.hide();break;case P:Y=1;this._activatePrevItem();break;}}if(Y){a.preventDefault();}},_onItemClick:function(Y){Y.preventDefault();this.selectItem(Y.currentTarget);},_defSelectFn:function(Y){this.set("value",Y.result.text);this._inputNode.focus();this.hide();}},{ATTRS:{activeItem:{readOnly:true,value:null},align:{value:{points:["tl","bl"]}},circular:{value:true},hoveredItem:{readOnly:true,value:null},visible:{value:false}},CSS_PREFIX:B.ClassNameManager.getClassName("aclist")});B.AutoCompleteList=A;B.AutoComplete=A;},"@VERSION@",{requires:["autocomplete-base","widget","widget-position","widget-position-align","widget-stack"],skinnable:true});YUI.add("autocomplete",function(A){},"@VERSION@",{use:["autocomplete-base","autocomplete-list"]});