YUI.add("autocomplete-base",function(F){var G=F.Escape,J=F.Lang,Q=F.Array,I=F.Object,S=J.isArray,D=J.isFunction,R=J.isObject,T=J.isString,W=J.trim,M=F.Attribute.INVALID_VALUE,O="_functionValidator",a="_sourceSuccess",C="allowBrowserAutocomplete",H="inputNode",Z="query",E="queryDelimiter",B="requestTemplate",L="results",N="resultListLocator",K="value",U="valueChange",A="clear",V=Z,P=L;function X(){F.before(this._bindUIACBase,this,"bindUI");F.before(this._destructorACBase,this,"destructor");F.before(this._syncUIACBase,this,"syncUI");this.publish(A,{defaultFn:this._defClearFn,queueable:true});this.publish(V,{defaultFn:this._defQueryFn,queueable:true});this.publish(P,{defaultFn:this._defResultsFn,queueable:true});}X.ATTRS={allowBrowserAutocomplete:{value:false},inputNode:{setter:F.one,writeOnce:"initOnly"},maxResults:{value:0},minQueryLength:{value:1},query:{readOnly:true,value:null},queryDelay:{value:100},queryDelimiter:{value:null},requestTemplate:{setter:"_setRequestTemplate",value:null},resultFilters:{setter:"_setResultFilters",value:[]},resultFormatter:{validator:O},resultHighlighter:{setter:"_setResultHighlighter"},resultListLocator:{setter:"_setLocator"},results:{readOnly:true,value:[]},resultTextLocator:{setter:"_setLocator"},source:{setter:"_setSource"},tokenInput:{readOnly:true},value:{value:""},yqlProtocol:{value:"http"}};X.CSS_PREFIX="ac";X.UI_SRC=(F.Widget&&F.Widget.UI_SRC)||"ui";X.prototype={sendRequest:function(c,d){var Y,b=this.get("source");if(b){if(c||c===""){this._set(Z,c);}else{c=this.get(Z);}if(!d){d=this.get(B);}Y=d?d(c):c;b.sendRequest({request:Y,callback:{success:F.bind(this._onResponse,this,c)}});}return this;},_bindUIACBase:function(){var b=this.get(H),Y=b&&b.tokenInput;if(Y){b=Y.get(H);this._set("tokenInput",Y);}if(!b){F.error("No inputNode specified.");return;}this._inputNode=b;this._acBaseEvents=[b.on(U,this._onInputValueChange,this),this.after(C+"Change",this._syncBrowserAutocomplete),this.after(U,this._afterValueChange)];},_destructorACBase:function(){var Y=this._acBaseEvents;while(Y&&Y.length){Y.pop().detach();}},_syncUIACBase:function(){this._syncBrowserAutocomplete();this.set(K,this.get(H).get(K),{src:X.UI_SRC});},_createArraySource:function(b){var Y=this;return{sendRequest:function(c){Y[a](b.concat(),c);}};},_createJSONPSource:function(e){var b={},c={},d=this,Y,f;c.sendRequest=function(h){var g=function(i){var j=i.request;if(b[j]){d[a](b[j],i);}else{e._config.on.success=function(k){b[j]=k;d[a](k,i);};e.send(j);}};Y=h;if(!f){f=true;F.use("jsonp",function(){if(!(e instanceof F.JSONPRequest)){e=new F.JSONPRequest(e,{format:F.bind(d._jsonpFormatter,d)});}c.sendRequest=g;g(Y);});}};return c;},_createObjectSource:function(Y){return{sendRequest:function(c){var d=c.request,b=this;b[a](I.owns(Y,d)?Y[d]:[],c);}};},_createStringSource:function(Y){if(/^(?:select|use|set)\s+/i.test(Y)){return this._createYQLSource(Y);}else{return this._createJSONPSource(Y);}},_createYQLSource:function(d){var b={},e={},c=this,Y,f;if(!this.get(N)){this.set(N,this._defaultYQLLocator);}e.sendRequest=function(i){var h,g=function(m){var n=m.request,o,j,l,k;if(b[n]){c[a](b[n],m);}else{o=function(p){b[n]=p;c[a](p,m);};j=c.get("maxResults");l={proto:c.get("yqlProtocol")};k=J.sub(d,{maxResults:j>0?j:1000,query:n});if(h){h._callback=o;h._opts=l;h._params.q=k;}else{h=new F.YQLRequest(k,o,null,l);}h.send();}};Y=i;if(!f){f=true;F.use("yql",function(){e.sendRequest=g;g(Y);});}};return e;},_defaultYQLLocator:function(b){var c=b&&b.query&&b.query.results,Y;if(c&&R(c)){Y=I.values(c)||[];c=Y.length===1?Y[0]:Y;if(!S(c)){c=[c];}}else{c=[];}return c;},_functionValidator:function(Y){return Y===null||D(Y);},_getObjectValue:function(d,c){if(!d){return;}for(var b=0,Y=c.length;d&&b<Y;b++){d=d[c[b]];}return d;},_jsonpFormatter:function(b,c,d){var Y=this.get("maxResults"),e=this.get(B);if(e){b=b+e(d);}return J.sub(b,{callback:c,maxResults:Y>0?Y:1000,query:e?d:encodeURIComponent(d)});},_parseResponse:function(c,Y,s){var j={data:s,query:c,results:[]},l=this.get(N),k=[],h=Y&&Y.results,e,b,m,d,r,n,o,p,f,g,q;if(h&&l){h=l(h);}if(h&&h.length){e=this.get("resultFilters");q=this.get("resultTextLocator");for(n=0,o=h.length;n<o;++n){f=h[n];g=q?q(f):f.toString();k.push({display:G.html(g),raw:f,text:g});}for(n=0,o=e.length;n<o;++n){k=e[n](c,k.concat());if(!k||!k.length){break;}}if(k.length){m=this.get("resultFormatter");r=this.get("resultHighlighter");p=this.get("maxResults");if(p&&p>0&&k.length>p){k.length=p;}if(r){d=r(c,k.concat());for(n=0,o=d.length;n<o;++n){f=k[n];f.highlighted=d[n];f.display=f.highlighted;}}if(m){b=m(c,k.concat());for(n=0,o=b.length;n<o;++n){k[n].display=b[n];}}}}j.results=k;this.fire(P,j);},_parseValue:function(Y){var b=this.get(E);if(b){Y=Y.split(b);Y=Y[Y.length-1];}return J.trimLeft(Y);},_setLocator:function(Y){if(this[O](Y)){return Y;}var b=this;Y=Y.toString().split(".");return function(c){return c&&b._getObjectValue(c,Y);};},_setRequestTemplate:function(Y){if(this[O](Y)){return Y;}Y=Y.toString();return function(b){return J.sub(Y,{query:encodeURIComponent(b)});};},_setResultFilters:function(c){var Y,b;if(c===null){return[];}Y=F.AutoCompleteFilters;b=function(d){if(D(d)){return d;}if(T(d)&&Y&&D(Y[d])){return Y[d];}return false;};if(S(c)){c=Q.map(c,b);return Q.every(c,function(d){return !!d;})?c:M;}else{c=b(c);return c?[c]:M;}},_setResultHighlighter:function(Y){var b;if(this._functionValidator(Y)){return Y;}b=F.AutoCompleteHighlighters;if(T(Y)&&b&&D(b[Y])){return b[Y];}return M;},_setSource:function(Y){if((Y&&D(Y.sendRequest))||Y===null){return Y;}else{if(T(Y)){return this._createStringSource(Y);}else{if(S(Y)){return this._createArraySource(Y);}else{if(R(Y)){return this._createObjectSource(Y);}else{if(F.JSONPRequest&&Y instanceof F.JSONPRequest){return this._createJSONPSource(Y);}}}}}return M;},_sourceSuccess:function(b,Y){Y.callback.success({data:b,response:{results:b}});},_syncBrowserAutocomplete:function(){var Y=this.get(H);if(Y.get("nodeName").toLowerCase()==="input"){Y.setAttribute("autocomplete",this.get(C)?"on":"off");
}},_updateValue:function(b){var d=this.get(E),c,Y,e;b=J.trimLeft(b);if(d){c=W(d);e=Q.map(W(this.get(K)).split(d),W);Y=e.length;if(Y>1){e[Y-1]=b;b=e.join(c+" ");}b=b+c+" ";}this.set(K,b);},_afterValueChange:function(g){var b,c,Y=g.newVal,f,d;if(g.src!==X.UI_SRC){this._inputNode.set(K,Y);return;}f=this._parseValue(Y)||"";if(f.length>=this.get("minQueryLength")){b=this.get("queryDelay");d=this;c=function(){d.fire(V,{inputValue:Y,query:f});};if(b){clearTimeout(this._delay);this._delay=setTimeout(c,b);}else{c();}}else{clearTimeout(this._delay);this.fire(A);}},_onInputValueChange:function(b){var Y=b.newVal;if(Y===this.get(K)){return;}this.set(K,Y,{src:X.UI_SRC});},_onResponse:function(Y,b){if(Y===this.get(Z)){this._parseResponse(Y,b.response,b.data);}},_defClearFn:function(){this._set(Z,null);this._set(L,[]);},_defQueryFn:function(b){var Y=b.query;this.sendRequest(Y);},_defResultsFn:function(Y){this._set(L,Y[L]);}};F.AutoCompleteBase=X;},"@VERSION@",{optional:["jsonp","yql"],requires:["array-extras","base-build","escape","event-valuechange","node-base"]});YUI.add("autocomplete-list",function(B){var H=B.Lang,U=B.Node,K=B.Array,O=9,R="_CLASS_ITEM",S="_CLASS_ITEM_ACTIVE",D="_CLASS_ITEM_HOVER",T="_SELECTOR_ITEM",F="activeItem",J="alwaysShowList",N="circular",Q="hoveredItem",L="id",E="item",C="list",V="result",I="results",P="visible",G="width",M="select",A=B.Base.create("autocompleteList",B.Widget,[B.AutoCompleteBase,B.WidgetPosition,B.WidgetPositionAlign,B.WidgetStack],{ARIA_TEMPLATE:"<div/>",ITEM_TEMPLATE:"<li/>",LIST_TEMPLATE:"<ul/>",initializer:function(){var W=this.get("inputNode");if(!W){B.error("No inputNode specified.");return;}this._inputNode=W;this._listEvents=[];this.DEF_PARENT_NODE=W.get("parentNode");this[R]=this.getClassName(E);this[S]=this.getClassName(E,"active");this[D]=this.getClassName(E,"hover");this[T]="."+this[R];this.publish(M,{defaultFn:this._defSelectFn});},destructor:function(){while(this._listEvents.length){this._listEvents.pop().detach();}},bindUI:function(){this._bindInput();this._bindList();},renderUI:function(){var a=this._createAriaNode(),X=this.get("contentBox"),Z=this._inputNode,Y=this.get("listNode"),W=Z.get("parentNode");if(!Y){Y=this._createListNode();X.append(Y);}Z.addClass(this.getClassName("input")).setAttrs({"aria-autocomplete":C,"aria-expanded":false,"aria-owns":Y.get("id"),role:"combobox"});W.append(a);this._ariaNode=a;this._boundingBox=this.get("boundingBox");this._contentBox=X;this._listNode=Y;this._parentNode=W;},syncUI:function(){this._syncResults();this._syncVisibility();},hide:function(){return this.get(J)?this:this.set(P,false);},selectItem:function(W){if(W){if(!W.hasClass(this[R])){return this;}}else{W=this.get(F);if(!W){return this;}}this.fire(M,{itemNode:W,result:W.getData(V)});return this;},_activateNextItem:function(){var X=this.get(F),W;if(X){W=X.next(this[T])||(this.get(N)?null:X);}else{W=this._getFirstItemNode();}this.set(F,W);return this;},_activatePrevItem:function(){var X=this.get(F),W=X?X.previous(this[T]):this.get(N)&&this._getLastItemNode();this.set(F,W||null);return this;},_add:function(W){var X=[];K.each(H.isArray(W)?W:[W],function(Y){X.push(this._createItemNode(Y).setData(V,Y));},this);X=B.all(X);this._listNode.append(X.toFrag());return X;},_ariaSay:function(Y,W){var X=this.get("strings."+Y);this._ariaNode.setContent(W?H.sub(X,W):X);},_bindInput:function(){var Y=this._inputNode,W=this.get("tokenInput"),X=(W&&W.get("boundingBox"))||Y;if(!this.get("align.node")){this.set("align.node",X);}if(!this.get(G)){this.set(G,X.get("offsetWidth"));}this._listEvents.push(Y.on("blur",this._onInputBlur,this));},_bindList:function(){this._listEvents.concat([this.after("mouseover",this._afterMouseOver),this.after("mouseout",this._afterMouseOut),this.after("activeItemChange",this._afterActiveItemChange),this.after("alwaysShowListChange",this._afterAlwaysShowListChange),this.after("hoveredItemChange",this._afterHoveredItemChange),this.after("resultsChange",this._afterResultsChange),this.after("visibleChange",this._afterVisibleChange),this._listNode.delegate("click",this._onItemClick,this[T],this)]);},_clear:function(){this.set(F,null);this._set(Q,null);this._listNode.get("children").remove(true);},_createAriaNode:function(){var W=U.create(this.ARIA_TEMPLATE);return W.addClass(this.getClassName("aria")).setAttrs({"aria-live":"polite",role:"status"});},_createItemNode:function(W){var X=U.create(this.ITEM_TEMPLATE);return X.addClass(this[R]).setAttrs({id:B.stamp(X),role:"option"}).setAttribute("data-text",W.text).append(W.display);},_createListNode:function(){var W=U.create(this.LIST_TEMPLATE);return W.addClass(this.getClassName(C)).setAttrs({id:B.stamp(W),role:"listbox"});},_getFirstItemNode:function(){return this._listNode.one(this[T]);},_getLastItemNode:function(){return this._listNode.one(this[T]+":last-child");},_syncResults:function(X){var W;if(!X){X=this.get(I);}this._clear();if(X.length){W=this._add(X);this._ariaSay("items_available");}if(this.get("activateFirstItem")&&!this.get(F)){this.set(F,this._getFirstItemNode());}},_syncVisibility:function(W){if(this.get(J)){W=true;this.set(P,W);}if(typeof W==="undefined"){W=this.get(P);}this._inputNode.set("aria-expanded",W);this._boundingBox.set("aria-hidden",!W);if(W){this._syncUIPosAlign();}else{this.set(F,null);this._set(Q,null);}},_afterActiveItemChange:function(Y){var X=this._inputNode,W=Y.newVal,Z=Y.prevVal;if(Z){Z.removeClass(this[S]);}if(W){W.addClass(this[S]).scrollIntoView();X.set("aria-activedescendant",W.get(L));}else{X.scrollIntoView();}},_afterAlwaysShowListChange:function(W){this.set(P,W.newVal||this.get(I).length>0);},_afterHoveredItemChange:function(X){var W=X.newVal,Y=X.prevVal;if(Y){Y.removeClass(this[D]);}if(W){W.addClass(this[D]);}},_afterMouseOver:function(W){var X=W.domEvent.target.ancestor(this[T],true);this._mouseOverList=true;if(X){this._set(Q,X);}},_afterMouseOut:function(){this._mouseOverList=false;this._set(Q,null);},_afterResultsChange:function(W){this._syncResults(W.newVal);if(!this.get(J)){this.set(P,!!W.newVal.length);
}},_afterVisibleChange:function(W){this._syncVisibility(!!W.newVal);},_onInputBlur:function(W){if(!this._mouseOverList||this._lastInputKey===O){this.hide();}},_onItemClick:function(W){var X=W.currentTarget;W.preventDefault();this.set(F,X);this.selectItem(X);},_defSelectFn:function(W){var X=W.result.text;this._inputNode.focus();this._updateValue(X);this._ariaSay("item_selected",{item:X});this.hide();}},{ATTRS:{activateFirstItem:{value:false},activeItem:{setter:B.one,value:null},align:{value:{points:["tl","bl"]}},alwaysShowList:{value:false},circular:{value:true},hoveredItem:{readOnly:true,value:null},strings:{valueFn:function(){return B.Intl.get("autocomplete-list");}},tabSelect:{value:true},visible:{value:false}},CSS_PREFIX:B.ClassNameManager.getClassName("aclist"),HTML_PARSER:{listNode:function(){return this.getClassName(C);}}});B.AutoCompleteList=A;B.AutoComplete=A;},"@VERSION@",{skinnable:true,requires:["autocomplete-base","widget","widget-position","widget-position-align","widget-stack"],lang:["en"]});YUI.add("autocomplete-plugin",function(B){var A=B.Plugin;function C(D){D.inputNode=D.host;if(!D.render&&D.render!==false){D.render=true;}C.superclass.constructor.apply(this,arguments);}B.extend(C,B.AutoCompleteList,{},{NAME:"autocompleteListPlugin",NS:"ac",CSS_PREFIX:B.ClassNameManager.getClassName("aclist")});A.AutoComplete=C;A.AutoCompleteList=C;},"@VERSION@",{requires:["autocomplete-list","node-pluginhost"]});YUI.add("autocomplete",function(A){},"@VERSION@",{use:["autocomplete-base","autocomplete-list","autocomplete-plugin"]});