YUI.add("dd-drag",function(d,j){var e=d.DD.DDM,s="node",g="dragging",n="dragNode",c="offsetHeight",l="offsetWidth",h="drag:mouseDown",b="drag:afterMouseDown",f="drag:removeHandle",m="drag:addHandle",q="drag:removeInvalid",r="drag:addInvalid",k="drag:start",i="drag:end",o="drag:drag",p="drag:align",a=function(u){this._lazyAddAttrs=false;a.superclass.constructor.apply(this,arguments);var t=e._regDrag(this);if(!t){d.error("Failed to register node, already in use: "+u.node);}};a.NAME="drag";a.START_EVENT="mousedown";a.ATTRS={node:{setter:function(t){if(this._canDrag(t)){return t;}var u=d.one(t);if(!u){d.error("DD.Drag: Invalid Node Given: "+t);}return u;}},dragNode:{setter:function(t){if(this._canDrag(t)){return t;}var u=d.one(t);if(!u){d.error("DD.Drag: Invalid dragNode Given: "+t);}return u;}},offsetNode:{value:true},startCentered:{value:false},clickPixelThresh:{value:e.get("clickPixelThresh")},clickTimeThresh:{value:e.get("clickTimeThresh")},lock:{value:false,setter:function(t){if(t){this.get(s).addClass(e.CSS_PREFIX+"-locked");}else{this.get(s).removeClass(e.CSS_PREFIX+"-locked");}return t;}},data:{value:false},move:{value:true},useShim:{value:true},activeHandle:{value:false},primaryButtonOnly:{value:true},dragging:{value:false},parent:{value:false},target:{value:false,setter:function(t){this._handleTarget(t);return t;}},dragMode:{value:null,setter:function(t){return e._setDragMode(t);}},groups:{value:["default"],getter:function(){if(!this._groups){this._groups={};}var t=[];d.each(this._groups,function(w,u){t[t.length]=u;});return t;},setter:function(t){this._groups={};d.each(t,function(w,u){this._groups[w]=true;},this);return t;}},handles:{value:null,setter:function(t){if(t){this._handles={};d.each(t,function(w,u){var x=w;if(w instanceof d.Node||w instanceof d.NodeList){x=w._yuid;}this._handles[x]=w;},this);}else{this._handles=null;}return t;}},bubbles:{setter:function(u){this.addTarget(u);return u;}},haltDown:{value:true}};d.extend(a,d.Base,{_canDrag:function(t){if(t&&t.setXY&&t.getXY&&t.test&&t.contains){return true;}return false;},_bubbleTargets:d.DD.DDM,addToGroup:function(t){this._groups[t]=true;e._activateTargets();return this;},removeFromGroup:function(t){delete this._groups[t];e._activateTargets();return this;},target:null,_handleTarget:function(t){if(d.DD.Drop){if(t===false){if(this.target){e._unregTarget(this.target);this.target=null;}}else{if(!d.Lang.isObject(t)){t={};}t.bubbleTargets=t.bubbleTargets||d.Object.values(this._yuievt.targets);t.node=this.get(s);t.groups=t.groups||this.get("groups");this.target=new d.DD.Drop(t);}}},_groups:null,_createEvents:function(){this.publish(h,{defaultFn:this._defMouseDownFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(p,{defaultFn:this._defAlignFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(o,{defaultFn:this._defDragFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(i,{defaultFn:this._defEndFn,preventedFn:this._prevEndFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});var t=[b,f,m,q,r,k,"drag:drophit","drag:dropmiss","drag:over","drag:enter","drag:exit"];d.each(t,function(w,u){this.publish(w,{type:w,emitFacade:true,bubbles:true,preventable:false,queuable:false,prefix:"drag"});},this);},_ev_md:null,_startTime:null,_endTime:null,_handles:null,_invalids:null,_invalidsDefault:{"textarea":true,"input":true,"a":true,"button":true,"select":true},_dragThreshMet:null,_fromTimeout:null,_clickTimeout:null,deltaXY:null,startXY:null,nodeXY:null,lastXY:null,actXY:null,realXY:null,mouseXY:null,region:null,_handleMouseUp:function(t){this.fire("drag:mouseup");this._fixIEMouseUp();if(e.activeDrag){e._end();}},_fixDragStart:function(t){if(this.validClick(t)){t.preventDefault();}},_ieSelectFix:function(){return false;},_ieSelectBack:null,_fixIEMouseDown:function(t){if(d.UA.ie){this._ieSelectBack=d.config.doc.body.onselectstart;d.config.doc.body.onselectstart=this._ieSelectFix;}},_fixIEMouseUp:function(){if(d.UA.ie){d.config.doc.body.onselectstart=this._ieSelectBack;}},_handleMouseDownEvent:function(t){this.fire(h,{ev:t});},_defMouseDownFn:function(u){var t=u.ev;this._dragThreshMet=false;this._ev_md=t;if(this.get("primaryButtonOnly")&&t.button>1){return false;}if(this.validClick(t)){this._fixIEMouseDown(t);if(this.get("haltDown")){t.halt();}else{t.preventDefault();}this._setStartPosition([t.pageX,t.pageY]);e.activeDrag=this;this._clickTimeout=d.later(this.get("clickTimeThresh"),this,this._timeoutCheck);}this.fire(b,{ev:t});},validClick:function(x){var w=false,A=false,t=x.target,v=null,u=null,y=null,z=false;if(this._handles){d.each(this._handles,function(B,C){if(B instanceof d.Node||B instanceof d.NodeList){if(!w){y=B;if(y instanceof d.Node){y=new d.NodeList(B._node);}y.each(function(D){if(D.contains(t)){w=true;}});}}else{if(d.Lang.isString(C)){if(t.test(C+", "+C+" *")&&!v){v=C;w=true;}}}});}else{A=this.get(s);if(A.contains(t)||A.compareTo(t)){w=true;}}if(w){if(this._invalids){d.each(this._invalids,function(B,C){if(d.Lang.isString(C)){if(t.test(C+", "+C+" *")){w=false;}}});}}if(w){if(v){u=x.currentTarget.all(v);z=false;u.each(function(C,B){if((C.contains(t)||C.compareTo(t))&&!z){z=true;this.set("activeHandle",C);}},this);}else{this.set("activeHandle",this.get(s));}}return w;},_setStartPosition:function(t){this.startXY=t;this.nodeXY=this.lastXY=this.realXY=this.get(s).getXY();if(this.get("offsetNode")){this.deltaXY=[(this.startXY[0]-this.nodeXY[0]),(this.startXY[1]-this.nodeXY[1])];}else{this.deltaXY=[0,0];}},_timeoutCheck:function(){if(!this.get("lock")&&!this._dragThreshMet&&this._ev_md){this._fromTimeout=this._dragThreshMet=true;this.start();this._alignNode([this._ev_md.pageX,this._ev_md.pageY],true);}},removeHandle:function(u){var t=u;if(u instanceof d.Node||u instanceof d.NodeList){t=u._yuid;}if(this._handles[t]){delete this._handles[t];this.fire(f,{handle:u});}return this;},addHandle:function(u){if(!this._handles){this._handles={};}var t=u;if(u instanceof d.Node||u instanceof d.NodeList){t=u._yuid;
}this._handles[t]=u;this.fire(m,{handle:u});return this;},removeInvalid:function(t){if(this._invalids[t]){this._invalids[t]=null;delete this._invalids[t];this.fire(q,{handle:t});}return this;},addInvalid:function(t){if(d.Lang.isString(t)){this._invalids[t]=true;this.fire(r,{handle:t});}return this;},initializer:function(t){this.get(s).dd=this;if(!this.get(s).get("id")){var u=d.stamp(this.get(s));this.get(s).set("id",u);}this.actXY=[];this._invalids=d.clone(this._invalidsDefault,true);this._createEvents();if(!this.get(n)){this.set(n,this.get(s));}this.on("initializedChange",d.bind(this._prep,this));this.set("groups",this.get("groups"));},_prep:function(){this._dragThreshMet=false;var t=this.get(s);t.addClass(e.CSS_PREFIX+"-draggable");t.on(a.START_EVENT,d.bind(this._handleMouseDownEvent,this));t.on("mouseup",d.bind(this._handleMouseUp,this));t.on("dragstart",d.bind(this._fixDragStart,this));},_unprep:function(){var t=this.get(s);t.removeClass(e.CSS_PREFIX+"-draggable");t.detachAll("mouseup");t.detachAll("dragstart");t.detachAll(a.START_EVENT);this.mouseXY=[];this.deltaXY=[0,0];this.startXY=[];this.nodeXY=[];this.lastXY=[];this.actXY=[];this.realXY=[];},start:function(){if(!this.get("lock")&&!this.get(g)){var u=this.get(s),t,v,w;this._startTime=(new Date()).getTime();e._start();u.addClass(e.CSS_PREFIX+"-dragging");this.fire(k,{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime});u=this.get(n);w=this.nodeXY;t=u.get(l);v=u.get(c);if(this.get("startCentered")){this._setStartPosition([w[0]+(t/2),w[1]+(v/2)]);}this.region={"0":w[0],"1":w[1],area:0,top:w[1],right:w[0]+t,bottom:w[1]+v,left:w[0]};this.set(g,true);}return this;},end:function(){this._endTime=(new Date()).getTime();if(this._clickTimeout){this._clickTimeout.cancel();}this._dragThreshMet=this._fromTimeout=false;if(!this.get("lock")&&this.get(g)){this.fire(i,{pageX:this.lastXY[0],pageY:this.lastXY[1],startTime:this._startTime,endTime:this._endTime});}this.get(s).removeClass(e.CSS_PREFIX+"-dragging");this.set(g,false);this.deltaXY=[0,0];return this;},_defEndFn:function(t){this._fixIEMouseUp();this._ev_md=null;},_prevEndFn:function(t){this._fixIEMouseUp();this.get(n).setXY(this.nodeXY);this._ev_md=null;this.region=null;},_align:function(t){this.fire(p,{pageX:t[0],pageY:t[1]});},_defAlignFn:function(t){this.actXY=[t.pageX-this.deltaXY[0],t.pageY-this.deltaXY[1]];},_alignNode:function(u,t){this._align(u);if(!t){this._moveNode();}},_moveNode:function(t){var u=[],v=[],x=this.nodeXY,w=this.actXY;u[0]=(w[0]-this.lastXY[0]);u[1]=(w[1]-this.lastXY[1]);v[0]=(w[0]-this.nodeXY[0]);v[1]=(w[1]-this.nodeXY[1]);this.region={"0":w[0],"1":w[1],area:0,top:w[1],right:w[0]+this.get(n).get(l),bottom:w[1]+this.get(n).get(c),left:w[0]};this.fire(o,{pageX:w[0],pageY:w[1],scroll:t,info:{start:x,xy:w,delta:u,offset:v}});this.lastXY=w;},_defDragFn:function(t){if(this.get("move")){if(t.scroll&&t.scroll.node){t.scroll.node.set("scrollTop",t.scroll.top);t.scroll.node.set("scrollLeft",t.scroll.left);}this.get(n).setXY([t.pageX,t.pageY]);this.realXY=[t.pageX,t.pageY];}},_move:function(v){if(this.get("lock")){return false;}this.mouseXY=[v.pageX,v.pageY];if(!this._dragThreshMet){var u=Math.abs(this.startXY[0]-v.pageX),t=Math.abs(this.startXY[1]-v.pageY);if(u>this.get("clickPixelThresh")||t>this.get("clickPixelThresh")){this._dragThreshMet=true;this.start();this._alignNode([v.pageX,v.pageY]);}}else{if(this._clickTimeout){this._clickTimeout.cancel();}this._alignNode([v.pageX,v.pageY]);}},stopDrag:function(){if(this.get(g)){e._end();}return this;},destructor:function(){this._unprep();if(this.target){this.target.destroy();}e._unregDrag(this);}});d.namespace("DD");d.DD.Drag=a;},"@VERSION@",{"requires":["dd-ddm-base"]});