YUI.add("app-base",function(g){var c=g.Lang,f=g.View,a=g.Router,e=g.PjaxBase,d=g.config.win,b;b=g.Base.create("app",g.Base,[f,a,e],{views:{},initializer:function(i){i||(i={});var h=g.merge(i.views);this.views=g.mix(h,this.views,false,null,0,true);this._viewInfoMap={};this.after("activeViewChange",this._afterActiveViewChange);if(!this.get("serverRouting")){this._pjaxBindUI();}},create:function(){var h=f.prototype.create.apply(this,arguments);return h&&h.addClass(b.CSS_CLASS);},createView:function(k,j){var i=this.getViewInfo(k),l=(i&&i.type)||f,m=c.isString(l)?g[l]:l,h;h=new m(j);this._viewInfoMap[g.stamp(h,true)]=i;return h;},createViewContainer:function(h){h=g.one(h);return h&&h.addClass(b.VIEWS_CSS_CLASS);},getViewInfo:function(h){if(h instanceof f){return this._viewInfoMap[g.stamp(h,true)];}return this.views[h];},render:function(){var i=this.get("container"),h=this.get("viewContainer"),j=this.get("activeView"),k=i.compareTo(h);if(j&&h){h.setContent(j.get("container"));}if(i&&!i.contains(h)&&!k){i.appendChild(h);}return this;},showView:function(h,k,j,l){var i;if(c.isString(h)){i=this.getViewInfo(h);if(i&&i.preserve&&i.instance){h=i.instance;this._viewInfoMap[g.stamp(h,true)]=i;}else{h=this.createView(h,k);h.render();}}j||(j={});if(l){j.callback=l;}else{if(c.isFunction(j)){j={callback:j};}}return this._set("activeView",h,j);},_attachView:function(i,j){if(!i){return;}var k=this.getViewInfo(i),h=this.get("viewContainer");i.addTarget(this);k&&(k.instance=i);h[j?"prepend":"append"](i.get("container"));},_destroyContainer:function(){var i=this.get("container"),h=this.get("viewContainer"),j=i.compareTo(h);if(g.one("body").compareTo(i)){this.detachEvents();i&&i.removeClass(b.CSS_CLASS);if(j){i&&i.removeClass(b.VIEWS_CSS_CLASS);}else{h&&h.remove(true);}return;}h&&h.remove(true);!j&&i&&i.remove(true);},_detachView:function(h){if(!h){return;}var i=this.getViewInfo(h)||{};if(i.preserve){h.remove();}else{h.destroy();delete this._viewInfoMap[g.stamp(h,true)];if(h===i.instance){delete i.instance;}}h.removeTarget(this);},_initHtml5:function(){if(this.get("serverRouting")===false){return false;}else{return a.html5;}},_isChildView:function(h,k){var j=this.getViewInfo(h),i=this.getViewInfo(k);if(j&&i){return this.getViewInfo(j.parent)===i;}return false;},_isParentView:function(h,k){var i=this.getViewInfo(h),j=this.getViewInfo(k);if(i&&j){return this.getViewInfo(j.parent)===i;}return false;},_navigate:function(i,h){i=this._upgradeURL(i);h||(h={});if(!this.get("serverRouting")){c.isValue(h.force)||(h.force=true);if(!c.isValue(h.replace)){h.replace=i===this._upgradeURL(this._getURL());}}return e.prototype._navigate.call(this,i,h);},_save:function(h,i){if(this.get("serverRouting")&&!this.get("html5")){if(!this._hasSameOrigin(h)){g.error("Security error: The new URL must be of the same origin as the current URL.");return this;}h=this._joinURL(h||"");if(i){d&&d.location.replace(h);}else{d&&(d.location=h);}return this;}return a.prototype._save.apply(this,arguments);},_upgradeURL:function(i){if(!this._hasSameOrigin(i)){return i;}var j=(i.match(/#(.*)$/)||[])[1]||"",h=g.HistoryHash.hashPrefix;if(h&&j.indexOf(h)===0){j=j.replace(h,"");}if(j&&j.charAt(0)==="/"){i=this._resolveURL(this._joinURL(j));}return i;},_afterActiveViewChange:function(l){var n=l.newVal,k=l.prevVal,m=l.callback,h=this._isChildView(n,k),j=!h&&this._isParentView(n,k),i=!!l.prepend||j;if(n===k){return m&&m.call(this,n);}this._attachView(n,i);this._detachView(k);m&&m.call(this,n);}},{ATTRS:{activeView:{value:null,readOnly:true},container:{valueFn:function(){return g.one("body");}},html5:{valueFn:"_initHtml5"},linkSelector:{value:"a"},serverRouting:{value:undefined,writeOnce:"initOnly"},viewContainer:{valueFn:function(){return g.Node.create("<div/>");},setter:"createViewContainer",writeOnce:"initOnly"}},CSS_CLASS:g.ClassNameManager.getClassName("app"),VIEWS_CSS_CLASS:g.ClassNameManager.getClassName("app","views")});g.namespace("App").Base=b;g.App=g.mix(g.Base.create("app",g.App.Base,[]),g.App,true);},"@VERSION@",{requires:["classnamemanager","pjax-base","router","view"]});