YUI.add("dataschema-xml",function(C){var B=C.Lang,A={apply:function(F,G){var D=G,E={results:[],meta:{}};if(D&&D.nodeType&&(D.nodeType===9||D.nodeType===1||D.nodeType===11)&&F){E=A._parseResults(F,D,E);E=A._parseMeta(F.metaFields,D,E);}else{E.error=new Error("XML schema parse failure");}return E;},_getLocationValue:function(L,E){var I=L.locator||L.key||L,P=E.ownerDocument||E,Q,K,N=null;try{if(!B.isUndefined(P.evaluate)){Q=P.evaluate(I,E,P.createNSResolver(!E.ownerDocument?E.documentElement:E.ownerDocument.documentElement),0,null);while(K=Q.iterateNext()){N=K.textContent;}}else{try{P.setProperty("SelectionLanguage","XPath");Q=E.selectNodes(I)[0];N=Q.value||Q.text||null;}catch(H){var O=I.split("/"),G=0,F=O.length,M,D;for(;G<F;G++){M=O[G];if((M.indexOf("[")>-1)&&(M.indexOf("]")>-1)){D=M.slice(M.indexOf("[")+1,M.indexOf("]"));D--;E=E.childNodes[D];}if(M.indexOf("@")>-1){D=M.substr(M.indexOf("@"));E=D?E.getAttribute(D):E;}}N=E.innerHTML;}}return C.DataSchema.Base.parse(N,L);}catch(J){}},_parseMeta:function(H,G,F){if(B.isObject(H)){var E,D=G.ownerDocument||G;for(E in H){if(H.hasOwnProperty(E)){F.meta[E]=A._getLocationValue(H[E],D);}}}return F;},_parseResults:function(F,K,G){if(F.resultListLocator&&B.isArray(F.resultFields)){var E=K.getElementsByTagName(F.resultListLocator),L=F.resultFields,J=[],D,M,N,I,H;if(E.length){for(I=E.length-1;I>=0;I--){N={};D=E[I];for(H=L.length-1;H>=0;H--){M=L[H];N[M.key||M]=A._getLocationValue(M,D);}J[I]=N;}G.results=J;}else{G.error=new Error("XML schema result nodes retrieval failure");}}return G;}};C.DataSchema.XML=C.mix(A,C.DataSchema.Base);},"@VERSION@",{requires:["dataschema-base"]});