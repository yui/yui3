YUI.add("event-custom-complex",function(h){var c,g,e,f={},b=h.CustomEvent.prototype,d=h.EventTarget.prototype,a=function(i,k){var j;for(j in k){if(!(g.hasOwnProperty(j))){i[j]=k[j];}}};h.EventFacade=function(j,i){j=j||f;this._event=j;this.details=j.details;this.type=j.type;this._type=j.type;this.target=j.target;this.currentTarget=i;this.relatedTarget=j.relatedTarget;};h.mix(h.EventFacade.prototype,{stopPropagation:function(){this._event.stopPropagation();this.stopped=1;},stopImmediatePropagation:function(){this._event.stopImmediatePropagation();this.stopped=2;},preventDefault:function(){this._event.preventDefault();this.prevented=1;},halt:function(i){this._event.halt(i);this.prevented=1;this.stopped=(i)?2:1;}});b.fireComplex=function(s){var t,n,i,p,k,r,w,l,j,v=this,u=v.host||v,o,m;if(v.stack){if(v.queuable&&v.type!=v.stack.next.type){v.log("queue "+v.type);v.stack.queue.push([v,s]);return true;}}t=v.stack||{id:v.id,next:v,silent:v.silent,stopped:0,prevented:0,bubbling:null,type:v.type,afterQueue:new h.Queue(),defaultTargetOnly:v.defaultTargetOnly,queue:[]};l=v.getSubs();v.stopped=(v.type!==t.type)?0:t.stopped;v.prevented=(v.type!==t.type)?0:t.prevented;v.target=v.target||u;if(v.stoppedFn){w=new h.EventTarget({fireOnce:true,context:u});v.events=w;w.on("stopped",v.stoppedFn);}v.currentTarget=u;v.details=s.slice();v.log("Firing "+v.type);v._facade=null;n=v._getFacade(s);if(h.Lang.isObject(s[0])){s[0]=n;}else{s.unshift(n);}if(l[0]){v._procSubs(l[0],s,n);}if(v.bubbles&&u.bubble&&!v.stopped){m=t.bubbling;t.bubbling=v.type;if(t.type!=v.type){t.stopped=0;t.prevented=0;}r=u.bubble(v,s,null,t);v.stopped=Math.max(v.stopped,t.stopped);v.prevented=Math.max(v.prevented,t.prevented);t.bubbling=m;}if(v.prevented){if(v.preventedFn){v.preventedFn.apply(u,s);}}else{if(v.defaultFn&&((!v.defaultTargetOnly&&!t.defaultTargetOnly)||u===n.target)){v.defaultFn.apply(u,s);}}v._broadcast(s);if(l[1]&&!v.prevented&&v.stopped<2){if(t.id===v.id||v.type!=u._yuievt.bubbling){v._procSubs(l[1],s,n);while((o=t.afterQueue.last())){o();}}else{j=l[1];if(t.execDefaultCnt){j=h.merge(j);h.each(j,function(q){q.postponed=true;});}t.afterQueue.add(function(){v._procSubs(j,s,n);});}}v.target=null;if(t.id===v.id){p=t.queue;while(p.length){i=p.pop();k=i[0];t.next=k;k.fire.apply(k,i[1]);}v.stack=null;}r=!(v.stopped);if(v.type!=u._yuievt.bubbling){t.stopped=0;t.prevented=0;v.stopped=0;v.prevented=0;}v._facade=null;return r;};b._getFacade=function(){var i=this._facade,k,j=this.details;if(!i){i=new h.EventFacade(this,this.currentTarget);}k=j&&j[0];if(h.Lang.isObject(k,true)){a(i,k);i.type=k.type||i.type;}i.details=this.details;i.target=this.originalTarget||this.target;i.currentTarget=this.currentTarget;i.stopped=0;i.prevented=0;this._facade=i;return this._facade;};b.stopPropagation=function(){this.stopped=1;if(this.stack){this.stack.stopped=1;}if(this.events){this.events.fire("stopped",this);}};b.stopImmediatePropagation=function(){this.stopped=2;if(this.stack){this.stack.stopped=2;}if(this.events){this.events.fire("stopped",this);}};b.preventDefault=function(){if(this.preventable){this.prevented=1;if(this.stack){this.stack.prevented=1;}}};b.halt=function(i){if(i){this.stopImmediatePropagation();}else{this.stopPropagation();}this.preventDefault();};d.addTarget=function(i){this._yuievt.targets[h.stamp(i)]=i;this._yuievt.hasTargets=true;};d.getTargets=function(){return h.Object.values(this._yuievt.targets);};d.removeTarget=function(i){delete this._yuievt.targets[h.stamp(i)];};d.bubble=function(w,s,q,v){var o=this._yuievt.targets,r=true,x,u=w&&w.type,k,n,p,l,j=q||(w&&w.target)||this,m;if(!w||((!w.stopped)&&o)){for(n in o){if(o.hasOwnProperty(n)){x=o[n];k=x.getEvent(u,true);l=x.getSibling(u,k);if(l&&!k){k=x.publish(u);}m=x._yuievt.bubbling;x._yuievt.bubbling=u;if(!k){if(x._yuievt.hasTargets){x.bubble(w,s,j,v);}}else{k.sibling=l;k.target=j;k.originalTarget=j;k.currentTarget=x;p=k.broadcast;k.broadcast=false;k.emitFacade=true;k.stack=v;r=r&&k.fire.apply(k,s||w.details||[]);k.broadcast=p;k.originalTarget=null;if(k.stopped){break;}}x._yuievt.bubbling=m;}}}return r;};c=new h.EventFacade();g={};for(e in c){g[e]=true;}},"@VERSION@",{requires:["event-custom-base"]});