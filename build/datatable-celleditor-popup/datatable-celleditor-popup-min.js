YUI.add("datatable-celleditor-popup",function(e,t){var n=e.Array.map,r=e.Lang,i=r.sub,s=e.Date,o=e.Number,u=e.Plugin||{},a=e.Base.create,f={},l=e.DataTable.BaseCellEditor;PlainText=a("celleditor",l,[],{},{ATTRS:{template:{value:'<input type="text" class="{classInput}" />'},popup:{value:!0},buttons:{value:[{save:!0},{cancel:!0}]}}}),f.text=PlainText,f.textarea=a("celleditor",PlainText,[],{},{ATTRS:{template:{value:'<textarea class="{classInput}"></textarea>'},saveOnEnterKey:{value:!1},buttons:{value:[{save:!0},{cancel:!0}]}}}),f.number=a("celleditor",PlainText,[],{},{ATTRS:{numberFormat:{value:null},keyFiltering:{value:/^(\.\,|\d|\-)*$/},formatter:{value:function(e){var t=this.get("numberFormat");return t&&o?o.format(e,t):e}},parser:{value:function(t){var n=this.get("numberFormat");return n&&o?t=o.parse(t,n):t=parseFloat(t),r.isValue(t)?t:e.Attribute.INVALID_VALUE}}}}),f.date=a("celleditor",PlainText,[],{},{ATTRS:{dateFormat:{value:"%x"},keyFiltering:{value:/^(\/|\d|\-)*$/},formatter:{value:function(e){return s?s.format(e,this.get("dateFormat")):e.toString()}},parser:{value:function(t){return(s?s.parse(t,this.get("dateFormat")):Date.parse(t))||e.Attribute.INVALID_VALUE}}}}),f.calendar=a("celleditor",f.date,[],{_defRenderFn:function(){f.calendar.superclass._defRenderFn.apply(this,arguments);var t=this.get("container").one(".yui3-datatable-celleditor-calendar"),n;t&&e.Calendar&&(n=(new e.Calendar(e.merge({contentBox:t,height:"215px",width:"200px",showPrevMonth:!0,showNextMonth:!0},this.get("calendarConfig")||{}))).render(),u.Calendar&&u.Calendar.JumpNav&&this.plug(u.Calendar.JumpNav,{yearStart:1988,yearEnd:2021}),this._subscr.push(n.on("dateClick",this._afterCalendarClick,this)),this._calendar=n)},_afterCalendarClick:function(e){var t=e.date;this._inputNode.set("value",s?s.format(t,this.get("dateFormat")||"%x"):t.toString()),this.get("saveOnSelectDate")&&this.saveEditor()},destructor:function(){this._calendar&&this._calendar.destroy({remove:!0})},_defShowFn:function(e){f.calendar.superclass._defShowFn.apply(this,arguments);var t=this._calendar;t&&(t.set("date",e.initialValue),t.selectDates(e.initialValue))}},{ATTRS:{template:{value:'<input type="text" class="{classInput}"  /><br/><div class="yui3-datatable-celleditor-calendar"></div>'},buttons:{value:[{save:!0},{cancel:!0}]},keyFiltering:{value:/^(\/|\d|\-)*$/},formatter:{value:function(e){return s?s.format(e,this.get("dateFormat")||"%x"):e.toString()}},parser:{value:function(t){return(s?s.parse(t,this.get("dateFormat")||"%x"):Date.parse(t))||e.Attribute.INVALID_VALUE}},calendarConfig:{value:null},saveOnSelectDate:{value:!0,validator:r.isBoolean}}}),f.autocomplete=a("celleditor",PlainText,[],{_defRenderFn:function(){f.autocomplete.superclass._defRenderFn.apply(this,arguments);var t=this._inputNode;t&&u.AutoComplete&&(t.plug(u.AutoComplete,e.merge({source:this.get("lookupTable"),resultTextLocator:"text",alwaysShowList:!0,resultHighlighter:"startsWith",render:!0},this.get("autocompleteConfig"))),t.ac.after("select",function(e){this.saveEditor(e.result.raw.value)},this))}},{ATTRS:{lookupTable:{value:null},autocompleteConfig:{value:null}}}),f.radio=a("celleditor",l,[],{_defRenderFn:function(){f.radio.superclass._defRenderFn.apply(this,arguments);var t=this.get("template").replace("{name}",e.guid()),r=this._overlay,s=n(this.get("lookupTable"),function(e){return i(t,e)},this);r.set("bodyContent",s.join("\n")),this._subscr.push(r.get("contentBox").delegate("click",this._afterRadioClick,'input[type="radio"]',this))},_afterRadioClick:function(e){var t=e.target.get("value");r.isValue(t)&&this.saveEditor(t)},_defShowFn:function(e){f.radio.superclass._defShowFn.apply(this,arguments);var t=this._overlay.get("contentBox").one('input[type="radio"][value="'+e.initialValue+'"]');t&&(t.set("checked",!0),t.focus())}},{ATTRS:{template:{value:'<div class="yui3-datatable-celleditor-radio"><input type="radio" name="{name}" value="{value}"/>{text}</div>'},popup:{value:!0},lookupTable:{value:null}}}),f.dropdown=a("celleditor",l,[],{_defRenderFn:function(){f.dropdown.superclass._defRenderFn.apply(this,arguments);var e=this.get("optionTemplate"),t=this._inputNode,r=n(this.get("lookupTable"),function(t){return i(e,t)},this);t.setHTML(r.join("\n")),this._subscr.push(t.on("change",this._afterDropdownChange,this))},_afterDropdownChange:function(e){var t=e.target.get("value");r.isValue(t)&&this.saveEditor(t)},_defShowFn:function(e){f.dropdown.superclass._defShowFn.apply(this,arguments),this._inputNode.set("value",e.initialValue).focus()}},{ATTRS:{template:{value:'<select class="{classInput}">{options}</select>'},popup:{value:!0},optionTemplate:{value:'<option value="{value}">{text}</option>'},lookupTable:{value:null},buttons:{value:[{cancel:!0}]}}}),f.combobox=f.select=f.dropdown,f.checkbox=a("celleditor",l,[],{_defRenderFn:function(){f.checkbox.superclass._defRenderFn.apply(this,arguments),this._subscr.push(this._inputNode.on("click",this._afterCheckboxClick,this))},_afterCheckboxClick:function(){this.saveEditor(!!this._inputNode.get("checked"))},_defShowFn:function(e){f.checkbox.superclass._defShowFn.apply(this,arguments),this._inputNode.set("checked",!!e.formattedValue).focus()}},{ATTRS:{template:{value:'<input type="checkbox" class="{classInput}" />'},popup:{value:!0},buttons:{value:[{cancel:!0}]}}}),e.DataTable.BaseCellPopupEditor=l,e.mix(e.DataTable.Editors,f)},"@VERSION@",{skinnable:"true",requires:["datatable-editable","base-build","view","cssbutton","event-outside","overlay","dd-plugin","template","array-extras"]});
