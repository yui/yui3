YUI.add("frame",function(b){var a=function(){a.superclass.constructor.apply(this,arguments);};b.extend(a,b.Base,{_ready:null,_rendered:null,_iframe:null,_instance:null,_create:function(c){var i,h,e,g;this._iframe=b.Node.create(a.HTML);this._iframe.setStyle("visibility","hidden");this._iframe.set("src",this.get("src"));this.get("container").append(this._iframe);this._iframe.set("height","99%");var d="",f=((this.get("extracss"))?'<style id="extra_css">'+this.get("extracss")+"</style>":"");d=b.substitute(a.PAGE_HTML,{DIR:this.get("dir"),LANG:this.get("lang"),TITLE:this.get("title"),META:a.META,LINKED_CSS:this.get("linkedcss"),CONTENT:this.get("content"),BASE_HREF:this.get("basehref"),DEFAULT_CSS:a.DEFAULT_CSS,EXTRA_CSS:f});if(b.config.doc.compatMode!="BackCompat"){d=a.getDocType()+"\n"+d;}else{}e=this._resolveWinDoc();e.doc.open();e.doc.write(d);e.doc.close();if(this.get("designMode")){e.doc.designMode="on";}if(!e.doc.documentElement){var j=b.later(1,this,function(){if(e.doc&&e.doc.documentElement){c(e);j.cancel();}},null,true);}else{c(e);}},_resolveWinDoc:function(e){var d=(e)?e:{};d.win=b.Node.getDOMNode(this._iframe.get("contentWindow"));d.doc=b.Node.getDOMNode(this._iframe.get("contentWindow.document"));if(!d.doc){d.doc=b.config.doc;}if(!d.win){d.win=b.config.win;}return d;},_onDomEvent:function(f){var d,c;f.frameX=f.frameY=0;if(f.pageX>0||f.pageY>0){if(f.type.substring(0,3)!=="key"){c=this._instance.one("win");d=this._iframe.getXY();f.frameX=d[0]+f.pageX-c.get("scrollLeft");f.frameY=d[1]+f.pageY-c.get("scrollTop");}}f.frameTarget=f.target;f.frameCurrentTarget=f.currentTarget;f.frameEvent=f;this.fire("dom:"+f.type,f);},initializer:function(){this.publish("ready",{emitFacade:true,defaultFn:this._defReadyFn});},destructor:function(){var c=this.getInstance();c.one("doc").detachAll();c=null;this._iframe.remove();},_DOMPaste:function(g){var d=this.getInstance(),c="",f=d.config.win;if(g._event.originalTarget){c=g._event.originalTarget;}if(g._event.clipboardData){c=g._event.clipboardData.getData("Text");}if(f.clipboardData){c=f.clipboardData.getData("Text");if(c===""){if(!f.clipboardData.setData("Text",c)){c=null;}}}g.frameTarget=g.target;g.frameCurrentTarget=g.currentTarget;g.frameEvent=g;if(c){g.clipboardData={data:c,getData:function(){return c;}};}else{g.clipboardData=null;}this.fire("dom:paste",g);},_defReadyFn:function(){var e=this.getInstance(),c=b.bind(this._onDomEvent,this),d=((b.UA.ie)?b.throttle(c,200):c);e.Node.DOM_EVENTS.activate=1;e.Node.DOM_EVENTS.beforedeactivate=1;e.Node.DOM_EVENTS.focusin=1;e.Node.DOM_EVENTS.deactivate=1;e.Node.DOM_EVENTS.focusout=1;b.each(a.DOM_EVENTS,function(g,f){if(g===1){if(f!=="focus"&&f!=="blur"&&f!=="paste"){if(f.substring(0,3)==="key"){if(f==="keydown"){e.on(f,c,e.config.doc);}else{e.on(f,d,e.config.doc);}}else{e.on(f,c,e.config.doc);}}}},this);e.Node.DOM_EVENTS.paste=1;e.on("paste",b.bind(this._DOMPaste,this),e.one("body"));e.on("focus",c,e.config.win);e.on("blur",c,e.config.win);e._use=e.use;e.use=b.bind(this.use,this);this._iframe.setStyles({visibility:"inherit"});e.one("body").setStyle("display","block");if(b.UA.ie){this._fixIECursors();}},_fixIECursors:function(){var f=this.getInstance(),d=f.all("table"),e=f.all("br"),c;if(d.size()&&e.size()){c=d.item(0).get("sourceIndex");e.each(function(j){var h=j.get("parentNode"),i=h.get("children"),g=h.all(">br");if(h.test("div")){if(i.size()>2){j.replace(f.Node.create("<wbr>"));}else{if(j.get("sourceIndex")>c){if(g.size()){j.replace(f.Node.create("<wbr>"));}}else{if(g.size()>1){j.replace(f.Node.create("<wbr>"));}}}}});}},_onContentReady:function(f){if(!this._ready){this._ready=true;var d=this.getInstance(),c=b.clone(this.get("use"));this.fire("contentready");if(f){d.config.doc=b.Node.getDOMNode(f.target);}c.push(b.bind(function(){if(d.Selection){d.Selection.DEFAULT_BLOCK_TAG=this.get("defaultblock");}this.fire("ready");},this));d.use.apply(d,c);d.one("doc").get("documentElement").addClass("yui-js-enabled");}},_resolveBaseHref:function(c){if(!c||c===""){c=b.config.doc.location.href;if(c.indexOf("?")!==-1){c=c.substring(0,c.indexOf("?"));}c=c.substring(0,c.lastIndexOf("/"))+"/";}return c;},_getHTML:function(c){if(this._ready){var d=this.getInstance();c=d.one("body").get("innerHTML");}return c;},_setHTML:function(c){if(this._ready){var d=this.getInstance();d.one("body").set("innerHTML",c);}else{this.on("contentready",b.bind(function(f,h){var g=this.getInstance();g.one("body").set("innerHTML",f);},this,c));}return c;},_getLinkedCSS:function(c){if(!b.Lang.isArray(c)){c=[c];}var d="";if(!this._ready){b.each(c,function(e){if(e!==""){d+='<link rel="stylesheet" href="'+e+'" type="text/css">';}});}else{d=c;}return d;},_setLinkedCSS:function(c){if(this._ready){var d=this.getInstance();d.Get.css(c);}return c;},_setExtraCSS:function(c){if(this._ready){var e=this.getInstance(),d=e.get("#extra_css");d.remove();e.one("head").append('<style id="extra_css">'+c+"</style>");}return c;},_instanceLoaded:function(d){this._instance=d;this._onContentReady();var e=this._instance.config.doc;if(this.get("designMode")){if(!b.UA.ie){try{e.execCommand("styleWithCSS",false,false);e.execCommand("insertbronreturn",false,false);}catch(c){}}}},use:function(){var e=this.getInstance(),d=b.Array(arguments),c=false;if(b.Lang.isFunction(d[d.length-1])){c=d.pop();}if(c){d.push(function(){c.apply(e,arguments);});}e._use.apply(e,d);},delegate:function(e,d,c,g){var f=this.getInstance();if(!f){return false;}if(!g){g=c;c="body";}return f.delegate(e,d,c,g);},getInstance:function(){return this._instance;},render:function(c){if(this._rendered){return this;}this._rendered=true;if(c){this.set("container",c);}this._create(b.bind(function(g){var i,j,d=b.bind(function(k){this._instanceLoaded(k);},this),f=b.clone(this.get("use")),e={debug:false,win:g.win,doc:g.doc},h=b.bind(function(){e=this._resolveWinDoc(e);i=YUI(e);try{i.use("node-base",d);if(j){clearInterval(j);}}catch(k){j=setInterval(function(){h();},350);}},this);f.push(h);b.use.apply(b,f);},this));return this;
},_handleFocus:function(){var e=this.getInstance(),d=new e.Selection();if(d.anchorNode){var g=d.anchorNode,f=g.get("childNodes");if(f.size()==1){if(f.item(0).test("br")){d.selectNode(g,true,false);}if(f.item(0).test("p")){g=f.item(0).one("br.yui-cursor").get("parentNode");d.selectNode(g,true,false);}}}},focus:function(c){if(b.UA.ie){try{b.one("win").focus();this.getInstance().one("win").focus();}catch(e){}if(c===true){this._handleFocus();}if(b.Lang.isFunction(c)){c();}}else{try{b.one("win").focus();b.later(100,this,function(){this.getInstance().one("win").focus();if(c===true){this._handleFocus();}if(b.Lang.isFunction(c)){c();}});}catch(d){}}return this;},show:function(){this._iframe.setStyles({position:"static",left:""});if(b.UA.gecko){try{this._instance.config.doc.designMode="on";}catch(c){}this.focus();}return this;},hide:function(){this._iframe.setStyles({position:"absolute",left:"-999999px"});return this;}},{DOM_EVENTS:{dblclick:1,click:1,paste:1,mouseup:1,mousedown:1,keyup:1,keydown:1,keypress:1,activate:1,deactivate:1,beforedeactivate:1,focusin:1,focusout:1},DEFAULT_CSS:"body { background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } img { cursor: pointer !important; border: none; }",HTML:'<iframe border="0" frameBorder="0" marginWidth="0" marginHeight="0" leftMargin="0" topMargin="0" allowTransparency="true" width="100%" height="99%"></iframe>',PAGE_HTML:'<html dir="{DIR}" lang="{LANG}"><head><title>{TITLE}</title>{META}<base href="{BASE_HREF}"/>{LINKED_CSS}<style id="editor_css">{DEFAULT_CSS}</style>{EXTRA_CSS}</head><body>{CONTENT}</body></html>',getDocType:function(){var c=b.config.doc.doctype,d=a.DOC_TYPE;if(c){d="<!DOCTYPE "+c.name+((c.publicId)?" "+c.publicId:"")+((c.systemId)?" "+c.systemId:"")+">";}else{if(b.config.doc.all){c=b.config.doc.all[0];if(c.nodeType){if(c.nodeType===8){if(c.nodeValue){if(c.nodeValue.toLowerCase().indexOf("doctype")!==-1){d="<!"+c.nodeValue+">";}}}}}}return d;},DOC_TYPE:'<!DOCTYPE HTML PUBLIC "-/'+"/W3C/"+"/DTD HTML 4.01/"+'/EN" "http:/'+'/www.w3.org/TR/html4/strict.dtd">',META:'<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>',NAME:"frame",ATTRS:{title:{value:"Blank Page"},dir:{value:"ltr"},lang:{value:"en-US"},src:{value:"javascript"+((b.UA.ie)?":false":":")+";"},designMode:{writeOnce:true,value:false},content:{value:"<br>",setter:"_setHTML",getter:"_getHTML"},basehref:{value:false,getter:"_resolveBaseHref"},use:{writeOnce:true,value:["substitute","node","node-style","selector-css3"]},container:{value:"body",setter:function(c){return b.one(c);}},node:{readOnly:true,value:null,getter:function(){return this._iframe;}},id:{writeOnce:true,getter:function(c){if(!c){c="iframe-"+b.guid();}return c;}},linkedcss:{value:"",getter:"_getLinkedCSS",setter:"_setLinkedCSS"},extracss:{value:"",setter:"_setExtraCSS"},host:{value:false},defaultblock:{value:"p"}}});b.Frame=a;},"@VERSION@",{skinnable:false,requires:["base","node","selector-css3","substitute"]});YUI.add("selection",function(b){var a="textContent",d="innerHTML",c="fontFamily";if(b.UA.ie){a="nodeValue";}b.Selection=function(m){var j,o,f,g,e,l;if(b.config.win.getSelection){j=b.config.win.getSelection();}else{if(b.config.doc.selection){j=b.config.doc.selection.createRange();}}this._selection=j;if(j.pasteHTML){this.isCollapsed=(j.compareEndPoints("StartToEnd",j))?false:true;if(this.isCollapsed){this.anchorNode=this.focusNode=b.one(j.parentElement());if(m){f=b.config.doc.elementFromPoint(m.clientX,m.clientY);}if(!f){o=j.parentElement();g=o.childNodes;e=j.duplicate();for(l=0;l<g.length;l++){if(e.inRange(j)){if(!f){f=g[l];}}}}this.ieNode=f;if(f){if(f.nodeType!==3){if(f.firstChild){f=f.firstChild;}if(f&&f.tagName&&f.tagName.toLowerCase()==="body"){if(f.firstChild){f=f.firstChild;}}}this.anchorNode=this.focusNode=b.Selection.resolve(f);this.anchorOffset=this.focusOffset=(this.anchorNode.nodeValue)?this.anchorNode.nodeValue.length:0;this.anchorTextNode=this.focusTextNode=b.one(f);}}else{if(j.htmlText){var k=b.Node.create(j.htmlText);if(k.get("id")){var h=k.get("id");this.anchorNode=this.focusNode=b.one("#"+h);}else{k=k.get("childNodes");this.anchorNode=this.focusNode=k.item(0);}}}}else{this.isCollapsed=j.isCollapsed;this.anchorNode=b.Selection.resolve(j.anchorNode);this.focusNode=b.Selection.resolve(j.focusNode);this.anchorOffset=j.anchorOffset;this.focusOffset=j.focusOffset;this.anchorTextNode=b.one(j.anchorNode);this.focusTextNode=b.one(j.focusNode);}if(b.Lang.isString(j.text)){this.text=j.text;}else{if(j.toString){this.text=j.toString();}else{this.text="";}}};b.Selection.filter=function(e){var h=(new Date()).getTime();var g=b.all(b.Selection.ALL),k=b.all("strong,em"),n=b.config.doc,p=n.getElementsByTagName("hr"),f={},i="",l;var j=(new Date()).getTime();g.each(function(r){var q=b.Node.getDOMNode(r);if(q.style[c]){f["."+r._yuid]=q.style[c];r.addClass(r._yuid);q.style[c]="inherit";q.removeAttribute("face");if(q.getAttribute("style")===""){q.removeAttribute("style");}if(q.getAttribute("style")){if(q.getAttribute("style").toLowerCase()==="font-family: "){q.removeAttribute("style");}}}});var o=(new Date()).getTime();b.all(".hr").addClass("yui-skip").addClass("yui-non");b.each(p,function(t){var r=n.createElement("div");r.className="hr yui-non yui-skip";r.setAttribute("readonly",true);r.setAttribute("contenteditable",false);if(t.parentNode){t.parentNode.replaceChild(r,t);}var q=r.style;q.border="1px solid #ccc";q.lineHeight="0";q.fontSize="0";q.marginTop="5px";q.marginBottom="5px";q.marginLeft="0px";q.marginRight="0px";q.padding="0";});b.each(f,function(r,q){i+=q+" { font-family: "+r.replace(/"/gi,"")+"; }";});b.StyleSheet(i,"editor");k.each(function(u,q){var r=u.get("tagName").toLowerCase(),s="i";if(r==="strong"){s="b";}b.Selection.prototype._swap(k.item(q),s);});l=b.all("ol,ul");l.each(function(r,q){var s=r.all("li");if(!s.size()){r.remove();
}});if(e){b.Selection.filterBlocks();}var m=(new Date()).getTime();};b.Selection.filterBlocks=function(){var f=(new Date()).getTime();var n=b.config.doc.body.childNodes,h,g,q=false,k=true,e,r,t,p,m,o,u;if(n){for(h=0;h<n.length;h++){g=b.one(n[h]);if(!g.test(b.Selection.BLOCKS)){k=true;if(n[h].nodeType==3){o=n[h][a].match(b.Selection.REG_CHAR);u=n[h][a].match(b.Selection.REG_NON);if(o===null&&u){k=false;}}if(k){if(!q){q=[];}q.push(n[h]);}}else{q=b.Selection._wrapBlock(q);}}q=b.Selection._wrapBlock(q);}r=b.all(b.Selection.DEFAULT_BLOCK_TAG);if(r.size()===1){t=r.item(0).all("br");if(t.size()===1){if(!t.item(0).test(".yui-cursor")){t.item(0).remove();}var j=r.item(0).get("innerHTML");if(j===""||j===" "){r.set("innerHTML",b.Selection.CURSOR);e=new b.Selection();e.focusCursor(true,true);}}}else{r.each(function(s){var i=s.get("innerHTML");if(i===""){s.remove();}});}if(!b.UA.ie){}var l=(new Date()).getTime();};b.Selection.REG_CHAR=/[a-zA-Z-0-9_]/gi;b.Selection.REG_NON=/[\s\S|\n|\t]/gi;b.Selection.REG_NOHTML=/<\S[^><]*>/g;b.Selection._wrapBlock=function(f){if(f){var e=b.Node.create("<"+b.Selection.DEFAULT_BLOCK_TAG+"></"+b.Selection.DEFAULT_BLOCK_TAG+">"),h=b.one(f[0]),g;for(g=1;g<f.length;g++){e.append(f[g]);}h.replace(e);e.prepend(h);}return false;};b.Selection.unfilter=function(){var g=b.all("body [class]"),h="",f,i,e=b.one("body");g.each(function(j){if(j.hasClass(j._yuid)){j.setStyle(c,j.getStyle(c));j.removeClass(j._yuid);if(j.getAttribute("class")===""){j.removeAttribute("class");}}});f=b.all(".yui-non");f.each(function(j){if(!j.hasClass("yui-skip")&&j.get("innerHTML")===""){j.remove();}else{j.removeClass("yui-non").removeClass("yui-skip");}});i=b.all("body [id]");i.each(function(j){if(j.get("id").indexOf("yui_3_")===0){j.removeAttribute("id");j.removeAttribute("_yuid");}});if(e){h=e.get("innerHTML");}b.all(".hr").addClass("yui-skip").addClass("yui-non");return h;};b.Selection.resolve=function(f){if(f&&f.nodeType===3){try{f=f.parentNode;}catch(e){f="body";}}return b.one(f);};b.Selection.getText=function(f){var e=f.get("innerHTML").replace(b.Selection.REG_NOHTML,"");e=e.replace("<span><br></span>","").replace("<br>","");return e;};b.Selection.DEFAULT_BLOCK_TAG="p";b.Selection.ALL="[style],font[face]";b.Selection.BLOCKS="p,div,ul,ol,table,style";b.Selection.TMP="yui-tmp";b.Selection.DEFAULT_TAG="span";b.Selection.CURID="yui-cursor";b.Selection.CUR_WRAPID="yui-cursor-wrapper";b.Selection.CURSOR='<span><br class="yui-cursor"></span>';b.Selection.hasCursor=function(){var e=b.all("#"+b.Selection.CUR_WRAPID);return e.size();};b.Selection.cleanCursor=function(){var f,e="br.yui-cursor";f=b.all(e);if(f.size()){f.each(function(g){var i=g.get("parentNode.parentNode.childNodes"),h;if(i.size()>1){g.remove();}else{h=b.Selection.getText(i.item(0));if(h!==""){g.remove();}}});}};b.Selection.prototype={text:null,isCollapsed:null,anchorNode:null,anchorOffset:null,anchorTextNode:null,focusNode:null,focusOffset:null,focusTextNode:null,_selection:null,_wrap:function(g,e){var f=b.Node.create("<"+e+"></"+e+">");f.set(d,g.get(d));g.set(d,"");g.append(f);return b.Node.getDOMNode(f);},_swap:function(g,e){var f=b.Node.create("<"+e+"></"+e+">");f.set(d,g.get(d));g.replace(f,g);return b.Node.getDOMNode(f);},getSelected:function(){b.Selection.filter();b.config.doc.execCommand("fontname",null,b.Selection.TMP);var f=b.all(b.Selection.ALL),e=[];f.each(function(h,g){if(h.getStyle(c)==b.Selection.TMP){h.setStyle(c,"");h.removeAttribute("face");if(h.getAttribute("style")===""){h.removeAttribute("style");}if(!h.test("body")){e.push(b.Node.getDOMNode(f.item(g)));}}});return b.all(e);},insertContent:function(e){return this.insertAtCursor(e,this.anchorTextNode,this.anchorOffset,true);},insertAtCursor:function(l,g,i,o){var q=b.Node.create("<"+b.Selection.DEFAULT_TAG+' class="yui-non"></'+b.Selection.DEFAULT_TAG+">"),f,j,h,p,k=this.createRange(),n;if(g&&g.test("body")){n=b.Node.create("<span></span>");g.append(n);g=n;}if(k.pasteHTML){p=b.Node.create(l);try{k.pasteHTML('<span id="rte-insert"></span>');}catch(m){}f=b.one("#rte-insert");if(f){f.set("id","");f.replace(p);return p;}else{b.on("available",function(){f.set("id","");f.replace(p);},"#rte-insert");}}else{if(i>0){f=g.get(a);j=b.one(b.config.doc.createTextNode(f.substr(0,i)));h=b.one(b.config.doc.createTextNode(f.substr(i)));g.replace(j,g);p=b.Node.create(l);if(p.get("nodeType")===11){n=b.Node.create("<span></span>");n.append(p);p=n;}j.insert(p,"after");if(h){p.insert(q,"after");q.insert(h,"after");this.selectNode(q,o);}}else{if(g.get("nodeType")===3){g=g.get("parentNode");}p=b.Node.create(l);l=g.get("innerHTML").replace(/\n/gi,"");if(l===""||l==="<br>"){g.append(p);}else{if(p.get("parentNode")){g.insert(p,"before");}else{b.one("body").prepend(p);}}if(g.get("firstChild").test("br")){g.get("firstChild").remove();}}}return p;},wrapContent:function(f){f=(f)?f:b.Selection.DEFAULT_TAG;if(!this.isCollapsed){var h=this.getSelected(),k=[],g,i,j,e;h.each(function(o,l){var m=o.get("tagName").toLowerCase();if(m==="font"){k.push(this._swap(h.item(l),f));}else{k.push(this._wrap(h.item(l),f));}},this);g=this.createRange();j=k[0];i=k[k.length-1];if(this._selection.removeAllRanges){g.setStart(k[0],0);g.setEnd(i,i.childNodes.length);this._selection.removeAllRanges();this._selection.addRange(g);}else{g.moveToElementText(b.Node.getDOMNode(j));e=this.createRange();e.moveToElementText(b.Node.getDOMNode(i));g.setEndPoint("EndToEnd",e);g.select();}k=b.all(k);return k;}else{return b.all([]);}},replace:function(k,i){var f=this.createRange(),j,e,g,h;if(f.getBookmark){g=f.getBookmark();e=this.anchorNode.get("innerHTML").replace(k,i);this.anchorNode.set("innerHTML",e);f.moveToBookmark(g);h=b.one(f.parentElement());}else{j=this.anchorTextNode;e=j.get(a);g=e.indexOf(k);e=e.replace(k,"");j.set(a,e);h=this.insertAtCursor(i,j,g,true);}return h;},remove:function(){this._selection.removeAllRanges();return this;},createRange:function(){if(b.config.doc.selection){return b.config.doc.selection.createRange();}else{return b.config.doc.createRange();
}},selectNode:function(i,k,f){if(!i){return;}f=f||0;i=b.Node.getDOMNode(i);var g=this.createRange();if(g.selectNode){g.selectNode(i);this._selection.removeAllRanges();this._selection.addRange(g);if(k){try{this._selection.collapse(i,f);}catch(h){this._selection.collapse(i,0);}}}else{if(i.nodeType===3){i=i.parentNode;}try{g.moveToElementText(i);}catch(j){}if(k){g.collapse(((f)?false:true));}g.select();}return this;},setCursor:function(){this.removeCursor(false);return this.insertContent(b.Selection.CURSOR);},getCursor:function(){return b.all("#"+b.Selection.CURID);},removeCursor:function(e){var f=this.getCursor();if(f){if(e){f.removeAttribute("id");f.set("innerHTML",'<br class="yui-cursor">');}else{f.remove();}}return f;},focusCursor:function(g,e){if(g!==false){g=true;}if(e!==false){e=true;}var f=this.removeCursor(true);if(f){f.each(function(h){this.selectNode(h,g,e);},this);}},toString:function(){return"Selection Object";}};},"@VERSION@",{skinnable:false,requires:["node"]});YUI.add("exec-command",function(b){var a=function(){a.superclass.constructor.apply(this,arguments);};b.extend(a,b.Base,{_lastKey:null,_inst:null,command:function(f,e){var d=a.COMMANDS[f];if(d){return d.call(this,f,e);}else{return this._command(f,e);}},_command:function(g,f){var d=this.getInstance();try{try{d.config.doc.execCommand("styleWithCSS",null,1);}catch(j){try{d.config.doc.execCommand("useCSS",null,0);}catch(i){}}d.config.doc.execCommand(g,null,f);}catch(h){}},getInstance:function(){if(!this._inst){this._inst=this.get("host").getInstance();}return this._inst;},initializer:function(){b.mix(this.get("host"),{execCommand:function(e,d){return this.exec.command(e,d);},_execCommand:function(e,d){return this.exec._command(e,d);}});this.get("host").on("dom:keypress",b.bind(function(d){this._lastKey=d.keyCode;},this));}},{NAME:"execCommand",NS:"exec",ATTRS:{host:{value:false}},COMMANDS:{wrap:function(f,d){var e=this.getInstance();return(new e.Selection()).wrapContent(d);},inserthtml:function(f,d){var e=this.getInstance();if(e.Selection.hasCursor()||b.UA.ie){return(new e.Selection()).insertContent(d);}else{this._command("inserthtml",d);}},insertandfocus:function(h,e){var g=this.getInstance(),d,f;if(g.Selection.hasCursor()){e+=g.Selection.CURSOR;d=this.command("inserthtml",e);f=new g.Selection();f.focusCursor(true,true);}else{this.command("inserthtml",e);}return d;},insertbr:function(f){var e=this.getInstance(),g,d=new e.Selection();d.setCursor();g=d.getCursor();g.insert("<br>","before");d.focusCursor(true,false);return((g&&g.previous)?g.previous():null);},insertimage:function(e,d){return this.command("inserthtml",'<img src="'+d+'">');},addclass:function(f,d){var e=this.getInstance();return(new e.Selection()).getSelected().addClass(d);},removeclass:function(f,d){var e=this.getInstance();return(new e.Selection()).getSelected().removeClass(d);},forecolor:function(f,g){var e=this.getInstance(),d=new e.Selection(),h;if(!b.UA.ie){this._command("useCSS",false);}if(e.Selection.hasCursor()){if(d.isCollapsed){if(d.anchorNode&&(d.anchorNode.get("innerHTML")==="&nbsp;")){d.anchorNode.setStyle("color",g);h=d.anchorNode;}else{h=this.command("inserthtml",'<span style="color: '+g+'">'+e.Selection.CURSOR+"</span>");d.focusCursor(true,true);}return h;}else{return this._command(f,g);}}else{this._command(f,g);}},backcolor:function(f,g){var e=this.getInstance(),d=new e.Selection(),h;if(b.UA.gecko||b.UA.opera){f="hilitecolor";}if(!b.UA.ie){this._command("useCSS",false);}if(e.Selection.hasCursor()){if(d.isCollapsed){if(d.anchorNode&&(d.anchorNode.get("innerHTML")==="&nbsp;")){d.anchorNode.setStyle("backgroundColor",g);h=d.anchorNode;}else{h=this.command("inserthtml",'<span style="background-color: '+g+'">'+e.Selection.CURSOR+"</span>");d.focusCursor(true,true);}return h;}else{return this._command(f,g);}}else{this._command(f,g);}},hilitecolor:function(){return a.COMMANDS.backcolor.apply(this,arguments);},fontname:function(f,g){this._command("fontname",g);var e=this.getInstance(),d=new e.Selection();if(d.isCollapsed&&(this._lastKey!=32)){if(d.anchorNode.test("font")){d.anchorNode.set("face",g);}}},fontsize:function(f,h){this._command("fontsize",h);var e=this.getInstance(),d=new e.Selection();if(d.isCollapsed&&d.anchorNode&&(this._lastKey!=32)){if(b.UA.webkit){if(d.anchorNode.getStyle("lineHeight")){d.anchorNode.setStyle("lineHeight","");}}if(d.anchorNode.test("font")){d.anchorNode.set("size",h);}else{if(b.UA.gecko){var g=d.anchorNode.ancestor(e.Selection.DEFAULT_BLOCK_TAG);if(g){g.setStyle("fontSize","");}}}}}}});var c=function(j,v,r){var k=this.getInstance(),t=k.config.doc,h=t.selection.createRange(),g=t.queryCommandValue(j),l,f,i,e,n,u,q;if(g){l=h.htmlText;f=new RegExp(r,"g");i=l.match(f);if(i){l=l.replace(r+";","").replace(r,"");h.pasteHTML('<var id="yui-ie-bs">');e=t.getElementById("yui-ie-bs");n=t.createElement("div");u=t.createElement(v);n.innerHTML=l;if(e.parentNode!==k.config.doc.body){e=e.parentNode;}q=n.childNodes;e.parentNode.replaceChild(u,e);b.each(q,function(d){u.appendChild(d);});h.collapse();h.moveToElementText(u);h.select();}}this._command(j);};if(b.UA.ie){a.COMMANDS.bold=function(){c.call(this,"bold","b","FONT-WEIGHT: bold");};a.COMMANDS.italic=function(){c.call(this,"italic","i","FONT-STYLE: italic");};a.COMMANDS.underline=function(){c.call(this,"underline","u","TEXT-DECORATION: underline");};}b.namespace("Plugin");b.Plugin.ExecCommand=a;},"@VERSION@",{skinnable:false,requires:["frame"]});YUI.add("editor-tab",function(c){var b=function(){b.superclass.constructor.apply(this,arguments);},a="host";c.extend(b,c.Base,{_onNodeChange:function(f){var d="indent";if(f.changedType==="tab"){if(!f.changedNode.test("li, li *")){f.changedEvent.halt();f.preventDefault();if(f.changedEvent.shiftKey){d="outdent";}this.get(a).execCommand(d,"");}}},initializer:function(){this.get(a).on("nodeChange",c.bind(this._onNodeChange,this));}},{NAME:"editorTab",NS:"tab",ATTRS:{host:{value:false}}});c.namespace("Plugin");c.Plugin.EditorTab=b;},"@VERSION@",{skinnable:false,requires:["editor-base"]});
YUI.add("createlink-base",function(b){var a={};a.STRINGS={PROMPT:"Please enter the URL for the link to point to:",DEFAULT:"http://"};b.namespace("Plugin");b.Plugin.CreateLinkBase=a;b.mix(b.Plugin.ExecCommand.COMMANDS,{createlink:function(i){var h=this.get("host").getInstance(),e,c,g,f,d=prompt(a.STRINGS.PROMPT,a.STRINGS.DEFAULT);if(d){f=h.config.doc.createElement("div");d=h.config.doc.createTextNode(d);f.appendChild(d);d=f.innerHTML;this.get("host")._execCommand(i,d);g=new h.Selection();e=g.getSelected();if(!g.isCollapsed&&e.size()){c=e.item(0).one("a");if(c){e.item(0).replace(c);}if(b.UA.gecko){if(c.get("parentNode").test("span")){if(c.get("parentNode").one("br.yui-cursor")){c.get("parentNode").insert(c,"before");}}}}else{this.get("host").execCommand("inserthtml",'<a href="'+d+'">'+d+"</a>");}}return c;}});},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-base",function(d){var c=function(){c.superclass.constructor.apply(this,arguments);},b=":last-child",a="body";d.extend(c,d.Base,{frame:null,initializer:function(){var e=new d.Frame({designMode:true,title:c.STRINGS.title,use:c.USE,dir:this.get("dir"),extracss:this.get("extracss"),linkedcss:this.get("linkedcss"),defaultblock:this.get("defaultblock"),host:this}).plug(d.Plugin.ExecCommand);e.after("ready",d.bind(this._afterFrameReady,this));e.addTarget(this);this.frame=e;this.publish("nodeChange",{emitFacade:true,bubbles:true,defaultFn:this._defNodeChangeFn});},destructor:function(){this.frame.destroy();this.detachAll();},copyStyles:function(h,g){if(h.test("a")){return;}var e=["color","fontSize","fontFamily","backgroundColor","fontStyle"],f={};d.each(e,function(i){f[i]=h.getStyle(i);});if(h.ancestor("b,strong")){f.fontWeight="bold";}if(h.ancestor("u")){if(!f.textDecoration){f.textDecoration="underline";}}g.setStyles(f);},_lastBookmark:null,_resolveChangedNode:function(i){var h=this.getInstance(),f,e,g;if(h&&i&&i.test("html")){f=h.one(a).one(b);while(!g){if(f){e=f.one(b);if(e){f=e;}else{g=true;}}else{g=true;}}if(f){if(f.test("br")){if(f.previous()){f=f.previous();}else{f=f.get("parentNode");}}if(f){i=f;}}}return i;},_defNodeChangeFn:function(s){var j=(new Date()).getTime();var q=this.getInstance(),i,t,p=q.Selection.DEFAULT_BLOCK_TAG;if(d.UA.ie){try{i=q.config.doc.selection.createRange();if(i.getBookmark){this._lastBookmark=i.getBookmark();}}catch(g){}}s.changedNode=this._resolveChangedNode(s.changedNode);switch(s.changedType){case"keydown":if(!d.UA.gecko){if(!c.NC_KEYS[s.changedEvent.keyCode]&&!s.changedEvent.shiftKey&&!s.changedEvent.ctrlKey&&(s.changedEvent.keyCode!==13)){}}break;case"tab":if(!s.changedNode.test("li, li *")&&!s.changedEvent.shiftKey){s.changedEvent.frameEvent.preventDefault();if(d.UA.webkit){this.execCommand("inserttext","\t");}else{if(d.UA.gecko){this.frame.exec._command("inserthtml","<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>");}else{if(d.UA.ie){i=new q.Selection();i._selection.pasteHTML(c.TABKEY);}}}}break;}if(d.UA.webkit&&s.commands&&(s.commands.indent||s.commands.outdent)){var u=q.all(".webkit-indent-blockquote");if(u.size()){u.setStyle("margin","");}}var o=this.getDomPath(s.changedNode,false),f={},n,h,l=[],m="",k="";if(s.commands){f=s.commands;}d.each(o,function(z){var v=z.tagName.toLowerCase(),A=c.TAG2CMD[v];if(A){f[A]=1;}var y=z.currentStyle||z.style;if((""+y.fontWeight)=="bold"){f.bold=1;}if(d.UA.ie){if(y.fontWeight>400){f.bold=1;}}if(y.fontStyle=="italic"){f.italic=1;}if(y.textDecoration=="underline"){f.underline=1;}if(y.textDecoration=="line-through"){f.strikethrough=1;}var B=q.one(z);if(B.getStyle("fontFamily")){var x=B.getStyle("fontFamily").split(",")[0].toLowerCase();if(x){n=x;}if(n){n=n.replace(/'/g,"").replace(/"/g,"");}}h=c.NORMALIZE_FONTSIZE(B);var w=z.className.split(" ");d.each(w,function(C){if(C!==""&&(C.substr(0,4)!=="yui_")){l.push(C);}});m=c.FILTER_RGB(B.getStyle("color"));var e=c.FILTER_RGB(y.backgroundColor);if(e!=="transparent"){if(e!==""){k=e;}}});s.dompath=q.all(o);s.classNames=l;s.commands=f;if(!s.fontFamily){s.fontFamily=n;}if(!s.fontSize){s.fontSize=h;}if(!s.fontColor){s.fontColor=m;}if(!s.backgroundColor){s.backgroundColor=k;}var r=(new Date()).getTime();},getDomPath:function(g,e){var i=[],f,h=this.frame.getInstance();f=h.Node.getDOMNode(g);while(f!==null){if((f===h.config.doc.documentElement)||(f===h.config.doc)||!f.tagName){f=null;break;}if(!h.DOM.inDoc(f)){f=null;break;}if(f.nodeName&&f.nodeType&&(f.nodeType==1)){i.push(f);}if(f==h.config.doc.body){f=null;break;}f=f.parentNode;}if(i.length===0){i[0]=h.config.doc.body;}if(e){return h.all(i.reverse());}else{return i.reverse();}},_afterFrameReady:function(){var e=this.frame.getInstance();this.frame.on("dom:mouseup",d.bind(this._onFrameMouseUp,this));this.frame.on("dom:mousedown",d.bind(this._onFrameMouseDown,this));this.frame.on("dom:keydown",d.bind(this._onFrameKeyDown,this));if(d.UA.ie){this.frame.on("dom:activate",d.bind(this._onFrameActivate,this));this.frame.on("dom:beforedeactivate",d.bind(this._beforeFrameDeactivate,this));}this.frame.on("dom:keyup",d.bind(this._onFrameKeyUp,this));this.frame.on("dom:keypress",d.bind(this._onFrameKeyPress,this));e.Selection.filter();this.fire("ready");},_beforeFrameDeactivate:function(){var f=this.getInstance(),e=f.config.doc.selection.createRange();if((!e.compareEndPoints("StartToEnd",e))){e.pasteHTML('<var id="yui-ie-cursor">');}},_onFrameActivate:function(){var g=this.getInstance(),f=new g.Selection(),e=f.createRange(),h=g.all("#yui-ie-cursor");if(h.size()){h.each(function(i){i.set("id","");e.moveToElementText(i._node);e.move("character",-1);e.move("character",1);e.select();e.text="";i.remove();});}},_onFrameMouseUp:function(f){this.fire("nodeChange",{changedNode:f.frameTarget,changedType:"mouseup",changedEvent:f.frameEvent});},_onFrameMouseDown:function(f){this.fire("nodeChange",{changedNode:f.frameTarget,changedType:"mousedown",changedEvent:f.frameEvent});},_currentSelection:null,_currentSelectionTimer:null,_currentSelectionClear:null,_onFrameKeyDown:function(h){var g,f;
if(!this._currentSelection){if(this._currentSelectionTimer){this._currentSelectionTimer.cancel();}this._currentSelectionTimer=d.later(850,this,function(){this._currentSelectionClear=true;});g=this.frame.getInstance();f=new g.Selection(h);this._currentSelection=f;}else{f=this._currentSelection;}g=this.frame.getInstance();f=new g.Selection();this._currentSelection=f;if(f&&f.anchorNode){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:"keydown",changedEvent:h.frameEvent});if(c.NC_KEYS[h.keyCode]){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:c.NC_KEYS[h.keyCode],changedEvent:h.frameEvent});this.fire("nodeChange",{changedNode:f.anchorNode,changedType:c.NC_KEYS[h.keyCode]+"-down",changedEvent:h.frameEvent});}}},_onFrameKeyPress:function(g){var f=this._currentSelection;if(f&&f.anchorNode){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:"keypress",changedEvent:g.frameEvent});if(c.NC_KEYS[g.keyCode]){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:c.NC_KEYS[g.keyCode]+"-press",changedEvent:g.frameEvent});}}},_onFrameKeyUp:function(g){var f=this._currentSelection;if(f&&f.anchorNode){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:"keyup",selection:f,changedEvent:g.frameEvent});if(c.NC_KEYS[g.keyCode]){this.fire("nodeChange",{changedNode:f.anchorNode,changedType:c.NC_KEYS[g.keyCode]+"-up",selection:f,changedEvent:g.frameEvent});}}if(this._currentSelectionClear){this._currentSelectionClear=this._currentSelection=null;}},execCommand:function(j,l){var g=this.frame.execCommand(j,l),i=this.frame.getInstance(),h=new i.Selection(),f={},k={changedNode:h.anchorNode,changedType:"execcommand",nodes:g};switch(j){case"forecolor":k.fontColor=l;break;case"backcolor":k.backgroundColor=l;break;case"fontsize":k.fontSize=l;break;case"fontname":k.fontFamily=l;break;}f[j]=1;k.commands=f;this.fire("nodeChange",k);return g;},getInstance:function(){return this.frame.getInstance();},render:function(e){this.frame.set("content",this.get("content"));this.frame.render(e);return this;},focus:function(e){this.frame.focus(e);return this;},show:function(){this.frame.show();return this;},hide:function(){this.frame.hide();return this;},getContent:function(){var e="",f=this.getInstance();if(f&&f.Selection){e=f.Selection.unfilter();}e=e.replace(/ _yuid="([^>]*)"/g,"");return e;}},{NORMALIZE_FONTSIZE:function(g){var e=g.getStyle("fontSize"),f=e;switch(e){case"-webkit-xxx-large":e="48px";break;case"xx-large":e="32px";break;case"x-large":e="24px";break;case"large":e="18px";break;case"medium":e="16px";break;case"small":e="13px";break;case"x-small":e="10px";break;}if(f!==e){g.setStyle("fontSize",e);}return e;},TABKEY:'<span class="tab">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>',FILTER_RGB:function(h){if(h.toLowerCase().indexOf("rgb")!=-1){var k=new RegExp("(.*?)rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)(.*?)","gi");var f=h.replace(k,"$1,$2,$3,$4,$5").split(",");if(f.length==5){var j=parseInt(f[1],10).toString(16);var i=parseInt(f[2],10).toString(16);var e=parseInt(f[3],10).toString(16);j=j.length==1?"0"+j:j;i=i.length==1?"0"+i:i;e=e.length==1?"0"+e:e;h="#"+j+i+e;}}return h;},TAG2CMD:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},NC_KEYS:{8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete"},USE:["substitute","node","selector-css3","selection","stylesheet"],NAME:"editorBase",STRINGS:{title:"Rich Text Editor"},ATTRS:{content:{value:'<br class="yui-cursor">',setter:function(e){if(e.substr(0,1)==="\n"){e=e.substr(1);}if(e===""){e='<br class="yui-cursor">';}if(e===" "){if(d.UA.gecko){e='<br class="yui-cursor">';}}return this.frame.set("content",e);},getter:function(){return this.frame.get("content");}},dir:{writeOnce:true,value:"ltr"},linkedcss:{value:"",setter:function(e){if(this.frame){this.frame.set("linkedcss",e);}return e;}},extracss:{value:false,setter:function(e){if(this.frame){this.frame.set("extracss",e);}return e;}},defaultblock:{value:"p"}}});d.EditorBase=c;},"@VERSION@",{skinnable:false,requires:["base","frame","node","exec-command","selection"]});YUI.add("editor-lists",function(f){var e=function(){e.superclass.constructor.apply(this,arguments);},b="li",c="ol",d="ul",a="host";f.extend(e,f.Base,{_onNodeChange:function(l){var j=this.get(a).getInstance(),g,o,p,h,i,m,n=false,q,k=false;if(f.UA.ie&&l.changedType==="enter"){if(l.changedNode.test(b+", "+b+" *")){l.changedEvent.halt();l.preventDefault();o=l.changedNode;p=j.Node.create("<"+b+">"+e.NON+"</"+b+">");if(!o.test(b)){o=o.ancestor(b);}o.insert(p,"after");g=new j.Selection();g.selectNode(p.get("firstChild"),true,false);}}if(l.changedType==="tab"){if(l.changedNode.test(b+", "+b+" *")){l.changedEvent.halt();l.preventDefault();o=l.changedNode;i=l.changedEvent.shiftKey;m=o.ancestor(c+","+d);q=d;if(m.get("tagName").toLowerCase()===c){q=c;}if(!o.test(b)){o=o.ancestor(b);}if(i){if(o.ancestor(b)){o.ancestor(b).insert(o,"after");n=true;k=true;}}else{if(o.previous(b)){h=j.Node.create("<"+q+"></"+q+">");o.previous(b).append(h);h.append(o);n=true;}}}if(n){if(!o.test(b)){o=o.ancestor(b);}o.all(e.REMOVE).remove();if(f.UA.ie){o=o.append(e.NON).one(e.NON_SEL);}(new j.Selection()).selectNode(o,true,k);}}},initializer:function(){this.get(a).on("nodeChange",f.bind(this._onNodeChange,this));}},{NON:'<span class="yui-non">&nbsp;</span>',NON_SEL:"span.yui-non",REMOVE:"br",NAME:"editorLists",NS:"lists",ATTRS:{host:{value:false}}});f.namespace("Plugin");f.Plugin.EditorLists=e;f.mix(f.Plugin.ExecCommand.COMMANDS,{insertunorderedlist:function(i){var h=this.get("host").getInstance(),g;this.get("host")._execCommand(i,"");},insertorderedlist:function(i){var h=this.get("host").getInstance(),g;this.get("host")._execCommand(i,"");}});},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-bidi",function(h){var g=function(){g.superclass.constructor.apply(this,arguments);
},c="host",b="dir",d="BODY",a="nodeChange",f="bidiContextChange",e=d+" > p";h.extend(g,h.Base,{lastDirection:null,firstEvent:null,_checkForChange:function(){var j=this.get(c),l=j.getInstance(),k=new l.Selection(),i,m;if(k.isCollapsed){i=g.blockParent(k.focusNode);m=i.getStyle("direction");if(m!==this.lastDirection){j.fire(f,{changedTo:m});this.lastDirection=m;}}else{j.fire(f,{changedTo:"select"});this.lastDirection=null;}},_afterNodeChange:function(i){if(this.firstEvent||g.EVENTS[i.changedType]){this._checkForChange();this.firstEvent=false;}},_afterMouseUp:function(i){this._checkForChange();this.firstEvent=false;},initializer:function(){var i=this.get(c);this.firstEvent=true;i.after(a,h.bind(this._afterNodeChange,this));i.after("dom:mouseup",h.bind(this._afterMouseUp,this));}},{EVENTS:{"backspace-up":true,"pageup-up":true,"pagedown-down":true,"end-up":true,"home-up":true,"left-up":true,"up-up":true,"right-up":true,"down-up":true,"delete-up":true},BLOCKS:h.Selection.BLOCKS+",LI,HR,"+d,DIV_WRAPPER:"<DIV></DIV>",blockParent:function(k,j){var i=k,m,l;if(!i){i=h.one(d);}if(!i.test(g.BLOCKS)){i=i.ancestor(g.BLOCKS);}if(j&&i.test(d)){m=h.Node.create(g.DIV_WRAPPER);i.get("children").each(function(o,n){if(n===0){l=o;}else{m.append(o);}});l.replace(m);m.prepend(l);i=m;}return i;},_NODE_SELECTED:"bidiSelected",addParents:function(m){var j,l,k;for(j=0;j<m.length;j+=1){m[j].setData(g._NODE_SELECTED,true);}for(j=0;j<m.length;j+=1){l=m[j].get("parentNode");if(!l.test(d)&&!l.getData(g._NODE_SELECTED)){k=true;l.get("children").some(function(i){if(!i.getData(g._NODE_SELECTED)){k=false;return true;}});if(k){m.push(l);l.setData(g._NODE_SELECTED,true);}}}for(j=0;j<m.length;j+=1){m[j].clearData(g._NODE_SELECTED);}return m;},NAME:"editorBidi",NS:"editorBidi",ATTRS:{host:{value:false}}});h.namespace("Plugin");h.Plugin.EditorBidi=g;h.Plugin.ExecCommand.COMMANDS.bidi=function(l,p){var o=this.getInstance(),j=new o.Selection(),i,m,n,q,k;o.Selection.filterBlocks();if(j.isCollapsed){m=g.blockParent(j.anchorNode);if(!p){k=m.getAttribute(b);if(!k||k=="ltr"){p="rtl";}else{p="ltr";}}m.setAttribute(b,p);i=m;}else{n=j.getSelected();q=[];n.each(function(r){q.push(g.blockParent(r));});q=o.all(g.addParents(q));q.setAttribute(b,p);i=q;}this.get(c).get(c).editorBidi._checkForChange();return i;};},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-para",function(a){var d=function(){d.superclass.constructor.apply(this,arguments);},k="host",f="body",c="nodeChange",j="parentNode",b=f+" > p",h="p",g="<br>",i="firstChild",e="li";a.extend(d,a.Base,{_fixFirstPara:function(){var l=this.get(k),o=l.getInstance(),m;o.one("body").set("innerHTML","<"+h+">"+o.Selection.CURSOR+"</"+h+">");var p=o.one(b);m=new o.Selection();m.selectNode(p,true,false);},_onNodeChange:function(R){var G=this.get(k),r=G.getInstance(),y,E,D,T,O,I=r.Selection.DEFAULT_BLOCK_TAG,A,o,u,P,w,l,H,M,v,N,V,S,K,C,B,Q=":last-child";switch(R.changedType){case"enter-up":var m=((this._lastPara)?this._lastPara:R.changedNode),U=m.one("br.yui-cursor");if(this._lastPara){delete this._lastPara;}if(U){if(U.previous()||U.next()){U.remove();}}if(!m.test(I)){var F=m.ancestor(I);if(F){m=F;F=null;}}if(m.test(I)){var J=m.previous(),L,x,z=false;if(J){L=J.one(Q);while(!z){if(L){x=L.one(Q);if(x){L=x;}else{z=true;}}else{z=true;}}if(L){G.copyStyles(L,m);}}}break;case"enter":if(a.UA.webkit){if(R.changedEvent.shiftKey){G.execCommand("insertbr");R.changedEvent.preventDefault();}}if(a.UA.gecko&&G.get("defaultblock")!=="p"){D=R.changedNode;if(!D.test(e)&&!D.ancestor(e)){if(!D.test(I)){D=D.ancestor(I);}T=r.Node.create("<"+I+"></"+I+">");D.insert(T,"after");O=new r.Selection();if(O.anchorOffset){A=O.anchorNode.get("textContent");E=r.one(r.config.doc.createTextNode(A.substr(0,O.anchorOffset)));o=r.one(r.config.doc.createTextNode(A.substr(O.anchorOffset)));P=O.anchorNode;P.setContent("");l=P.cloneNode();l.append(o);H=false;v=P;while(!H){v=v.get(j);if(v&&!v.test(I)){M=v.cloneNode();M.set("innerHTML","");M.append(l);u=v.get("childNodes");var s=false;u.each(function(n){if(s){M.append(n);}if(n===P){s=true;}});P=v;l=M;}else{H=true;}}o=l;O.anchorNode.append(E);if(o){T.append(o);}}if(T.get(i)){T=T.get(i);}T.prepend(r.Selection.CURSOR);O.focusCursor(true,true);y=r.Selection.getText(T);if(y!==""){r.Selection.cleanCursor();}R.changedEvent.preventDefault();}}break;case"keydown":if(r.config.doc.childNodes.length<2){var q=r.config.doc.body.innerHTML;if(q&&q.length<5&&q.toLowerCase()==g){this._fixFirstPara();}}break;case"backspace-up":case"backspace-down":case"delete-up":if(!a.UA.ie){N=r.all(b);S=r.one(f);if(N.item(0)){S=N.item(0);}V=S.one("br");if(V){V.removeAttribute("id");V.removeAttribute("class");}E=r.Selection.getText(S);E=E.replace(/ /g,"").replace(/\n/g,"");C=S.all("img");if(E.length===0&&!C.size()){if(!S.test(h)){this._fixFirstPara();}K=null;if(R.changedNode&&R.changedNode.test(h)){K=R.changedNode;}if(!K&&G._lastPara&&G._lastPara.inDoc()){K=G._lastPara;}if(K&&!K.test(h)){K=K.ancestor(h);}if(K){if(!K.previous()&&K.get(j)&&K.get(j).test(f)){R.changedEvent.frameEvent.halt();}}}if(a.UA.webkit){if(R.changedNode){S=R.changedNode;if(S.test("li")&&(!S.previous()&&!S.next())){y=S.get("innerHTML").replace(g,"");if(y===""){if(S.get(j)){S.get(j).replace(r.Node.create(g));R.changedEvent.frameEvent.halt();R.preventDefault();r.Selection.filterBlocks();}}}}}}if(a.UA.gecko){T=R.changedNode;B=r.config.doc.createTextNode(" ");T.appendChild(B);T.removeChild(B);}break;}if(a.UA.gecko){if(R.changedNode&&!R.changedNode.test(I)){var K=R.changedNode.ancestor(I);if(K){this._lastPara=K;}}}},_afterEditorReady:function(){var m=this.get(k),n=m.getInstance(),l;if(n){n.Selection.filterBlocks();l=n.Selection.DEFAULT_BLOCK_TAG;b=f+" > "+l;h=l;}},_afterContentChange:function(){var l=this.get(k),m=l.getInstance();if(m&&m.Selection){m.Selection.filterBlocks();}},_afterPaste:function(){var l=this.get(k),n=l.getInstance(),m=new n.Selection();a.later(50,l,function(){n.Selection.filterBlocks();});},initializer:function(){var l=this.get(k);
if(l.editorBR){a.error("Can not plug EditorPara and EditorBR at the same time.");return;}l.on(c,a.bind(this._onNodeChange,this));l.after("ready",a.bind(this._afterEditorReady,this));l.after("contentChange",a.bind(this._afterContentChange,this));if(a.Env.webkit){l.after("dom:paste",a.bind(this._afterPaste,this));}}},{NAME:"editorPara",NS:"editorPara",ATTRS:{host:{value:false}}});a.namespace("Plugin");a.Plugin.EditorPara=d;},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor-br",function(c){var d=function(){d.superclass.constructor.apply(this,arguments);},a="host",b="li";c.extend(d,c.Base,{_onKeyDown:function(j){if(j.stopped){j.halt();return;}if(j.keyCode==13){var g=this.get(a),i=g.getInstance(),h=new i.Selection(),f="";if(h){if(c.UA.ie){if(!h.anchorNode||(!h.anchorNode.test(b)&&!h.anchorNode.ancestor(b))){h._selection.pasteHTML("<br>");h._selection.collapse(false);h._selection.select();j.halt();}}if(c.UA.webkit){if(!h.anchorNode.test(b)&&!h.anchorNode.ancestor(b)){g.frame._execCommand("insertlinebreak",null);j.halt();}}}}},_afterEditorReady:function(){var e=this.get(a).getInstance();try{e.config.doc.execCommand("insertbronreturn",null,true);}catch(f){}if(c.UA.ie||c.UA.webkit){e.on("keydown",c.bind(this._onKeyDown,this),e.config.doc);}},_onNodeChange:function(h){switch(h.changedType){case"backspace-up":case"backspace-down":case"delete-up":var g=this.get(a).getInstance();var i=h.changedNode;var f=g.config.doc.createTextNode(" ");i.appendChild(f);i.removeChild(f);break;}},initializer:function(){var e=this.get(a);if(e.editorPara){c.error("Can not plug EditorBR and EditorPara at the same time.");return;}e.after("ready",c.bind(this._afterEditorReady,this));if(c.UA.gecko){e.on("nodeChange",c.bind(this._onNodeChange,this));}}},{NAME:"editorBR",NS:"editorBR",ATTRS:{host:{value:false}}});c.namespace("Plugin");c.Plugin.EditorBR=d;},"@VERSION@",{skinnable:false,requires:["editor-base"]});YUI.add("editor",function(a){},"@VERSION@",{use:["frame","selection","exec-command","editor-base","editor-para","editor-br","editor-bidi","createlink-base"],skinnable:false});