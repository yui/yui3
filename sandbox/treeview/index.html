<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>TreeView</title>
<!-- CSS -->
<link rel="stylesheet" type="text/css" href="../../build/cssfonts/fonts-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssreset/reset-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssgrids/grids-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssbase/base-min.css">
<link rel="stylesheet" type="text/css" href="../../build/widget/assets/skins/sam/widget.css" />
<!-- JS -->
<script type="text/javascript" src="../../build/yui/yui.js"></script>

<link rel="stylesheet" type="text/css" href="../../src/treeview/assets/skins/sam/treeview-skin.css">
<script type="text/javascript" src="../../build/treeview/treeview-debug.js"></script>
<!--script type="text/javascript" src="treenode-ES-es.js"></script-->
				
<style type="text/css">


</style>
</head>
<body class="yui-skin-sam">
	<div class="yui-d1"> 
		<div id="hd">
			<h1>TreeView</h1>

		</div>
		<div id="bd" class="pepe">
		</div>
		<hr/>
		<div id="markup">
			<ul>
				<li class="expanded">List 0
					<ul>
						<li class="expanded">List 0-0
							<ul>
								<li>item 0-0-0</li>
								<li><a target="_new" href="www.elsewhere.com" title="go elsewhere">elsewhere</a></li>
							</ul>
						</li>
					</ul>
				</li>
				<li>List 1
					<ul>
						<li>List 1-0
							<ul>
								<li yuiConfig='{"type":"DateNode","editable":true}'>02/01/2009</li>
								<li><span>item <strong>1-1-0</strong></span></li>
							</ul>
						</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
<script  type="text/javascript">
YUI({combine:false,filter:'raw', base:"../../build/", debug:true, useBrowserConsole:true}).use('treeview','test','console',function(Y) {

	
	var tv, PARENT 		= 'parent',
			PREVIOUS	= 'previousSibling',
			NEXT 		= 'nextSibling',
			ROOT		= 'root',
			CONTENT		= 'content',
			A = Y.Assert;

	Y.on('domready', function () {

		//var yconsole = new Y.Console(); 
		//yconsole.render(); 
		
		var rel = function (tv,msg) {
			console.log('---------'+msg+'-------------');
			console.log('me',tv);
			console.log(PARENT,tv._conf.data.value.parent);
			console.log(ROOT,tv._conf.data.value.root);
			console.log(PREVIOUS,tv._conf.data.value.previousSibling);
			console.log(NEXT,tv._conf.data.value.nextSibling);
			console.log('children',tv._children);
		}

		var testCase = new Y.Test.Case({

			name: 'Relationships',
			setUp:function() {
				console.log('setUp');
				tv = new Y.TreeView();
			},
			tearDown :function() {
				console.log('tearDown');
				tv.destroy();
				Y.get('#bd').set('innerHTML','');
			},
			testSingleNode: function () {
				console.log('testSingleNode');
				tv.set('content','testSingleNode');
				tv.render('#bd');
				A.isInstanceOf(Y.TreeNode,tv,'tv should be a TreeNode');
				A.isNull(tv.get(PARENT),'parent should be null');
				A.areSame(tv,tv.get(ROOT),'root should be its own root');
				A.isNull(tv.get(NEXT),'tree should have no next sibling');
				A.isNull(tv.get(PREVIOUS),'tree should have no previous sibling');
				A.isArray(tv._children,'children should be an array');
				A.areEqual(0,tv._children.length,'children should contain zero elements');
			},
			testFatherChild:function() {
				console.log('testFatherChild');
				tv.set('content','testFatherChild');
				var tn = new Y.TreeNode({parent:tv});
				tv.render('#bd');
				A.isInstanceOf(Y.TreeNode,tv,'tv should be a TreeNode');
				A.isNull(tv.get(PARENT),'parent should be null');
				A.areSame(tv,tv.get(ROOT),'root should be its own root');
				A.isNull(tv.get(NEXT),'tree should have no next sibling');
				A.isNull(tv.get(PREVIOUS),'tree should have no previous sibling');
				A.isArray(tv._children,'children should be an array');
				A.areEqual(1,tv._children.length,'children should contain one element');
				A.areSame(tv._children[0],tn,'tv should have tn as child');
				
				A.isInstanceOf(Y.TreeNode,tn,'tn should be a TreeNode');
				A.areSame(tn.get(PARENT),tv,'parent should be null');
				A.areSame(tv,tn.get(ROOT),'root should be its parent');
				A.isNull(tn.get(NEXT),'tree should have no next sibling');
				A.isNull(tn.get(PREVIOUS),'tree should have no previous sibling');
				A.isArray(tn._children,'children should be an array');
				A.areEqual(0,tn._children.length,'children should contain no elements');
			},
			testFatherWithChildAdded:function() {
				console.log('testFatherWithChildAdded');
				tv.set('content','testFatherWithChildAdded');
				tv.render('#bd');
				var tn = new Y.TreeNode({parent:tv});
				A.isInstanceOf(Y.TreeNode,tv,'tv should be a TreeNode');
				A.isNull(tv.get(PARENT),'parent should be null');
				A.areSame(tv,tv.get(ROOT),'root should be its own root');
				A.isNull(tv.get(NEXT),'tree should have no next sibling');
				A.isNull(tv.get(PREVIOUS),'tree should have no previous sibling');
				A.isArray(tv._children,'children should be an array');
				A.areEqual(1,tv._children.length,'children should contain one element');
				A.areSame(tv._children[0],tn,'tv should have tn as child');
				
				A.isInstanceOf(Y.TreeNode,tn,'tn should be a TreeNode');
				A.areSame(tn.get(PARENT),tv,'parent should be null');
				A.areSame(tv,tn.get(ROOT),'root should be its parent');
				A.isNull(tn.get(NEXT),'tree should have no next sibling');
				A.isNull(tn.get(PREVIOUS),'tree should have no previous sibling');
				A.isArray(tn._children,'children should be an array');
				A.areEqual(0,tn._children.length,'children should contain no elements');
			},
			testAddingBySibling:function() {
				console.log('testAddingBySibling');
				tv.set('content','testAddingBySibling');
				var t2 = new Y.TreeNode({parent:tv});
				var t1 = new Y.TreeNode({nextSibling:t2});
				var t3 = new Y.TreeNode({previousSibling:t2});
				tv.render('#bd');
				
				A.areEqual(3,tv._children.length,'tree should have three branches');
				A.areSame(tv._children[0],t1,'t1 should be the first');
				A.areSame(tv._children[1],t2,'t2 should be in the middle');
				A.areSame(tv._children[2],t3,'t3 should be the last');
				
				A.areSame(t1.get(PARENT),tv,'tv should be parent of t1');
				A.areSame(t1.get(ROOT),tv,'tv should be the root of t1');
				A.areSame(t2.get(PARENT),tv,'tv should be parent of t2');
				A.areSame(t2.get(ROOT),tv,'tv should be the root of t2');
				A.areSame(t3.get(PARENT),tv,'tv should be parent of t3');
				A.areSame(t3.get(ROOT),tv,'tv should be the root of t3');
				A.areSame(t2,t1.get(NEXT),'t2 should be the next sibling of t1');
				A.areSame(t3,t2.get(NEXT),'t3 should be the next sibling of t2');
				A.isNull(t3.get(NEXT),'t3 should have no next');
				A.isNull(t1.get(PREVIOUS),'t1 should have no previous');
				A.areSame(t1,t2.get(PREVIOUS),'t1 should be the previous sibling of t2');
				A.areSame(t2,t3.get(PREVIOUS),'t2 should be the previous sibling of t3');
				
				
			},
			testAddingByParentSibling:function() {
				console.log('testAddingBySibling');
				tv.set('content','testAddingBySibling');
				var t1 = new Y.TreeNode({parent:tv});
				var t2 = new Y.TreeNode({parent:tv});
				var t3 = new Y.TreeNode({parent:tv});
				tv.render('#bd');
				
				A.areEqual(3,tv._children.length,'tree should have three branches');
				A.areSame(tv._children[0],t1,'t1 should be the first');
				A.areSame(tv._children[1],t2,'t2 should be in the middle');
				A.areSame(tv._children[2],t3,'t3 should be the last');
				
				A.areSame(t1.get(PARENT),tv,'tv should be parent of t1');
				A.areSame(t1.get(ROOT),tv,'tv should be the root of t1');
				A.areSame(t2.get(PARENT),tv,'tv should be parent of t2');
				A.areSame(t2.get(ROOT),tv,'tv should be the root of t2');
				A.areSame(t3.get(PARENT),tv,'tv should be parent of t3');
				A.areSame(t3.get(ROOT),tv,'tv should be the root of t3');
				A.areSame(t2,t1.get(NEXT),'t2 should be the next sibling of t1');
				A.areSame(t3,t2.get(NEXT),'t3 should be the next sibling of t2');
				A.isNull(t3.get(NEXT),'t3 should have no next');
				A.isNull(t1.get(PREVIOUS),'t1 should have no previous');
				A.areSame(t1,t2.get(PREVIOUS),'t1 should be the previous sibling of t2');
				A.areSame(t2,t3.get(PREVIOUS),'t2 should be the previous sibling of t3');
				
				
			},
			testMoveNode: function () {
				console.log('testMoveNode');
				tv.set('content','testMoveNode');
				var t1 = new Y.TreeNode({parent:tv, content:'t1'});
				var t2 = new Y.TreeNode({previousSibling:t1, content:'t2'});
				var t3 = new Y.TreeNode({previousSibling:t2, content:'t3'});
				tv.render('#bd');
				A.areSame(tv._children[0],t1,'t1 should be the first');
				A.areSame(tv._children[1],t2,'t2 should be in the middle');
				A.areSame(tv._children[2],t3,'t3 should be the last');
				
				A.areSame(t2,t1.get(NEXT),'t2 should be the next sibling of t1');
				A.areSame(t3,t2.get(NEXT),'t3 should be the next sibling of t2');
				A.isNull(t3.get(NEXT),'t3 should have no next');
				A.isNull(t1.get(PREVIOUS),'t1 should have no previous');
				A.areSame(t1,t2.get(PREVIOUS),'t1 should be the previous sibling of t2');
				A.areSame(t2,t3.get(PREVIOUS),'t2 should be the previous sibling of t3');
				
				t2.set(PARENT,t1);
	
				A.areSame(tv._children[0],t1,'t1 should be the first');
				A.areSame(tv._children[1],t3,'t3 should be in the middle');
				A.areSame(t1._children[0],t2,'t2 should be the last');
			}

		});
		Y.Test.Runner.add(testCase);
		

switch (3) {
	case 1:
		Y.Test.Runner.run();
		break;
	case 2:
		tv = new Y.TreeView({contentBox:'#markup'});
		tv.render();
		break;
	case 3:	
		var makeBranch = function (parent,label) {
			var n = Math.random() * 5 - 1;
			if (label.length > 10) return;
			for (var i = 0;i < n;i++) {
				var tmpNode = new Y.TreeNode({content:label + '-' + i, parent:parent,expanded:Math.random() > .5});
				makeBranch(tmpNode,label + '-' + i);
			}
		}
		tv = new Y.TreeView({content:"primero"});
		makeBranch(tv,'label');
		tv.render('#bd');
		tv.on('treenode:click',function(ev) {
			console.log('treenode:click',ev);
			ev.preventDefault();
		});
		break;
			
//		tv.destroy();
}
		
	});
});
</script>
</body>
</html>
	