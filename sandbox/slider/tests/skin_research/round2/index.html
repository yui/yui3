<!doctype html>
<html>
<head>
    <title>Test Page</title>
    <style type="text/css">

        .dark {
            background: #000;
            color: #fff;
        }

        fieldset {
            margin-bottom: 2em;
        }

        .selected {
            background: #cde;
        }

        #x p {
            position: absolute;
            top: -10px;
            left: 100px;
            overflow: hidden;
            width: 50px;
            height: 40px;
            margin: 0;
        }

        #y p {
            position: absolute;
            top: 100px;
            left: -10px;
            overflow: hidden;
            height: 50px;
            width: 40px;
            margin: 0;
        }

        #x p .shadow {
            position: absolute;
            top: -40px;
            left: 0;
            opacity: 0.15;
        }

        #y p .shadow {
            position: absolute;
            top: 0;
            left: -40px;
            opacity: 0.15;
        }

        .rail-x {
            width: 300px;
            position: relative;
            height: 20px;
            margin-bottom: 2em;
        }
        .rail-x div {
            width: 5px;
            top: 0;
            left: -5px;
            height: 19px;
            position: absolute;
            background-position: 0 -20px;
        }
        .rail-x div + div {
            left: auto;
            right: -5px;
            background-position: 0 -40px;
        }

        .rail-x span {
            position: absolute;
            top: 20px;
            left: 0;
            text-align: center;
            padding: 0 10px;
        }

        .x0, .x0 div { background-image: url(rail_white_00_h_3px_thick.png); }
        .x1, .x1 div { background-image: url(rail_white_01_h_5px_thick.png); }
        .x2, .x2 div { background-image: url(rail_white_03_h_lines_above.png); }
        .x3, .x3 div { background-image: url(rail_white_04_h_dots_in_rail_lines.png); }
        .x4, .x4 div { background-image: url(rail_white_05_h_embossed_groove_dots.png); }
        .x5, .x5 div { background-image: url(rail_white_06_h_embossed_groove_lines.png); }
        .x6, .x6 div { background-image: url(rail_white_07_h_lines_both_sides.png); }
        .dark .x0, .dark .x0 div { background-image: url(rail_black_00_h_3px_thick.png); }
        .dark .x1, .dark .x1 div { background-image: url(rail_black_01_h_5px_thick.png); }
        .dark .x2, .dark .x2 div { background-image: url(rail_black_03_h_lines_above.png); }
        .dark .x3, .dark .x3 div { background-image: url(rail_black_04_h_dots_in_rail_lines.png); }
        .dark .x4, .dark .x4 div { background-image: url(rail_black_05_h_embossed_groove_dots.png); }
        .dark .x5, .dark .x5 div { background-image: url(rail_black_06_h_embossed_groove_lines.png); }
        .dark .x6, .dark .x6 div { background-image: url(rail_black_07_h_lines_both_sides.png); }

        .rail-y {
            display: inline-block;
            height: 250px;
            width: 20px;
            position: relative;
            margin-right: 3em;
        }
        .rail-y div {
            height: 5px;
            top: -5px;
            left: 0;
            width: 19px;
            position: absolute;
            background-position: -20px 0;
        }
        .rail-y div + div {
            top: auto;
            bottom: -5px;
            background-position: -40px 0;
        }
        .rail-y span {
            position: absolute;
            bottom: 0;
            left: 25px;
            height: 20px;
            width: 20px; /* needed bc ff rotates from center, not top,left */
            -moz-transform: rotate(270deg);
        }

        .y0, .y0 div { background-image: url(rail_white_00_v_3px_thick.png); }
        .y1, .y1 div { background-image: url(rail_white_01_v_5px_thick.png); }
        .y2, .y2 div { background-image: url(rail_white_03_v_lines_left.png); }
        .y3, .y3 div { background-image: url(rail_white_04_v_dots_in_rail_lines.png); }
        .y4, .y4 div { background-image: url(rail_white_05_v_embossed_groove_dots.png); }
        .y5, .y5 div { background-image: url(rail_white_06_v_embossed_groove_lines.png); }
        .y6, .y6 div { background-image: url(rail_white_07_v_lines_both_sides.png); }

        .dark .y0, .dark .y0 div { background-image: url(rail_black_00_v_3px_thick.png); }
        .dark .y1, .dark .y1 div { background-image: url(rail_black_01_v_5px_thick.png); }
        .dark .y2, .dark .y2 div { background-image: url(rail_black_03_v_lines_left.png); }
        .dark .y3, .dark .y3 div { background-image: url(rail_black_04_v_dots_in_rail_lines.png); }
        .dark .y4, .dark .y4 div { background-image: url(rail_black_05_v_embossed_groove_dots.png); }
        .dark .y5, .dark .y5 div { background-image: url(rail_black_06_v_embossed_groove_lines.png); }
        .dark .y6, .dark .y6 div { background-image: url(rail_black_07_v_lines_both_sides.png); }

        #x, #thumbs, #y {
            float: left;
            margin-left: 2em;
        }

        #thumbs {
            width: 80px;
        }

        #y {
            padding-top: 3em;
        }
        #thumbs div {
            height: 40px;
            width: 40px;
            overflow: hidden;
            margin-bottom: 1em;
            float: left;
        }
    </style>
</head>
<body>
<fieldset>
    <input type="checkbox" id="dark"><label for="dark"> Dark</label>
</fieldset>

<div id="x">
    <div class="rail-x x0"><div></div><div></div><span>rail_white_00_h_3px_thick.png</span></div>
    <div class="rail-x x1"><div></div><div></div><span>rail_white_01_h_5px_thick.png</span></div>
    <div class="rail-x x2"><div></div><div></div><span>rail_white_03_h_lines_above.png</span></div>
    <div class="rail-x x3"><div></div><div></div><span>rail_white_04_h_dots_in_rail_lines.png</span></div>
    <div class="rail-x x4"><div></div><div></div><span>rail_white_05_h_embossed_groove_dots.png</span></div>
    <div class="rail-x x5"><div></div><div></div><span>rail_white_06_h_embossed_groove_lines.png</span></div>
    <div class="rail-x x6"><div></div><div></div><span>rail_white_07_h_lines_both_sides.png</span></div>
</div>

<div id="thumbs">
    <div><img src="thumb_white_01_h_oblong_wide_grip.png"></div>
    <div><img src="thumb_white_02_h_oblong_chiseled_with_grip.png"></div>
    <div><img src="thumb_white_03_h_bump_line.png"></div>
    <div><img src="thumb_white_04_h_recessed_w_dark_ring.png"></div>
    <div><img src="thumb_white_05_h_ridge_grip_circle.png"></div>
    <div><img src="thumb_white_06_h_oval_groove.png"></div>
    <div><img src="thumb_white_07_h_square_groove.png"></div>
</div>

<div id="y">
    <div class="rail-y y0"><div></div><div></div><span>rail_white_00_h_3px_thick.png</span></div>
    <div class="rail-y y1"><div></div><div></div><span>rail_white_01_h_5px_thick.png</span></div>
    <div class="rail-y y2"><div></div><div></div><span>rail_white_03_h_lines_above.png</span></div>
    <div class="rail-y y3"><div></div><div></div><span>rail_white_04_h_dots_in_rail_lines.png</span></div>
    <div class="rail-y y4"><div></div><div></div><span>rail_white_05_h_embossed_groove_dots.png</span></div>
    <div class="rail-y y5"><div></div><div></div><span>rail_white_06_h_embossed_groove_lines.png</span></div>
    <div class="rail-y y6"><div></div><div></div><span>rail_white_07_h_lines_both_sides.png</span></div>
</div>

<script>
    (function (d) {
        var rail,
            thumb = d.createElement( 'p' );

        thumb.innerHTML = '<img class="shadow" src=""><img src="">';

        d.getElementById('dark').onclick = function () {
            var cn = d.body.className,
                dark = ( cn.indexOf('dark') + 1 );

            d.body.className = dark ? '' : 'dark';

            darkThumbs( !dark );
        };

        d.onclick = function ( e ) {
            var r = find( e.target );

            if ( r ) {
                select( r );
            } else if ( rail ) {
                if ( e.target.nodeName.toLowerCase() === 'img' ) {
                    setThumb( e.target.src );
                }
            }
        };

        function darkThumbs( dark ) {
            var imgs = d.getElementsByTagName('img'),
                color = dark ? '_black_' : '_white_',
                i;

            for ( i = imgs.length - 1; i >= 0; --i ) {
                imgs[i].src = imgs[i].src.replace(/_(?:white|black)_/, color);
            }
        }

        function find( el ) {
            while ( el !== d.documentElement ) {
                if ( el.className.indexOf( 'rail-' ) + 1) {
                    return el;
                } else {
                    el = el.parentNode;
                }
            }
        }

        function select( newRail ) {
            if ( rail === newRail ) {
                deselect();
            } else {
                rail = newRail;
                rail.className += ' selected';
                
                orientThumbs();
            }
        }

        function deselect() {
            if ( rail ) {
                rail.className = rail.className.replace(/ selected/, '');
            }
            rail = null;
        }

        function orientThumbs() {
            var imgs = d.getElementById('thumbs').getElementsByTagName('img'),
                orientation = rail.className.indexOf('rail-y') === -1 ?
                    '_h_' : '_v_',
                i;

            for ( i = imgs.length - 1; i >= 0; --i ) {
                imgs[i].src = imgs[i].src.replace(/_[hv]_/, orientation);
            }
        }

        function setThumb( url ) {
            if ( rail ) {
                var old = rail.getElementsByTagName('p')[0],
                    t = thumb.cloneNode( true ),
                    imgs = t.getElementsByTagName( 'img' ),
                    i;

                for ( i = imgs.length - 1; i >= 0; --i ) {
                    imgs[i].src = url;
                }

                if ( old ) {
                    rail.removeChild( old );
                }

                rail.appendChild( t );
            }

            deselect();
        }
    })(document);
</script>
</body>
</html>
