<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>

<title>Progress Bar examples - Events</title>
<!-- css -->
<link rel="stylesheet" type="text/css" href="../../build/cssfonts/fonts-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssreset/reset-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssgrids/grids-min.css">
<link rel="stylesheet" type="text/css" href="../../build/cssbase/base-min.css">
<link rel="stylesheet" type="text/css" href="../../build/widget/assets/skins/sam/widget.css" />

<link rel="stylesheet" type="text/css" href="http://developer.yahoo.com/yui/assets/dpSyntaxHighlighter.css">

<!-- js -->
<scrip<script type="text/javascript" src="../../build/yui/yui.js"></script>

<!-- Until they get included in the yui-loader.js tables, I have to add it manually
I could use the Loader.addModule method, but this file is already built and has the code 
to add itself to the module list along with its requirements -->
<link rel="stylesheet" type="text/css" href="../../build/progressbar/assets/skins/sam/progressbar.css">
<script type="text/javascript" src="../../build/progressbar/progressbar.js"></script>

<style type="text/css">




#containers {
	float:left;
	margin-top:2em;
}


#textContainers {
	overflow:hidden;
	width:200px;
}

#minValueContainer {
	float:left;
}

#maxValueContainer {
	float:right;
}

#status {
	text-align:center;
}

#pbContainer .yui-progressbar-bar {
	background-color: rgb(127,127,127);
	background-image: none;
}

#control {
	float:right;
	width:300px;
}

fieldset {
	border: thin solid silver;
	background-color:#F0F0F0;
	padding:1em;
	margin:1em;
}

legend {
	font-weight:bold;
	margin:0 0.5em;
	padding:0 0.2em;
}

code {
	background-color:#e0e0e0;
	border:thin solid #c0c0c0;
	white-space:pre;
	font-size:10px;
}

.dp-highlighter th, .dp-highlighter td {
	border:0;
	padding:0;
}
.dp-highlighter .line1, .dp-highlighter  .line2 {
	padding-left:10px;
	white-space:nowrap;
}

</style>
</head>
<body class="yui-skin-sam">

	<div class="yui-d1">
		<div id="hd">
			<h1>Progress Bar examples - Events</h1>
			<p>This example shows how you can use the events that ProgressBar fires.</p>
		</div>
		<div id="bd">
			<div id="containers">
				<div id="pbContainer"></div>
				<div id="textContainers">
					<div id="minValueContainer" class="yui-progressbar-range">0</div>
					<div id="maxValueContainer" class="yui-progressbar-range">255</div>
					<div class="yui-progressbar-caption">
						<span id="valueContainer">127</span> 
						<span id="status"></span>
					</div>
				</div>
			</div>
			<fieldset id="control">
				<legend>Control</legend>
				<fieldset id="valueSet">
					<legend>Value</legend>
					<div id="sliderValue"  title="Value slider"></div>
				</fieldset>
				<fieldset id="rangeSet">
					<legend>Range</legend>
					minValue <div id="sliderMinValue" title="minValue slider"></div>
					maxValue <div id="sliderMaxValue" title="maxValue slider"></div>
				</fieldset>
			</fieldset>
				
		</div>
		<div id="ft">
			<p>The code to create the ProgressBar is:</p>
			<textarea name="code" class="JScript" cols="60" rows="1">
				var pb = new Y.ProgressBar({
					value:127,
					maxValue:255,
					anim:true
				}).render('#pbContainer');
				var anim = pb.get('anim');
				anim.set('duration', 3);
				anim.set('easing', Y.Easing.bounceBoth);				
			</textarea>
			<p>We are instantiating the ProgressBar and configuring it so that the initial value is 127 which is halfway
			to the maximum we set of 255, starting from the default minimum of 0.
			The range is set so that they translate directly into color values, which we then apply to the bar.
			The ProgressBar uses the Animation utility so to configure it we have to fetch the instance the ProgressBar
			uses and set its duration and easing method.  We are using an animated ProgressBar with a long duration
			so we can see the events firing, otherwise it all happens too fast. </p>
			
			<p>We are listening to the three events related to movement, 
			the one that signals the start of the movement, <code>progress</code> that is fired several times while it is moving and the 
			one that signals the completion of the movement.  Without animation, the <code>start</code>, <code>progress</code> 
			and <code>end</code> events fire one after the other in close sequence.</p>
			<textarea name="code" class="JScript" cols="60" rows="1">
				pb.on('start',function (ev) {
					Y.get('#status').set('innerHTML', 'Started');
					window.setTimeout(function() {
						Y.get('#status').set('innerHTML', '');
					},1000);
				});
				
				pb.on('progress',function (ev) {
					var value = ev.value;
					this.get('barEl').setStyle('backgroundColor','rgb(' + value + ',' + value + ',127)');
					Y.get('#valueContainer').set('innerHTML', value);
				});
				
				pb.on('end',function (ev) {
					Y.get('#status').set('innerHTML', 'Stopped');
					window.setTimeout(function() {
						Y.get('#status').set('innerHTML', '');
					},1000);
				});
			</textarea>
			
			<p>We are doing simple actions with the events. We show a 'Started' sign for one second upon receiving the
			<code>start</code> event, we change the color of the bar itself according to the <code>value</code> property in the event facade
			received in <code>progress</code> and show that value right below the bar (the facades for all three events have a <code>value</code> property) 
			and finally, in the	<code>end</code> event we show a 'Stopped' sign.
			The <code>value</code> property in all the event facades provide the nominal value of the ProgresBar, not the size of the bar itself.
			A value of 50 will always be halfway in a range o 0 to 100, whether the ProgressBar is 100 or 500 pixels wide.
			The value reported is also immune to the easing method of the animation, if any.  The value will change linearly over time
			in between the start and end values, regardless of how the bar itself bounces about.
			</p>
			
			<p>We have also provided a slider to change the end values for the bar so that we can show how to respond to those
			events and display their values, with the following code. The ProgressBar inherits the attribute change events
			from the Widget component.  There are before and after change events for all configuration attributes.
			We just mean to get notified about the change, we won't convert the value or prevent it from being set 
			so either the before (<code>on</code>) or <code>after</code> event would do just as well.</p>
			<textarea name="code" class="JScript" cols="60" rows="1">
				pb.on('minValueChange',function(ev)  {
					Y.get('#minValueContainer').set('innerHTML', ev.newVal);
				});
				
				pb.on('maxValueChange',function(ev)  {
					Y.get('#maxValueContainer').set('innerHTML', ev.newVal);
				});
			</textarea>
			<p>The containers for the values and status texts are declared as shown below.  Notice the <code>yui-progressbar-range</code> and <code>yui-progressbar-caption</code>
			classNames in their declaration.  The ProgressBar itself does not use those classNames at all.  They are defined as part of the SAM
			skin as a convenience to the implementor.</p>
			<textarea name="code" class="HTML" cols="60" rows="1">
				<div id="textContainers">
					<div id="minValueContainer" class="yui-progressbar-range">0</div>
					<div id="maxValueContainer" class="yui-progressbar-range">255</div>
					<div class="yui-progressbar-caption">
						<span id="valueContainer">127</span> 
						<span id="status"></span>
					</div>
				</div>
			</textarea>
		</div>
	</div>
	
<script  type="text/javascript">

YUI({base:"../../build/",filter:"raw"}).use('widget','anim','progressbar','slider',function(Y) {
	
	var pb = new Y.ProgressBar({
		value:127,
		maxValue:255,
		anim:true
	}).render('#pbContainer');
	var anim = pb.get('anim');
	anim.set('duration', 3);
	anim.set('easing', Y.Easing.bounceBoth);
	
	pb.on('start',function (ev) {
		Y.get('#status').set('innerHTML', 'Started');
		window.setTimeout(function() {
			Y.get('#status').set('innerHTML', '');
		},1000);
	});
	
	pb.on('progress',function (ev) {
		var value = ev.value;
		this.get('barEl').setStyle('backgroundColor','rgb(' + value + ',' + value + ',127)');
		Y.get('#valueContainer').set('innerHTML', value);
	});
	
	pb.on('end',function (ev) {
		Y.get('#status').set('innerHTML', 'Stopped');
		window.setTimeout(function() {
			Y.get('#status').set('innerHTML', '');
		},1000);
	});

	pb.on('minValueChange',function(ev)  {
		Y.get('#minValueContainer').set('innerHTML', ev.newVal);
	});
	
	pb.on('maxValueChange',function(ev)  {
		Y.get('#maxValueContainer').set('innerHTML', ev.newVal);
	});
	
	// From here on, it is mostly handling of the Sliders

	var valueSlider = new Y.Slider({
		railSize: '200px',
		thumbImage: '../../build/slider/assets/skins/sam/thumb-classic-x.png',
		value:127,
		min:0,
		max:255
	}).render('#sliderValue');
	valueSlider.after('slideEnd',function(e) {
		var value = this.getValue();
		pb.set('value',value);
	});
	

	var minValueSlider = new Y.Slider({
		railSize: '200px',
		thumbImage: '../../build/slider/assets/skins/sam/thumb-classic-x.png',
		value:0,
		min:0,
		max:255
	}).render("#sliderMinValue");
	minValueSlider.on('slideEnd', function() {
		var value = Math.round(this.getValue());
		if (value > maxValueSlider.getValue()) {
			window.setTimeout(function() {
				minValueSlider.setValue(maxValueSlider.getValue() -1);
			},1);
			return;
		}
		pb.set('minValue',value);
	}); 
	
	var maxValueSlider = new Y.Slider({
		railSize: '200px',
		thumbImage: '../../build/slider/assets/skins/sam/thumb-classic-x.png',
		value:255,
		min:0,
		max:255
	}).render("#sliderMaxValue");

	maxValueSlider.on('slideEnd', function() {
		var value = Math.round(this.getValue());
		if (value < minValueSlider.getValue()) {
			window.setTimeout(function() {
				maxValueSlider.setValue(minValueSlider.getValue() +1);
			},1);
			return;
		}
		pb.set('maxValue',value);
	}); 


});
</script>
<script type="text/javascript" src="http://developer.yahoo.com/yui/assets/dpSyntaxHighlighter.js"></script>
<script type="text/javascript" language="javascript">dp.SyntaxHighlighter.HighlightAll('code');</script>
</body>
</html>
	
