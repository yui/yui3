<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=0">
        <link rel="stylesheet" href="../../build/cssreset/reset-min.css" type="text/css" charset="utf-8">
        <script src="../../build/yui/yui.js"></script>
        <style type="text/css" media="screen">
            #main {
                height: 400px;
                white-space:nowrap;
            }
            .screen {
                white-space:normal;
                display:inline-block;
                width:800px;
            }
            .pane, .frame {
                display:inline-block;
                overflow:hidden;
                margin:5px;
                width: 380px;
                height: 380px;
            }
            
            .page {
                height:400px;
            }
            
            #screen1 .pane {
                background-color:#7B0099;
            }
            #screen2 .pane {
                background-color:#3fc336;
            }
            #screen3 .pane {
                background-color:#262d87;
            }
            p {
                margin-bottom:20px;
            }
        </style>
    </head>
    <body>
        <p>Vertically Paged SV, with a Horizontally Paged SV inside it on each page (swipe left/right on the main SV, swipe up/down on the text)</p>
        <div id="main">
            <div class="screen" id="screen1">
                <div class="pane"></div>
                <div class="frame">
                    <div class="vertical">
                        <div class="page">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam bibendum cursus orci, vel dignissim lorem elementum scelerisque. Integer facilisis ipsum et justo commodo molestie. Donec interdum lobortis pharetra. Aenean a orci massa. Vestibulum feugiat urna eget elit porta eu interdum est vehicula. Vivamus nec lacus neque, vel suscipit augue. Quisque ornare lobortis pretium. Vivamus sodales semper sem, at tincidunt dolor euismod vel. Praesent eleifend congue erat, in blandit turpis sagittis ornare. Donec sed iaculis urna. Donec condimentum ipsum at est gravida mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum lacus lectus, dapibus sit amet mollis at, imperdiet sit amet purus. Curabitur malesuada augue ac libero sagittis pellentesque. Donec vehicula vestibulum pulvinar. Suspendisse mi sem, aliquam vitae feugiat ut, vulputate id dui.
                        </div>
                        <div class="page">
                        Aenean elementum imperdiet interdum. Quisque tristique felis id mi pretium elementum. Vivamus quis erat lacus, congue dignissim velit. Etiam quis nulla massa. Praesent urna magna, placerat vel mollis eu, feugiat et neque. Pellentesque luctus rutrum turpis in hendrerit. Proin eleifend semper justo vel aliquet. Integer sed sem orci. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi fringilla condimentum posuere. Mauris in diam elit. Fusce vitae libero in velit imperdiet commodo. Nam feugiat condimentum vehicula.
                        </div>
                        <div class="page">
                        Aliquam et ipsum est, nec rhoncus magna. Praesent ultrices ligula sit amet nisl molestie mollis. Integer sit amet neque nec urna eleifend feugiat. Mauris pulvinar leo ante, id laoreet tellus. Nunc in lectus sed metus imperdiet aliquam quis sed erat. Suspendisse potenti. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In dignissim mollis pharetra. In hac habitasse platea dictumst. Nullam interdum bibendum lacus ut gravida. Curabitur consectetur, erat a lacinia sagittis, orci dui varius dolor, non tincidunt felis mauris sed metus. Aenean semper, mauris mattis dapibus convallis, mauris libero consequat lacus, et facilisis nisl leo id velit. Etiam venenatis, urna id euismod congue, sapien eros egestas nisl, a pellentesque magna lectus id libero. Curabitur in augue vel nulla iaculis viverra. Mauris quis turpis eget felis aliquam consectetur. Nulla posuere feugiat rutrum. Proin elit neque, auctor ut pretium non, feugiat venenatis orci. Maecenas condimentum odio a mauris ornare egestas tincidunt metus posuere.
                        </div>
                        <div class="page">
                        Praesent hendrerit nibh tincidunt nulla dictum feugiat. Curabitur metus libero, commodo sit amet gravida et, viverra ut massa. Praesent lobortis volutpat tellus eget cursus. Donec posuere convallis rutrum. Duis vitae enim et sem ornare dictum. Suspendisse malesuada, sem vitae viverra semper, odio massa molestie augue, quis rutrum magna massa ac lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Fusce malesuada auctor leo, non iaculis lectus pretium vestibulum. Nunc eget lacus risus, nec scelerisque magna. Cras vitae ligula tortor, aliquam rhoncus justo. Aenean sed dolor justo, quis luctus ante. Pellentesque tincidunt magna auctor urna pellentesque luctus. Nullam at orci ante. Donec pellentesque pharetra lobortis. Duis convallis egestas diam. Phasellus non erat leo, vel rutrum ligula. In hac habitasse platea dictumst. Donec vel ante quis nulla aliquam tincidunt.
                        </div>
                    </div>
                </div>
            </div>
            <div class="screen" id="screen2">
                <div class="pane"></div>
                <div class="frame">
                    <div class="vertical">
                        <div class="page">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam bibendum cursus orci, vel dignissim lorem elementum scelerisque. Integer facilisis ipsum et justo commodo molestie. Donec interdum lobortis pharetra. Aenean a orci massa. Vestibulum feugiat urna eget elit porta eu interdum est vehicula. Vivamus nec lacus neque, vel suscipit augue. Quisque ornare lobortis pretium. Vivamus sodales semper sem, at tincidunt dolor euismod vel. Praesent eleifend congue erat, in blandit turpis sagittis ornare. Donec sed iaculis urna. Donec condimentum ipsum at est gravida mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum lacus lectus, dapibus sit amet mollis at, imperdiet sit amet purus. Curabitur malesuada augue ac libero sagittis pellentesque. Donec vehicula vestibulum pulvinar. Suspendisse mi sem, aliquam vitae feugiat ut, vulputate id dui.
                        </div>
                        <div class="page">
                        Aenean elementum imperdiet interdum. Quisque tristique felis id mi pretium elementum. Vivamus quis erat lacus, congue dignissim velit. Etiam quis nulla massa. Praesent urna magna, placerat vel mollis eu, feugiat et neque. Pellentesque luctus rutrum turpis in hendrerit. Proin eleifend semper justo vel aliquet. Integer sed sem orci. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi fringilla condimentum posuere. Mauris in diam elit. Fusce vitae libero in velit imperdiet commodo. Nam feugiat condimentum vehicula.
                        </div>
                        <div class="page">
                        Aliquam et ipsum est, nec rhoncus magna. Praesent ultrices ligula sit amet nisl molestie mollis. Integer sit amet neque nec urna eleifend feugiat. Mauris pulvinar leo ante, id laoreet tellus. Nunc in lectus sed metus imperdiet aliquam quis sed erat. Suspendisse potenti. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In dignissim mollis pharetra. In hac habitasse platea dictumst. Nullam interdum bibendum lacus ut gravida. Curabitur consectetur, erat a lacinia sagittis, orci dui varius dolor, non tincidunt felis mauris sed metus. Aenean semper, mauris mattis dapibus convallis, mauris libero consequat lacus, et facilisis nisl leo id velit. Etiam venenatis, urna id euismod congue, sapien eros egestas nisl, a pellentesque magna lectus id libero. Curabitur in augue vel nulla iaculis viverra. Mauris quis turpis eget felis aliquam consectetur. Nulla posuere feugiat rutrum. Proin elit neque, auctor ut pretium non, feugiat venenatis orci. Maecenas condimentum odio a mauris ornare egestas tincidunt metus posuere.
                        </div>
                        <div class="page">
                        Praesent hendrerit nibh tincidunt nulla dictum feugiat. Curabitur metus libero, commodo sit amet gravida et, viverra ut massa. Praesent lobortis volutpat tellus eget cursus. Donec posuere convallis rutrum. Duis vitae enim et sem ornare dictum. Suspendisse malesuada, sem vitae viverra semper, odio massa molestie augue, quis rutrum magna massa ac lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Fusce malesuada auctor leo, non iaculis lectus pretium vestibulum. Nunc eget lacus risus, nec scelerisque magna. Cras vitae ligula tortor, aliquam rhoncus justo. Aenean sed dolor justo, quis luctus ante. Pellentesque tincidunt magna auctor urna pellentesque luctus. Nullam at orci ante. Donec pellentesque pharetra lobortis. Duis convallis egestas diam. Phasellus non erat leo, vel rutrum ligula. In hac habitasse platea dictumst. Donec vel ante quis nulla aliquam tincidunt.
                        </div>
                    </div>
                </div>
            </div>
            <div class="screen" id="screen3">
                <div class="pane"></div>
                <div class="frame">
                    <div class="vertical">
                        <div class="page">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam bibendum cursus orci, vel dignissim lorem elementum scelerisque. Integer facilisis ipsum et justo commodo molestie. Donec interdum lobortis pharetra. Aenean a orci massa. Vestibulum feugiat urna eget elit porta eu interdum est vehicula. Vivamus nec lacus neque, vel suscipit augue. Quisque ornare lobortis pretium. Vivamus sodales semper sem, at tincidunt dolor euismod vel. Praesent eleifend congue erat, in blandit turpis sagittis ornare. Donec sed iaculis urna. Donec condimentum ipsum at est gravida mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum lacus lectus, dapibus sit amet mollis at, imperdiet sit amet purus. Curabitur malesuada augue ac libero sagittis pellentesque. Donec vehicula vestibulum pulvinar. Suspendisse mi sem, aliquam vitae feugiat ut, vulputate id dui.
                        </div>
                        <div class="page">
                        Aenean elementum imperdiet interdum. Quisque tristique felis id mi pretium elementum. Vivamus quis erat lacus, congue dignissim velit. Etiam quis nulla massa. Praesent urna magna, placerat vel mollis eu, feugiat et neque. Pellentesque luctus rutrum turpis in hendrerit. Proin eleifend semper justo vel aliquet. Integer sed sem orci. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi fringilla condimentum posuere. Mauris in diam elit. Fusce vitae libero in velit imperdiet commodo. Nam feugiat condimentum vehicula.
                        </div>
                        <div class="page">
                        Aliquam et ipsum est, nec rhoncus magna. Praesent ultrices ligula sit amet nisl molestie mollis. Integer sit amet neque nec urna eleifend feugiat. Mauris pulvinar leo ante, id laoreet tellus. Nunc in lectus sed metus imperdiet aliquam quis sed erat. Suspendisse potenti. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In dignissim mollis pharetra. In hac habitasse platea dictumst. Nullam interdum bibendum lacus ut gravida. Curabitur consectetur, erat a lacinia sagittis, orci dui varius dolor, non tincidunt felis mauris sed metus. Aenean semper, mauris mattis dapibus convallis, mauris libero consequat lacus, et facilisis nisl leo id velit. Etiam venenatis, urna id euismod congue, sapien eros egestas nisl, a pellentesque magna lectus id libero. Curabitur in augue vel nulla iaculis viverra. Mauris quis turpis eget felis aliquam consectetur. Nulla posuere feugiat rutrum. Proin elit neque, auctor ut pretium non, feugiat venenatis orci. Maecenas condimentum odio a mauris ornare egestas tincidunt metus posuere.
                        </div>
                        <div class="page">
                        Praesent hendrerit nibh tincidunt nulla dictum feugiat. Curabitur metus libero, commodo sit amet gravida et, viverra ut massa. Praesent lobortis volutpat tellus eget cursus. Donec posuere convallis rutrum. Duis vitae enim et sem ornare dictum. Suspendisse malesuada, sem vitae viverra semper, odio massa molestie augue, quis rutrum magna massa ac lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Fusce malesuada auctor leo, non iaculis lectus pretium vestibulum. Nunc eget lacus risus, nec scelerisque magna. Cras vitae ligula tortor, aliquam rhoncus justo. Aenean sed dolor justo, quis luctus ante. Pellentesque tincidunt magna auctor urna pellentesque luctus. Nullam at orci ante. Donec pellentesque pharetra lobortis. Duis convallis egestas diam. Phasellus non erat leo, vel rutrum ligula. In hac habitasse platea dictumst. Donec vel ante quis nulla aliquam tincidunt.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript" charset="utf-8">
            YUI({filter:"raw"}).use('scrollview-base', 'scrollview-paginator', function (Y) {

                // Workaround, until we publish a "scrollStart", "scroll" events, or something similar

                // Workaround until we add disabled attribute handling
                function wrapWithLock() {
                    if (this.get("disabled")) {
                        return new Y.Do.Prevent();
                    }
                }

                var mainSwiper = new Y.ScrollView({
                    srcNode: Y.one('#main'),
                    id: "sv",
                    width: 800,
                    flick: {
                        minDistance:40,
                        minVelocity:0.5,
                        axis:"x"
                    }
                });

                mainSwiper.plug(Y.Plugin.ScrollViewPaginator, {
                    selector: '.screen'
                });

                // Don't respond to anything, or allow calls to scrollTo if locked
                Y.Do.before(wrapWithLock, mainSwiper, "scrollTo");
                Y.Do.before(wrapWithLock, mainSwiper, "_flick");
                Y.Do.before(wrapWithLock, mainSwiper, "_onGestureMove");
                Y.Do.before(wrapWithLock, mainSwiper, "_onGestureMoveStart");
                Y.Do.before(wrapWithLock, mainSwiper, "_onGestureMoveEnd");
                
                mainSwiper.render();

                Y.all('.vertical').each(function (node) {

                    var startX,
                        startY,
                        endX,
                        endY,
                        lilSwiper = new Y.ScrollView({
                            srcNode: node,
                            height: 400,
                            flick: {
                                minDistance:40,
                                minVelocity:0.5,
                                axis:"y"
                            }
                        });

                    Y.Do.before(wrapWithLock, lilSwiper, "scrollTo");
                    Y.Do.before(wrapWithLock, lilSwiper, "_flick");
                    Y.Do.before(wrapWithLock, lilSwiper, "_onGestureMove");
                    Y.Do.before(wrapWithLock, lilSwiper, "_onGestureMoveStart");
                    Y.Do.before(wrapWithLock, lilSwiper, "_onGestureMoveEnd");
        
                    Y.Do.before(function(e) {
                            startX = e.pageX;
                            startY = e.pageY;
                    }, lilSwiper, "_onGestureMoveStart");
    
                    Y.Do.before(function(e) {
                        if (!mainSwiper.get("disabled") && (Math.abs(e.pageX - startX) < Math.abs(e.pageY - startY))) {
                            mainSwiper.set("disabled", true);
                        }
                    }, lilSwiper, "_onGestureMove");

                    Y.Do.before(function(e) {
                        mainSwiper.set("disabled", false);
                        lilSwiper.set("disabled", false);
                    }, lilSwiper, "_onGestureMoveEnd");

                    lilSwiper.plug(Y.Plugin.ScrollViewPaginator, {
                        selector: '.page'
                    });

                    lilSwiper.render();
                });
            });
        </script>
    </body>
</html>